var stratum=(()=>{var gf=Object.create,Wr=Object.defineProperty,_f=Object.getPrototypeOf,wf=Object.prototype.hasOwnProperty,yf=Object.getOwnPropertyNames,vf=Object.getOwnPropertyDescriptor,C=Object.assign,wo=e=>Wr(e,"__esModule",{value:!0}),F=(e,t)=>()=>(t||(t={exports:{}},e(t.exports,t)),t.exports),Sf=(e,t)=>{wo(e);for(var r in t)Wr(e,r,{get:t[r],enumerable:!0})},Tf=(e,t,r)=>{if(wo(e),typeof t=="object"||typeof t=="function")for(let i of yf(t))!wf.call(e,i)&&i!=="default"&&Wr(e,i,{get:()=>t[i],enumerable:!(r=vf(t,i))||r.enumerable});return e},nr=e=>e&&e.__esModule?e:Tf(Wr(gf(_f(e)),"default",{value:e,enumerable:!0}),e),ft=(e,t,r)=>new Promise((i,s)=>{var n=c=>{try{l(r.next(c))}catch(u){s(u)}},o=c=>{try{l(r.throw(c))}catch(u){s(u)}},l=c=>c.done?i(c.value):Promise.resolve(c.value).then(n,o);l((r=r.apply(e,t)).next())}),To=F((Xg,So)=>{So.exports=de;function de(e){if(e)return Ef(e)}function Ef(e){for(var t in de.prototype)e[t]=de.prototype[t];return e}de.prototype.on=de.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks[e]=this._callbacks[e]||[]).push(t),this};de.prototype.once=function(e,t){var r=this;this._callbacks=this._callbacks||{};function i(){r.off(e,i),t.apply(this,arguments)}return i.fn=t,this.on(e,i),this};de.prototype.off=de.prototype.removeListener=de.prototype.removeAllListeners=de.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var r=this._callbacks[e];if(!r)return this;if(arguments.length==1)return delete this._callbacks[e],this;for(var i,s=0;s<r.length;s++)if(i=r[s],i===t||i.fn===t){r.splice(s,1);break}return this};de.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),r=this._callbacks[e];if(r){r=r.slice(0);for(var i=0,s=r.length;i<s;++i)r[i].apply(this,t)}return this};de.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks[e]||[]};de.prototype.hasListeners=function(e){return!!this.listeners(e).length}}),Io=F((Yg,Eo)=>{var xo=To();function sr(){xo.call(this)}sr.prototype=new xo;Eo.exports=sr;sr.Stream=sr;sr.prototype.pipe=function(e,t){var r=this;function i(f){e.writable&&(e.write(f)===!1&&r.pause&&r.pause())}r.on("data",i);function s(){r.readable&&r.resume&&r.resume()}e.on("drain",s),!e._isStdio&&(!t||t.end!==!1)&&(r.on("end",o),r.on("close",l));var n=!1;function o(){if(n)return;n=!0,e.end()}function l(){if(n)return;n=!0,typeof e.destroy=="function"&&e.destroy()}function c(f){if(u(),!this.hasListeners("error"))throw f}r.on("error",c),e.on("error",c);function u(){r.off("data",i),e.off("drain",s),r.off("end",o),r.off("close",l),r.off("error",c),e.off("error",c),r.off("end",u),r.off("close",u),e.off("end",u),e.off("close",u)}return r.on("end",u),r.on("close",u),e.on("end",u),e.on("close",u),e.emit("pipe",r),e}}),Gi=F((qg,Oo)=>{Oo.exports=Io()}),Ue=F(fe=>{"use strict";fe.base64=!0;fe.array=!0;fe.string=!0;fe.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined";fe.nodebuffer=typeof Buffer!="undefined";fe.uint8array=typeof Uint8Array!="undefined";if(typeof ArrayBuffer=="undefined")fe.blob=!1;else{var Ao=new ArrayBuffer(0);try{fe.blob=new Blob([Ao],{type:"application/zip"}).size===0}catch(e){try{var xf=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,Do=new xf;Do.append(Ao),fe.blob=Do.getBlob("application/zip").size===0}catch(t){fe.blob=!1}}}try{fe.nodestream=!!Gi().Readable}catch(e){fe.nodestream=!1}}),Xi=F(Zi=>{"use strict";var If=q(),Of=Ue(),Ne="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";Zi.encode=function(e){for(var t=[],r,i,s,n,o,l,c,u=0,f=e.length,S=f,g=If.getTypeOf(e)!=="string";u<e.length;)S=f-u,g?(r=e[u++],i=u<f?e[u++]:0,s=u<f?e[u++]:0):(r=e.charCodeAt(u++),i=u<f?e.charCodeAt(u++):0,s=u<f?e.charCodeAt(u++):0),n=r>>2,o=(r&3)<<4|i>>4,l=S>1?(i&15)<<2|s>>6:64,c=S>2?s&63:64,t.push(Ne.charAt(n)+Ne.charAt(o)+Ne.charAt(l)+Ne.charAt(c));return t.join("")};Zi.decode=function(e){var t,r,i,s,n,o,l,c=0,u=0,f="data:";if(e.substr(0,f.length)===f)throw new Error("Invalid base64 input, it looks like a data url.");e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");var S=e.length*3/4;if(e.charAt(e.length-1)===Ne.charAt(64)&&S--,e.charAt(e.length-2)===Ne.charAt(64)&&S--,S%1!==0)throw new Error("Invalid base64 input, bad content length.");var g;for(Of.uint8array?g=new Uint8Array(S|0):g=new Array(S|0);c<e.length;)s=Ne.indexOf(e.charAt(c++)),n=Ne.indexOf(e.charAt(c++)),o=Ne.indexOf(e.charAt(c++)),l=Ne.indexOf(e.charAt(c++)),t=s<<2|n>>4,r=(n&15)<<4|o>>2,i=(o&3)<<6|l,g[u++]=t,o!==64&&(g[u++]=r),l!==64&&(g[u++]=i);return g}}),or=F((Qg,No)=>{"use strict";No.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(e,t){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(e,t);if(typeof e=="number")throw new Error('The "data" argument must not be a number');return new Buffer(e,t)},allocBuffer:function(e){if(Buffer.alloc)return Buffer.alloc(e);var t=new Buffer(e);return t.fill(0),t},isBuffer:function(e){return Buffer.isBuffer(e)},isStream:function(e){return e&&typeof e.on=="function"&&typeof e.pause=="function"&&typeof e.resume=="function"}}}),Ro=F((e_,ko)=>{"use strict";ko.exports=typeof setImmediate=="function"?setImmediate:function(){var t=[].slice.apply(arguments);t.splice(1,0,0),setTimeout.apply(null,t)}}),Uo=F((t_,Bo)=>{"use strict";var Lo=global.MutationObserver||global.WebKitMutationObserver,ar;if(Lo){var Fo=0,Af=new Lo(jr),Mo=global.document.createTextNode("");Af.observe(Mo,{characterData:!0}),ar=function(){Mo.data=Fo=++Fo%2}}else if(!global.setImmediate&&typeof global.MessageChannel!="undefined"){var Po=new global.MessageChannel;Po.port1.onmessage=jr,ar=function(){Po.port2.postMessage(0)}}else"document"in global&&"onreadystatechange"in global.document.createElement("script")?ar=function(){var e=global.document.createElement("script");e.onreadystatechange=function(){jr(),e.onreadystatechange=null,e.parentNode.removeChild(e),e=null},global.document.documentElement.appendChild(e)}:ar=function(){setTimeout(jr,0)};var Yi,lr=[];function jr(){Yi=!0;for(var e,t,r=lr.length;r;){for(t=lr,lr=[],e=-1;++e<r;)t[e]();r=lr.length}Yi=!1}Bo.exports=Df;function Df(e){lr.push(e)===1&&!Yi&&ar()}}),$o=F((r_,zo)=>{"use strict";var Nf=Uo();function Rt(){}var ne={},Co=["REJECTED"],qi=["FULFILLED"],Ho=["PENDING"];zo.exports=Ve;function Ve(e){if(typeof e!="function")throw new TypeError("resolver must be a function");this.state=Ho,this.queue=[],this.outcome=void 0,e!==Rt&&Wo(this,e)}Ve.prototype.finally=function(e){if(typeof e!="function")return this;var t=this.constructor;return this.then(r,i);function r(s){function n(){return s}return t.resolve(e()).then(n)}function i(s){function n(){throw s}return t.resolve(e()).then(n)}};Ve.prototype.catch=function(e){return this.then(null,e)};Ve.prototype.then=function(e,t){if(typeof e!="function"&&this.state===qi||typeof t!="function"&&this.state===Co)return this;var r=new this.constructor(Rt);if(this.state!==Ho){var i=this.state===qi?e:t;Ki(r,i,this.outcome)}else this.queue.push(new hr(r,e,t));return r};function hr(e,t,r){this.promise=e,typeof t=="function"&&(this.onFulfilled=t,this.callFulfilled=this.otherCallFulfilled),typeof r=="function"&&(this.onRejected=r,this.callRejected=this.otherCallRejected)}hr.prototype.callFulfilled=function(e){ne.resolve(this.promise,e)};hr.prototype.otherCallFulfilled=function(e){Ki(this.promise,this.onFulfilled,e)};hr.prototype.callRejected=function(e){ne.reject(this.promise,e)};hr.prototype.otherCallRejected=function(e){Ki(this.promise,this.onRejected,e)};function Ki(e,t,r){Nf(function(){var i;try{i=t(r)}catch(s){return ne.reject(e,s)}i===e?ne.reject(e,new TypeError("Cannot resolve promise with itself")):ne.resolve(e,i)})}ne.resolve=function(e,t){var r=jo(kf,t);if(r.status==="error")return ne.reject(e,r.value);var i=r.value;if(i)Wo(e,i);else{e.state=qi,e.outcome=t;for(var s=-1,n=e.queue.length;++s<n;)e.queue[s].callFulfilled(t)}return e};ne.reject=function(e,t){e.state=Co,e.outcome=t;for(var r=-1,i=e.queue.length;++r<i;)e.queue[r].callRejected(t);return e};function kf(e){var t=e&&e.then;if(e&&(typeof e=="object"||typeof e=="function")&&typeof t=="function")return function(){t.apply(e,arguments)}}function Wo(e,t){var r=!1;function i(l){if(r)return;r=!0,ne.reject(e,l)}function s(l){if(r)return;r=!0,ne.resolve(e,l)}function n(){t(s,i)}var o=jo(n);o.status==="error"&&i(o.value)}function jo(e,t){var r={};try{r.value=e(t),r.status="success"}catch(i){r.status="error",r.value=i}return r}Ve.resolve=Rf;function Rf(e){return e instanceof this?e:ne.resolve(new this(Rt),e)}Ve.reject=Bf;function Bf(e){var t=new this(Rt);return ne.reject(t,e)}Ve.all=Lf;function Lf(e){var t=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var s=new Array(r),n=0,o=-1,l=new this(Rt);++o<r;)c(e[o],o);return l;function c(u,f){t.resolve(u).then(S,function(g){i||(i=!0,ne.reject(l,g))});function S(g){s[f]=g,++n===r&&!i&&(i=!0,ne.resolve(l,s))}}}Ve.race=Ff;function Ff(e){var t=this;if(Object.prototype.toString.call(e)!=="[object Array]")return this.reject(new TypeError("must be an array"));var r=e.length,i=!1;if(!r)return this.resolve([]);for(var s=-1,n=new this(Rt);++s<r;)o(e[s]);return n;function o(l){t.resolve(l).then(function(c){i||(i=!0,ne.resolve(n,c))},function(c){i||(i=!0,ne.reject(n,c))})}}}),Bt=F((i_,Vo)=>{"use strict";var Ji=null;typeof Promise!="undefined"?Ji=Promise:Ji=$o();Vo.exports={Promise:Ji}}),q=F(te=>{"use strict";var Ge=Ue(),Mf=Xi(),Lt=or(),Pf=Ro(),Qi=Bt();function Uf(e){var t=null;return Ge.uint8array?t=new Uint8Array(e.length):t=new Array(e.length),$r(e,t)}te.newBlob=function(e,t){te.checkSupport("blob");try{return new Blob([e],{type:t})}catch(s){try{var r=self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder,i=new r;return i.append(e),i.getBlob(t)}catch(n){throw new Error("Bug : can't construct the Blob.")}}};function ur(e){return e}function $r(e,t){for(var r=0;r<e.length;++r)t[r]=e.charCodeAt(r)&255;return t}var Vr={stringifyByChunk:function(e,t,r){var i=[],s=0,n=e.length;if(n<=r)return String.fromCharCode.apply(null,e);for(;s<n;)t==="array"||t==="nodebuffer"?i.push(String.fromCharCode.apply(null,e.slice(s,Math.min(s+r,n)))):i.push(String.fromCharCode.apply(null,e.subarray(s,Math.min(s+r,n)))),s+=r;return i.join("")},stringifyByChar:function(e){for(var t="",r=0;r<e.length;r++)t+=String.fromCharCode(e[r]);return t},applyCanBeUsed:{uint8array:function(){try{return Ge.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch(e){return!1}}(),nodebuffer:function(){try{return Ge.nodebuffer&&String.fromCharCode.apply(null,Lt.allocBuffer(1)).length===1}catch(e){return!1}}()}};function cr(e){var t=65536,r=te.getTypeOf(e),i=!0;if(r==="uint8array"?i=Vr.applyCanBeUsed.uint8array:r==="nodebuffer"&&(i=Vr.applyCanBeUsed.nodebuffer),i)for(;t>1;)try{return Vr.stringifyByChunk(e,r,t)}catch(s){t=Math.floor(t/2)}return Vr.stringifyByChar(e)}te.applyFromCharCode=cr;function Gr(e,t){for(var r=0;r<e.length;r++)t[r]=e[r];return t}var Ze={};Ze.string={string:ur,array:function(e){return $r(e,new Array(e.length))},arraybuffer:function(e){return Ze.string.uint8array(e).buffer},uint8array:function(e){return $r(e,new Uint8Array(e.length))},nodebuffer:function(e){return $r(e,Lt.allocBuffer(e.length))}};Ze.array={string:cr,array:ur,arraybuffer:function(e){return new Uint8Array(e).buffer},uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return Lt.newBufferFrom(e)}};Ze.arraybuffer={string:function(e){return cr(new Uint8Array(e))},array:function(e){return Gr(new Uint8Array(e),new Array(e.byteLength))},arraybuffer:ur,uint8array:function(e){return new Uint8Array(e)},nodebuffer:function(e){return Lt.newBufferFrom(new Uint8Array(e))}};Ze.uint8array={string:cr,array:function(e){return Gr(e,new Array(e.length))},arraybuffer:function(e){return e.buffer},uint8array:ur,nodebuffer:function(e){return Lt.newBufferFrom(e)}};Ze.nodebuffer={string:cr,array:function(e){return Gr(e,new Array(e.length))},arraybuffer:function(e){return Ze.nodebuffer.uint8array(e).buffer},uint8array:function(e){return Gr(e,new Uint8Array(e.length))},nodebuffer:ur};te.transformTo=function(e,t){if(t||(t=""),!e)return t;te.checkSupport(e);var r=te.getTypeOf(t),i=Ze[r][e](t);return i};te.getTypeOf=function(e){if(typeof e=="string")return"string";if(Object.prototype.toString.call(e)==="[object Array]")return"array";if(Ge.nodebuffer&&Lt.isBuffer(e))return"nodebuffer";if(Ge.uint8array&&e instanceof Uint8Array)return"uint8array";if(Ge.arraybuffer&&e instanceof ArrayBuffer)return"arraybuffer"};te.checkSupport=function(e){var t=Ge[e.toLowerCase()];if(!t)throw new Error(e+" is not supported by this platform")};te.MAX_VALUE_16BITS=65535;te.MAX_VALUE_32BITS=-1;te.pretty=function(e){var t="",r,i;for(i=0;i<(e||"").length;i++)r=e.charCodeAt(i),t+="\\x"+(r<16?"0":"")+r.toString(16).toUpperCase();return t};te.delay=function(e,t,r){Pf(function(){e.apply(r||null,t||[])})};te.inherits=function(e,t){var r=function(){};r.prototype=t.prototype,e.prototype=new r};te.extend=function(){var e={},t,r;for(t=0;t<arguments.length;t++)for(r in arguments[t])arguments[t].hasOwnProperty(r)&&typeof e[r]=="undefined"&&(e[r]=arguments[t][r]);return e};te.prepareContent=function(e,t,r,i,s){var n=Qi.Promise.resolve(t).then(function(o){var l=Ge.blob&&(o instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(o))!==-1);return l&&typeof FileReader!="undefined"?new Qi.Promise(function(c,u){var f=new FileReader;f.onload=function(S){c(S.target.result)},f.onerror=function(S){u(S.target.error)},f.readAsArrayBuffer(o)}):o});return n.then(function(o){var l=te.getTypeOf(o);return l?(l==="arraybuffer"?o=te.transformTo("uint8array",o):l==="string"&&(s?o=Mf.decode(o):r&&(i!==!0&&(o=Uf(o)))),o):Qi.Promise.reject(new Error("Can't read the data of '"+e+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}}),me=F((s_,Go)=>{"use strict";function Zo(e){this.name=e||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}Zo.prototype={push:function(e){this.emit("data",e)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(e){this.emit("error",e)}return!0},error:function(e){return this.isFinished?!1:(this.isPaused?this.generatedError=e:(this.isFinished=!0,this.emit("error",e),this.previous&&this.previous.error(e),this.cleanUp()),!0)},on:function(e,t){return this._listeners[e].push(t),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(e,t){if(this._listeners[e])for(var r=0;r<this._listeners[e].length;r++)this._listeners[e][r].call(this,t)},pipe:function(e){return e.registerPrevious(this)},registerPrevious:function(e){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=e.streamInfo,this.mergeStreamInfo(),this.previous=e;var t=this;return e.on("data",function(r){t.processChunk(r)}),e.on("end",function(){t.end()}),e.on("error",function(r){t.error(r)}),this},pause:function(){return this.isPaused||this.isFinished?!1:(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;this.isPaused=!1;var e=!1;return this.generatedError&&(this.error(this.generatedError),e=!0),this.previous&&this.previous.resume(),!e},flush:function(){},processChunk:function(e){this.push(e)},withStreamInfo:function(e,t){return this.extraStreamInfo[e]=t,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var e in this.extraStreamInfo){if(!this.extraStreamInfo.hasOwnProperty(e))continue;this.streamInfo[e]=this.extraStreamInfo[e]}},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var e="Worker "+this.name;return this.previous?this.previous+" -> "+e:e}};Go.exports=Zo}),pt=F(Xe=>{"use strict";var Ft=q(),mt=Ue(),zf=or(),Zr=me(),dr=new Array(256);for(var Ye=0;Ye<256;Ye++)dr[Ye]=Ye>=252?6:Ye>=248?5:Ye>=240?4:Ye>=224?3:Ye>=192?2:1;dr[254]=dr[254]=1;var Cf=function(e){var t,r,i,s,n,o=e.length,l=0;for(s=0;s<o;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(i=e.charCodeAt(s+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(mt.uint8array?t=new Uint8Array(l):t=new Array(l),n=0,s=0;n<l;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(i=e.charCodeAt(s+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),s++)),r<128?t[n++]=r:r<2048?(t[n++]=192|r>>>6,t[n++]=128|r&63):r<65536?(t[n++]=224|r>>>12,t[n++]=128|r>>>6&63,t[n++]=128|r&63):(t[n++]=240|r>>>18,t[n++]=128|r>>>12&63,t[n++]=128|r>>>6&63,t[n++]=128|r&63);return t},Hf=function(e,t){var r;for(t=t||e.length,t>e.length&&(t=e.length),r=t-1;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+dr[e[r]]>t?r:t},Wf=function(e){var t,r,i,s,n,o=e.length,l=new Array(o*2);for(i=0,r=0;r<o;){if(s=e[r++],s<128){l[i++]=s;continue}if(n=dr[s],n>4){l[i++]=65533,r+=n-1;continue}for(s&=n===2?31:n===3?15:7;n>1&&r<o;)s=s<<6|e[r++]&63,n--;if(n>1){l[i++]=65533;continue}s<65536?l[i++]=s:(s-=65536,l[i++]=55296|s>>10&1023,l[i++]=56320|s&1023)}return l.length!==i&&(l.subarray?l=l.subarray(0,i):l.length=i),Ft.applyFromCharCode(l)};Xe.utf8encode=function(t){return mt.nodebuffer?zf.newBufferFrom(t,"utf-8"):Cf(t)};Xe.utf8decode=function(t){return mt.nodebuffer?Ft.transformTo("nodebuffer",t).toString("utf-8"):(t=Ft.transformTo(mt.uint8array?"uint8array":"array",t),Wf(t))};function Xr(){Zr.call(this,"utf-8 decode"),this.leftOver=null}Ft.inherits(Xr,Zr);Xr.prototype.processChunk=function(e){var t=Ft.transformTo(mt.uint8array?"uint8array":"array",e.data);if(this.leftOver&&this.leftOver.length){if(mt.uint8array){var r=t;t=new Uint8Array(r.length+this.leftOver.length),t.set(this.leftOver,0),t.set(r,this.leftOver.length)}else t=this.leftOver.concat(t);this.leftOver=null}var i=Hf(t),s=t;i!==t.length&&(mt.uint8array?(s=t.subarray(0,i),this.leftOver=t.subarray(i,t.length)):(s=t.slice(0,i),this.leftOver=t.slice(i,t.length))),this.push({data:Xe.utf8decode(s),meta:e.meta})};Xr.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:Xe.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)};Xe.Utf8DecodeWorker=Xr;function en(){Zr.call(this,"utf-8 encode")}Ft.inherits(en,Zr);en.prototype.processChunk=function(e){this.push({data:Xe.utf8encode(e.data),meta:e.meta})};Xe.Utf8EncodeWorker=en}),Ko=F((a_,Xo)=>{"use strict";var Yo=me(),qo=q();function tn(e){Yo.call(this,"ConvertWorker to "+e),this.destType=e}qo.inherits(tn,Yo);tn.prototype.processChunk=function(e){this.push({data:qo.transformTo(this.destType,e.data),meta:e.meta})};Xo.exports=tn}),ea=F((l_,Jo)=>{"use strict";var Qo=Gi().Readable,jf=q();jf.inherits(rn,Qo);function rn(e,t,r){Qo.call(this,t),this._helper=e;var i=this;e.on("data",function(s,n){i.push(s)||i._helper.pause(),r&&r(n)}).on("error",function(s){i.emit("error",s)}).on("end",function(){i.push(null)})}rn.prototype._read=function(){this._helper.resume()};Jo.exports=rn}),nn=F((h_,ta)=>{"use strict";var bt=q(),$f=Ko(),Vf=me(),Gf=Xi(),Zf=Ue(),Xf=Bt(),ra=null;if(Zf.nodestream)try{ra=ea()}catch(e){}function Yf(e,t,r){switch(e){case"blob":return bt.newBlob(bt.transformTo("arraybuffer",t),r);case"base64":return Gf.encode(t);default:return bt.transformTo(e,t)}}function qf(e,t){var r,i=0,s=null,n=0;for(r=0;r<t.length;r++)n+=t[r].length;switch(e){case"string":return t.join("");case"array":return Array.prototype.concat.apply([],t);case"uint8array":for(s=new Uint8Array(n),r=0;r<t.length;r++)s.set(t[r],i),i+=t[r].length;return s;case"nodebuffer":return Buffer.concat(t);default:throw new Error("concat : unsupported type '"+e+"'")}}function Kf(e,t){return new Xf.Promise(function(r,i){var s=[],n=e._internalType,o=e._outputType,l=e._mimeType;e.on("data",function(c,u){s.push(c),t&&t(u)}).on("error",function(c){s=[],i(c)}).on("end",function(){try{var c=Yf(o,qf(n,s),l);r(c)}catch(u){i(u)}s=[]}).resume()})}function ia(e,t,r){var i=t;switch(t){case"blob":case"arraybuffer":i="uint8array";break;case"base64":i="string";break}try{this._internalType=i,this._outputType=t,this._mimeType=r,bt.checkSupport(i),this._worker=e.pipe(new $f(i)),e.lock()}catch(s){this._worker=new Vf("error"),this._worker.error(s)}}ia.prototype={accumulate:function(e){return Kf(this,e)},on:function(e,t){var r=this;return e==="data"?this._worker.on(e,function(i){t.call(r,i.data,i.meta)}):this._worker.on(e,function(){bt.delay(t,arguments,r)}),this},resume:function(){return bt.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(e){if(bt.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new ra(this,{objectMode:this._outputType!=="nodebuffer"},e)}};ta.exports=ia}),sn=F(Se=>{"use strict";Se.base64=!1;Se.binary=!1;Se.dir=!1;Se.createFolders=!0;Se.date=null;Se.compression=null;Se.compressionOptions=null;Se.comment=null;Se.unixPermissions=null;Se.dosPermissions=null}),on=F((c_,na)=>{"use strict";var Yr=q(),qr=me(),Jf=16*1024;function Mt(e){qr.call(this,"DataWorker");var t=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,e.then(function(r){t.dataIsReady=!0,t.data=r,t.max=r&&r.length||0,t.type=Yr.getTypeOf(r),t.isPaused||t._tickAndRepeat()},function(r){t.error(r)})}Yr.inherits(Mt,qr);Mt.prototype.cleanUp=function(){qr.prototype.cleanUp.call(this),this.data=null};Mt.prototype.resume=function(){return qr.prototype.resume.call(this)?(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,Yr.delay(this._tickAndRepeat,[],this)),!0):!1};Mt.prototype._tickAndRepeat=function(){if(this._tickScheduled=!1,this.isPaused||this.isFinished)return;this._tick(),this.isFinished||(Yr.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0)};Mt.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var e=Jf,t=null,r=Math.min(this.max,this.index+e);if(this.index>=this.max)return this.end();switch(this.type){case"string":t=this.data.substring(this.index,r);break;case"uint8array":t=this.data.subarray(this.index,r);break;case"array":case"nodebuffer":t=this.data.slice(this.index,r);break}return this.index=r,this.push({data:t,meta:{percent:this.max?this.index/this.max*100:0}})};na.exports=Mt}),hn=F((d_,sa)=>{"use strict";var Qf=q(),an=me();function ln(e){an.call(this,"DataLengthProbe for "+e),this.propName=e,this.withStreamInfo(e,0)}Qf.inherits(ln,an);ln.prototype.processChunk=function(e){if(e){var t=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=t+e.data.length}an.prototype.processChunk.call(this,e)};sa.exports=ln}),Kr=F((f_,oa)=>{"use strict";var em=q();function tm(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t}var aa=tm();function rm(e,t,r,i){var s=aa,n=i+r;e=e^-1;for(var o=i;o<n;o++)e=e>>>8^s[(e^t[o])&255];return e^-1}function im(e,t,r,i){var s=aa,n=i+r;e=e^-1;for(var o=i;o<n;o++)e=e>>>8^s[(e^t.charCodeAt(o))&255];return e^-1}oa.exports=function(t,r){if(typeof t=="undefined"||!t.length)return 0;var i=em.getTypeOf(t)!=="string";return i?rm(r|0,t,t.length,0):im(r|0,t,t.length,0)}}),cn=F((m_,la)=>{"use strict";var ha=me(),nm=Kr(),sm=q();function un(){ha.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}sm.inherits(un,ha);un.prototype.processChunk=function(e){this.streamInfo.crc32=nm(e.data,this.streamInfo.crc32||0),this.push(e)};la.exports=un}),Qr=F((p_,ua)=>{"use strict";var ca=Bt(),da=on(),Jr=hn(),om=cn(),Jr=hn();function dn(e,t,r,i,s){this.compressedSize=e,this.uncompressedSize=t,this.crc32=r,this.compression=i,this.compressedContent=s}dn.prototype={getContentWorker:function(){var e=new da(ca.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new Jr("data_length")),t=this;return e.on("end",function(){if(this.streamInfo.data_length!==t.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),e},getCompressedWorker:function(){return new da(ca.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}};dn.createWorkerFrom=function(e,t,r){return e.pipe(new om).pipe(new Jr("uncompressedSize")).pipe(t.compressWorker(r)).pipe(new Jr("compressedSize")).withStreamInfo("compression",t)};ua.exports=dn}),ba=F((b_,fa)=>{"use strict";var am=nn(),lm=on(),fn=pt(),mn=Qr(),ma=me(),pn=function(e,t,r){this.name=e,this.dir=r.dir,this.date=r.date,this.comment=r.comment,this.unixPermissions=r.unixPermissions,this.dosPermissions=r.dosPermissions,this._data=t,this._dataBinary=r.binary,this.options={compression:r.compression,compressionOptions:r.compressionOptions}};pn.prototype={internalStream:function(e){var t=null,r="string";try{if(!e)throw new Error("No output type specified.");r=e.toLowerCase();var i=r==="string"||r==="text";(r==="binarystring"||r==="text")&&(r="string"),t=this._decompressWorker();var s=!this._dataBinary;s&&!i&&(t=t.pipe(new fn.Utf8EncodeWorker)),!s&&i&&(t=t.pipe(new fn.Utf8DecodeWorker))}catch(n){t=new ma("error"),t.error(n)}return new am(t,r,"")},async:function(e,t){return this.internalStream(e).accumulate(t)},nodeStream:function(e,t){return this.internalStream(e||"nodebuffer").toNodejsStream(t)},_compressWorker:function(e,t){if(this._data instanceof mn&&this._data.compression.magic===e.magic)return this._data.getCompressedWorker();var r=this._decompressWorker();return this._dataBinary||(r=r.pipe(new fn.Utf8EncodeWorker)),mn.createWorkerFrom(r,e,t)},_decompressWorker:function(){return this._data instanceof mn?this._data.getContentWorker():this._data instanceof ma?this._data:new lm(this._data)}};var pa=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],hm=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")};for(var bn=0;bn<pa.length;bn++)pn.prototype[pa[bn]]=hm;fa.exports=pn}),ze=F(oe=>{"use strict";var um=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";function cm(e,t){return Object.prototype.hasOwnProperty.call(e,t)}oe.assign=function(e){for(var t=Array.prototype.slice.call(arguments,1);t.length;){var r=t.shift();if(!r)continue;if(typeof r!="object")throw new TypeError(r+"must be non-object");for(var i in r)cm(r,i)&&(e[i]=r[i])}return e};oe.shrinkBuf=function(e,t){return e.length===t?e:e.subarray?e.subarray(0,t):(e.length=t,e)};var dm={arraySet:function(e,t,r,i,s){if(t.subarray&&e.subarray){e.set(t.subarray(r,r+i),s);return}for(var n=0;n<i;n++)e[s+n]=t[r+n]},flattenChunks:function(e){var t,r,i,s,n,o;for(i=0,t=0,r=e.length;t<r;t++)i+=e[t].length;for(o=new Uint8Array(i),s=0,t=0,r=e.length;t<r;t++)n=e[t],o.set(n,s),s+=n.length;return o}},fm={arraySet:function(e,t,r,i,s){for(var n=0;n<i;n++)e[s+n]=t[r+n]},flattenChunks:function(e){return[].concat.apply([],e)}};oe.setTyped=function(e){e?(oe.Buf8=Uint8Array,oe.Buf16=Uint16Array,oe.Buf32=Int32Array,oe.assign(oe,dm)):(oe.Buf8=Array,oe.Buf16=Array,oe.Buf32=Array,oe.assign(oe,fm))};oe.setTyped(um)}),za=F(Pt=>{"use strict";var mm=ze(),pm=4,ga=0,_a=1,bm=2;function Ut(e){for(var t=e.length;--t>=0;)e[t]=0}var gm=0,wa=1,_m=2,wm=3,ym=258,gn=29,fr=256,mr=fr+1+gn,zt=30,_n=19,ya=2*mr+1,gt=15,wn=16,vm=7,yn=256,va=16,Sa=17,Ta=18,vn=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],ei=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],Sm=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],Ea=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Tm=512,Ce=new Array((mr+2)*2);Ut(Ce);var pr=new Array(zt*2);Ut(pr);var br=new Array(Tm);Ut(br);var gr=new Array(ym-wm+1);Ut(gr);var Sn=new Array(gn);Ut(Sn);var ti=new Array(zt);Ut(ti);function Tn(e,t,r,i,s){this.static_tree=e,this.extra_bits=t,this.extra_base=r,this.elems=i,this.max_length=s,this.has_stree=e&&e.length}var xa,Ia,Oa;function En(e,t){this.dyn_tree=e,this.max_code=0,this.stat_desc=t}function Aa(e){return e<256?br[e]:br[256+(e>>>7)]}function _r(e,t){e.pending_buf[e.pending++]=t&255,e.pending_buf[e.pending++]=t>>>8&255}function ue(e,t,r){e.bi_valid>wn-r?(e.bi_buf|=t<<e.bi_valid&65535,_r(e,e.bi_buf),e.bi_buf=t>>wn-e.bi_valid,e.bi_valid+=r-wn):(e.bi_buf|=t<<e.bi_valid&65535,e.bi_valid+=r)}function ke(e,t,r){ue(e,r[t*2],r[t*2+1])}function Da(e,t){var r=0;do r|=e&1,e>>>=1,r<<=1;while(--t>0);return r>>>1}function Em(e){e.bi_valid===16?(_r(e,e.bi_buf),e.bi_buf=0,e.bi_valid=0):e.bi_valid>=8&&(e.pending_buf[e.pending++]=e.bi_buf&255,e.bi_buf>>=8,e.bi_valid-=8)}function xm(e,t){var r=t.dyn_tree,i=t.max_code,s=t.stat_desc.static_tree,n=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,l=t.stat_desc.extra_base,c=t.stat_desc.max_length,u,f,S,g,b,T,O=0;for(g=0;g<=gt;g++)e.bl_count[g]=0;for(r[e.heap[e.heap_max]*2+1]=0,u=e.heap_max+1;u<ya;u++){if(f=e.heap[u],g=r[r[f*2+1]*2+1]+1,g>c&&(g=c,O++),r[f*2+1]=g,f>i)continue;e.bl_count[g]++,b=0,f>=l&&(b=o[f-l]),T=r[f*2],e.opt_len+=T*(g+b),n&&(e.static_len+=T*(s[f*2+1]+b))}if(O===0)return;do{for(g=c-1;e.bl_count[g]===0;)g--;e.bl_count[g]--,e.bl_count[g+1]+=2,e.bl_count[c]--,O-=2}while(O>0);for(g=c;g!==0;g--)for(f=e.bl_count[g];f!==0;){if(S=e.heap[--u],S>i)continue;r[S*2+1]!==g&&(e.opt_len+=(g-r[S*2+1])*r[S*2],r[S*2+1]=g),f--}}function Na(e,t,r){var i=new Array(gt+1),s=0,n,o;for(n=1;n<=gt;n++)i[n]=s=s+r[n-1]<<1;for(o=0;o<=t;o++){var l=e[o*2+1];if(l===0)continue;e[o*2]=Da(i[l]++,l)}}function Im(){var e,t,r,i,s,n=new Array(gt+1);for(r=0,i=0;i<gn-1;i++)for(Sn[i]=r,e=0;e<1<<vn[i];e++)gr[r++]=i;for(gr[r-1]=i,s=0,i=0;i<16;i++)for(ti[i]=s,e=0;e<1<<ei[i];e++)br[s++]=i;for(s>>=7;i<zt;i++)for(ti[i]=s<<7,e=0;e<1<<ei[i]-7;e++)br[256+s++]=i;for(t=0;t<=gt;t++)n[t]=0;for(e=0;e<=143;)Ce[e*2+1]=8,e++,n[8]++;for(;e<=255;)Ce[e*2+1]=9,e++,n[9]++;for(;e<=279;)Ce[e*2+1]=7,e++,n[7]++;for(;e<=287;)Ce[e*2+1]=8,e++,n[8]++;for(Na(Ce,mr+1,n),e=0;e<zt;e++)pr[e*2+1]=5,pr[e*2]=Da(e,5);xa=new Tn(Ce,vn,fr+1,mr,gt),Ia=new Tn(pr,ei,0,zt,gt),Oa=new Tn(new Array(0),Sm,0,_n,vm)}function ka(e){var t;for(t=0;t<mr;t++)e.dyn_ltree[t*2]=0;for(t=0;t<zt;t++)e.dyn_dtree[t*2]=0;for(t=0;t<_n;t++)e.bl_tree[t*2]=0;e.dyn_ltree[yn*2]=1,e.opt_len=e.static_len=0,e.last_lit=e.matches=0}function Ra(e){e.bi_valid>8?_r(e,e.bi_buf):e.bi_valid>0&&(e.pending_buf[e.pending++]=e.bi_buf),e.bi_buf=0,e.bi_valid=0}function Om(e,t,r,i){Ra(e),i&&(_r(e,r),_r(e,~r)),mm.arraySet(e.pending_buf,e.window,t,r,e.pending),e.pending+=r}function Ba(e,t,r,i){var s=t*2,n=r*2;return e[s]<e[n]||e[s]===e[n]&&i[t]<=i[r]}function xn(e,t,r){for(var i=e.heap[r],s=r<<1;s<=e.heap_len&&!(s<e.heap_len&&Ba(t,e.heap[s+1],e.heap[s],e.depth)&&s++,Ba(t,i,e.heap[s],e.depth));)e.heap[r]=e.heap[s],r=s,s<<=1;e.heap[r]=i}function La(e,t,r){var i,s,n=0,o,l;if(e.last_lit!==0)do i=e.pending_buf[e.d_buf+n*2]<<8|e.pending_buf[e.d_buf+n*2+1],s=e.pending_buf[e.l_buf+n],n++,i===0?ke(e,s,t):(o=gr[s],ke(e,o+fr+1,t),l=vn[o],l!==0&&(s-=Sn[o],ue(e,s,l)),i--,o=Aa(i),ke(e,o,r),l=ei[o],l!==0&&(i-=ti[o],ue(e,i,l)));while(n<e.last_lit);ke(e,yn,t)}function In(e,t){var r=t.dyn_tree,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,n=t.stat_desc.elems,o,l,c=-1,u;for(e.heap_len=0,e.heap_max=ya,o=0;o<n;o++)r[o*2]!==0?(e.heap[++e.heap_len]=c=o,e.depth[o]=0):r[o*2+1]=0;for(;e.heap_len<2;)u=e.heap[++e.heap_len]=c<2?++c:0,r[u*2]=1,e.depth[u]=0,e.opt_len--,s&&(e.static_len-=i[u*2+1]);for(t.max_code=c,o=e.heap_len>>1;o>=1;o--)xn(e,r,o);u=n;do o=e.heap[1],e.heap[1]=e.heap[e.heap_len--],xn(e,r,1),l=e.heap[1],e.heap[--e.heap_max]=o,e.heap[--e.heap_max]=l,r[u*2]=r[o*2]+r[l*2],e.depth[u]=(e.depth[o]>=e.depth[l]?e.depth[o]:e.depth[l])+1,r[o*2+1]=r[l*2+1]=u,e.heap[1]=u++,xn(e,r,1);while(e.heap_len>=2);e.heap[--e.heap_max]=e.heap[1],xm(e,t),Na(r,c,e.bl_count)}function Fa(e,t,r){var i,s=-1,n,o=t[0*2+1],l=0,c=7,u=4;for(o===0&&(c=138,u=3),t[(r+1)*2+1]=65535,i=0;i<=r;i++){if(n=o,o=t[(i+1)*2+1],++l<c&&n===o)continue;l<u?e.bl_tree[n*2]+=l:n!==0?(n!==s&&e.bl_tree[n*2]++,e.bl_tree[va*2]++):l<=10?e.bl_tree[Sa*2]++:e.bl_tree[Ta*2]++,l=0,s=n,o===0?(c=138,u=3):n===o?(c=6,u=3):(c=7,u=4)}}function Ma(e,t,r){var i,s=-1,n,o=t[0*2+1],l=0,c=7,u=4;for(o===0&&(c=138,u=3),i=0;i<=r;i++){if(n=o,o=t[(i+1)*2+1],++l<c&&n===o)continue;if(l<u)do ke(e,n,e.bl_tree);while(--l!==0);else n!==0?(n!==s&&(ke(e,n,e.bl_tree),l--),ke(e,va,e.bl_tree),ue(e,l-3,2)):l<=10?(ke(e,Sa,e.bl_tree),ue(e,l-3,3)):(ke(e,Ta,e.bl_tree),ue(e,l-11,7));l=0,s=n,o===0?(c=138,u=3):n===o?(c=6,u=3):(c=7,u=4)}}function Am(e){var t;for(Fa(e,e.dyn_ltree,e.l_desc.max_code),Fa(e,e.dyn_dtree,e.d_desc.max_code),In(e,e.bl_desc),t=_n-1;t>=3&&!(e.bl_tree[Ea[t]*2+1]!==0);t--);return e.opt_len+=3*(t+1)+5+5+4,t}function Dm(e,t,r,i){var s;for(ue(e,t-257,5),ue(e,r-1,5),ue(e,i-4,4),s=0;s<i;s++)ue(e,e.bl_tree[Ea[s]*2+1],3);Ma(e,e.dyn_ltree,t-1),Ma(e,e.dyn_dtree,r-1)}function Nm(e){var t=4093624447,r;for(r=0;r<=31;r++,t>>>=1)if(t&1&&e.dyn_ltree[r*2]!==0)return ga;if(e.dyn_ltree[9*2]!==0||e.dyn_ltree[10*2]!==0||e.dyn_ltree[13*2]!==0)return _a;for(r=32;r<fr;r++)if(e.dyn_ltree[r*2]!==0)return _a;return ga}var Pa=!1;function km(e){Pa||(Im(),Pa=!0),e.l_desc=new En(e.dyn_ltree,xa),e.d_desc=new En(e.dyn_dtree,Ia),e.bl_desc=new En(e.bl_tree,Oa),e.bi_buf=0,e.bi_valid=0,ka(e)}function Ua(e,t,r,i){ue(e,(gm<<1)+(i?1:0),3),Om(e,t,r,!0)}function Rm(e){ue(e,wa<<1,3),ke(e,yn,Ce),Em(e)}function Bm(e,t,r,i){var s,n,o=0;e.level>0?(e.strm.data_type===bm&&(e.strm.data_type=Nm(e)),In(e,e.l_desc),In(e,e.d_desc),o=Am(e),s=e.opt_len+3+7>>>3,n=e.static_len+3+7>>>3,n<=s&&(s=n)):s=n=r+5,r+4<=s&&t!==-1?Ua(e,t,r,i):e.strategy===pm||n===s?(ue(e,(wa<<1)+(i?1:0),3),La(e,Ce,pr)):(ue(e,(_m<<1)+(i?1:0),3),Dm(e,e.l_desc.max_code+1,e.d_desc.max_code+1,o+1),La(e,e.dyn_ltree,e.dyn_dtree)),ka(e),i&&Ra(e)}function Lm(e,t,r){return e.pending_buf[e.d_buf+e.last_lit*2]=t>>>8&255,e.pending_buf[e.d_buf+e.last_lit*2+1]=t&255,e.pending_buf[e.l_buf+e.last_lit]=r&255,e.last_lit++,t===0?e.dyn_ltree[r*2]++:(e.matches++,t--,e.dyn_ltree[(gr[r]+fr+1)*2]++,e.dyn_dtree[Aa(t)*2]++),e.last_lit===e.lit_bufsize-1}Pt._tr_init=km;Pt._tr_stored_block=Ua;Pt._tr_flush_block=Bm;Pt._tr_tally=Lm;Pt._tr_align=Rm}),On=F((w_,Ca)=>{"use strict";function Fm(e,t,r,i){for(var s=e&65535|0,n=e>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do s=s+t[i++]|0,n=n+s|0;while(--o);s%=65521,n%=65521}return s|n<<16|0}Ca.exports=Fm}),An=F((y_,Ha)=>{"use strict";function Mm(){for(var e,t=[],r=0;r<256;r++){e=r;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[r]=e}return t}var Pm=Mm();function Um(e,t,r,i){var s=Pm,n=i+r;e^=-1;for(var o=i;o<n;o++)e=e>>>8^s[(e^t[o])&255];return e^-1}Ha.exports=Um}),ri=F((v_,Wa)=>{"use strict";Wa.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}}),Ka=F(Re=>{"use strict";var ae=ze(),be=za(),ja=On(),qe=An(),zm=ri(),_t=0,Cm=1,Hm=3,Ke=4,$a=5,Be=0,Va=1,ge=-2,Wm=-3,Dn=-5,jm=-1,$m=1,ii=2,Vm=3,Gm=4,Zm=0,Xm=2,ni=8,Ym=9,qm=15,Km=8,Jm=29,Qm=256,Nn=Qm+1+Jm,ep=30,tp=19,rp=2*Nn+1,ip=15,G=3,Je=258,Te=Je+G+1,np=32,si=42,kn=69,oi=73,ai=91,li=103,wt=113,wr=666,re=1,yr=2,yt=3,Ct=4,sp=3;function Qe(e,t){return e.msg=zm[t],t}function Ga(e){return(e<<1)-(e>4?9:0)}function et(e){for(var t=e.length;--t>=0;)e[t]=0}function tt(e){var t=e.state,r=t.pending;if(r>e.avail_out&&(r=e.avail_out),r===0)return;ae.arraySet(e.output,t.pending_buf,t.pending_out,r,e.next_out),e.next_out+=r,t.pending_out+=r,e.total_out+=r,e.avail_out-=r,t.pending-=r,t.pending===0&&(t.pending_out=0)}function ie(e,t){be._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,t),e.block_start=e.strstart,tt(e.strm)}function Z(e,t){e.pending_buf[e.pending++]=t}function vr(e,t){e.pending_buf[e.pending++]=t>>>8&255,e.pending_buf[e.pending++]=t&255}function op(e,t,r,i){var s=e.avail_in;return s>i&&(s=i),s===0?0:(e.avail_in-=s,ae.arraySet(t,e.input,e.next_in,s,r),e.state.wrap===1?e.adler=ja(e.adler,t,s,r):e.state.wrap===2&&(e.adler=qe(e.adler,t,s,r)),e.next_in+=s,e.total_in+=s,s)}function Za(e,t){var r=e.max_chain_length,i=e.strstart,s,n,o=e.prev_length,l=e.nice_match,c=e.strstart>e.w_size-Te?e.strstart-(e.w_size-Te):0,u=e.window,f=e.w_mask,S=e.prev,g=e.strstart+Je,b=u[i+o-1],T=u[i+o];e.prev_length>=e.good_match&&(r>>=2),l>e.lookahead&&(l=e.lookahead);do{if(s=t,u[s+o]!==T||u[s+o-1]!==b||u[s]!==u[i]||u[++s]!==u[i+1])continue;i+=2,s++;do;while(u[++i]===u[++s]&&u[++i]===u[++s]&&u[++i]===u[++s]&&u[++i]===u[++s]&&u[++i]===u[++s]&&u[++i]===u[++s]&&u[++i]===u[++s]&&u[++i]===u[++s]&&i<g);if(n=Je-(g-i),i=g-Je,n>o){if(e.match_start=t,o=n,n>=l)break;b=u[i+o-1],T=u[i+o]}}while((t=S[t&f])>c&&--r!==0);return o<=e.lookahead?o:e.lookahead}function vt(e){var t=e.w_size,r,i,s,n,o;do{if(n=e.window_size-e.lookahead-e.strstart,e.strstart>=t+(t-Te)){ae.arraySet(e.window,e.window,t,t,0),e.match_start-=t,e.strstart-=t,e.block_start-=t,i=e.hash_size,r=i;do s=e.head[--r],e.head[r]=s>=t?s-t:0;while(--i);i=t,r=i;do s=e.prev[--r],e.prev[r]=s>=t?s-t:0;while(--i);n+=t}if(e.strm.avail_in===0)break;if(i=op(e.strm,e.window,e.strstart+e.lookahead,n),e.lookahead+=i,e.lookahead+e.insert>=G)for(o=e.strstart-e.insert,e.ins_h=e.window[o],e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+1])&e.hash_mask;e.insert&&!(e.ins_h=(e.ins_h<<e.hash_shift^e.window[o+G-1])&e.hash_mask,e.prev[o&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=o,o++,e.insert--,e.lookahead+e.insert<G););}while(e.lookahead<Te&&e.strm.avail_in!==0)}function ap(e,t){var r=65535;for(r>e.pending_buf_size-5&&(r=e.pending_buf_size-5);;){if(e.lookahead<=1){if(vt(e),e.lookahead===0&&t===_t)return re;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var i=e.block_start+r;if((e.strstart===0||e.strstart>=i)&&(e.lookahead=e.strstart-i,e.strstart=i,ie(e,!1),e.strm.avail_out===0))return re;if(e.strstart-e.block_start>=e.w_size-Te&&(ie(e,!1),e.strm.avail_out===0))return re}return e.insert=0,t===Ke?(ie(e,!0),e.strm.avail_out===0?yt:Ct):(e.strstart>e.block_start&&(ie(e,!1),e.strm.avail_out===0),re)}function Rn(e,t){for(var r,i;;){if(e.lookahead<Te){if(vt(e),e.lookahead<Te&&t===_t)return re;if(e.lookahead===0)break}if(r=0,e.lookahead>=G&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+G-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),r!==0&&e.strstart-r<=e.w_size-Te&&(e.match_length=Za(e,r)),e.match_length>=G)if(i=be._tr_tally(e,e.strstart-e.match_start,e.match_length-G),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=G){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+G-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else i=be._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(i&&(ie(e,!1),e.strm.avail_out===0))return re}return e.insert=e.strstart<G-1?e.strstart:G-1,t===Ke?(ie(e,!0),e.strm.avail_out===0?yt:Ct):e.last_lit&&(ie(e,!1),e.strm.avail_out===0)?re:yr}function Ht(e,t){for(var r,i,s;;){if(e.lookahead<Te){if(vt(e),e.lookahead<Te&&t===_t)return re;if(e.lookahead===0)break}if(r=0,e.lookahead>=G&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+G-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=G-1,r!==0&&e.prev_length<e.max_lazy_match&&e.strstart-r<=e.w_size-Te&&(e.match_length=Za(e,r),e.match_length<=5&&(e.strategy===$m||e.match_length===G&&e.strstart-e.match_start>4096)&&(e.match_length=G-1)),e.prev_length>=G&&e.match_length<=e.prev_length){s=e.strstart+e.lookahead-G,i=be._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-G),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=s&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+G-1])&e.hash_mask,r=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=G-1,e.strstart++,i&&(ie(e,!1),e.strm.avail_out===0))return re}else if(e.match_available){if(i=be._tr_tally(e,0,e.window[e.strstart-1]),i&&ie(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return re}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(i=be._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<G-1?e.strstart:G-1,t===Ke?(ie(e,!0),e.strm.avail_out===0?yt:Ct):e.last_lit&&(ie(e,!1),e.strm.avail_out===0)?re:yr}function lp(e,t){for(var r,i,s,n,o=e.window;;){if(e.lookahead<=Je){if(vt(e),e.lookahead<=Je&&t===_t)return re;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=G&&e.strstart>0&&(s=e.strstart-1,i=o[s],i===o[++s]&&i===o[++s]&&i===o[++s])){n=e.strstart+Je;do;while(i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&i===o[++s]&&s<n);e.match_length=Je-(n-s),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=G?(r=be._tr_tally(e,1,e.match_length-G),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(r=be._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),r&&(ie(e,!1),e.strm.avail_out===0))return re}return e.insert=0,t===Ke?(ie(e,!0),e.strm.avail_out===0?yt:Ct):e.last_lit&&(ie(e,!1),e.strm.avail_out===0)?re:yr}function hp(e,t){for(var r;;){if(e.lookahead===0&&(vt(e),e.lookahead===0)){if(t===_t)return re;break}if(e.match_length=0,r=be._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,r&&(ie(e,!1),e.strm.avail_out===0))return re}return e.insert=0,t===Ke?(ie(e,!0),e.strm.avail_out===0?yt:Ct):e.last_lit&&(ie(e,!1),e.strm.avail_out===0)?re:yr}function Le(e,t,r,i,s){this.good_length=e,this.max_lazy=t,this.nice_length=r,this.max_chain=i,this.func=s}var Wt;Wt=[new Le(0,0,0,0,ap),new Le(4,4,8,4,Rn),new Le(4,5,16,8,Rn),new Le(4,6,32,32,Rn),new Le(4,4,16,16,Ht),new Le(8,16,32,32,Ht),new Le(8,16,128,128,Ht),new Le(8,32,128,256,Ht),new Le(32,128,258,1024,Ht),new Le(32,258,258,4096,Ht)];function up(e){e.window_size=2*e.w_size,et(e.head),e.max_lazy_match=Wt[e.level].max_lazy,e.good_match=Wt[e.level].good_length,e.nice_match=Wt[e.level].nice_length,e.max_chain_length=Wt[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=G-1,e.match_available=0,e.ins_h=0}function cp(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=ni,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new ae.Buf16(rp*2),this.dyn_dtree=new ae.Buf16((2*ep+1)*2),this.bl_tree=new ae.Buf16((2*tp+1)*2),et(this.dyn_ltree),et(this.dyn_dtree),et(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new ae.Buf16(ip+1),this.heap=new ae.Buf16(2*Nn+1),et(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new ae.Buf16(2*Nn+1),et(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Xa(e){var t;return!e||!e.state?Qe(e,ge):(e.total_in=e.total_out=0,e.data_type=Xm,t=e.state,t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?si:wt,e.adler=t.wrap===2?0:1,t.last_flush=_t,be._tr_init(t),Be)}function Ya(e){var t=Xa(e);return t===Be&&up(e.state),t}function dp(e,t){return!e||!e.state||e.state.wrap!==2?ge:(e.state.gzhead=t,Be)}function qa(e,t,r,i,s,n){if(!e)return ge;var o=1;if(t===jm&&(t=6),i<0?(o=0,i=-i):i>15&&(o=2,i-=16),s<1||s>Ym||r!==ni||i<8||i>15||t<0||t>9||n<0||n>Gm)return Qe(e,ge);i===8&&(i=9);var l=new cp;return e.state=l,l.strm=e,l.wrap=o,l.gzhead=null,l.w_bits=i,l.w_size=1<<l.w_bits,l.w_mask=l.w_size-1,l.hash_bits=s+7,l.hash_size=1<<l.hash_bits,l.hash_mask=l.hash_size-1,l.hash_shift=~~((l.hash_bits+G-1)/G),l.window=new ae.Buf8(l.w_size*2),l.head=new ae.Buf16(l.hash_size),l.prev=new ae.Buf16(l.w_size),l.lit_bufsize=1<<s+6,l.pending_buf_size=l.lit_bufsize*4,l.pending_buf=new ae.Buf8(l.pending_buf_size),l.d_buf=1*l.lit_bufsize,l.l_buf=(1+2)*l.lit_bufsize,l.level=t,l.strategy=n,l.method=r,Ya(e)}function fp(e,t){return qa(e,t,ni,qm,Km,Zm)}function mp(e,t){var r,i,s,n;if(!e||!e.state||t>$a||t<0)return e?Qe(e,ge):ge;if(i=e.state,!e.output||!e.input&&e.avail_in!==0||i.status===wr&&t!==Ke)return Qe(e,e.avail_out===0?Dn:ge);if(i.strm=e,r=i.last_flush,i.last_flush=t,i.status===si)if(i.wrap===2)e.adler=0,Z(i,31),Z(i,139),Z(i,8),i.gzhead?(Z(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),Z(i,i.gzhead.time&255),Z(i,i.gzhead.time>>8&255),Z(i,i.gzhead.time>>16&255),Z(i,i.gzhead.time>>24&255),Z(i,i.level===9?2:i.strategy>=ii||i.level<2?4:0),Z(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&(Z(i,i.gzhead.extra.length&255),Z(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(e.adler=qe(e.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=kn):(Z(i,0),Z(i,0),Z(i,0),Z(i,0),Z(i,0),Z(i,i.level===9?2:i.strategy>=ii||i.level<2?4:0),Z(i,sp),i.status=wt);else{var o=ni+(i.w_bits-8<<4)<<8,l=-1;i.strategy>=ii||i.level<2?l=0:i.level<6?l=1:i.level===6?l=2:l=3,o|=l<<6,i.strstart!==0&&(o|=np),o+=31-o%31,i.status=wt,vr(i,o),i.strstart!==0&&(vr(i,e.adler>>>16),vr(i,e.adler&65535)),e.adler=1}if(i.status===kn)if(i.gzhead.extra){for(s=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=qe(e.adler,i.pending_buf,i.pending-s,s)),tt(e),s=i.pending,i.pending===i.pending_buf_size));)Z(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>s&&(e.adler=qe(e.adler,i.pending_buf,i.pending-s,s)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=oi)}else i.status=oi;if(i.status===oi)if(i.gzhead.name){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=qe(e.adler,i.pending_buf,i.pending-s,s)),tt(e),s=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.name.length?n=i.gzhead.name.charCodeAt(i.gzindex++)&255:n=0,Z(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>s&&(e.adler=qe(e.adler,i.pending_buf,i.pending-s,s)),n===0&&(i.gzindex=0,i.status=ai)}else i.status=ai;if(i.status===ai)if(i.gzhead.comment){s=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>s&&(e.adler=qe(e.adler,i.pending_buf,i.pending-s,s)),tt(e),s=i.pending,i.pending===i.pending_buf_size)){n=1;break}i.gzindex<i.gzhead.comment.length?n=i.gzhead.comment.charCodeAt(i.gzindex++)&255:n=0,Z(i,n)}while(n!==0);i.gzhead.hcrc&&i.pending>s&&(e.adler=qe(e.adler,i.pending_buf,i.pending-s,s)),n===0&&(i.status=li)}else i.status=li;if(i.status===li&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&tt(e),i.pending+2<=i.pending_buf_size&&(Z(i,e.adler&255),Z(i,e.adler>>8&255),e.adler=0,i.status=wt)):i.status=wt),i.pending!==0){if(tt(e),e.avail_out===0)return i.last_flush=-1,Be}else if(e.avail_in===0&&Ga(t)<=Ga(r)&&t!==Ke)return Qe(e,Dn);if(i.status===wr&&e.avail_in!==0)return Qe(e,Dn);if(e.avail_in!==0||i.lookahead!==0||t!==_t&&i.status!==wr){var c=i.strategy===ii?hp(i,t):i.strategy===Vm?lp(i,t):Wt[i.level].func(i,t);if((c===yt||c===Ct)&&(i.status=wr),c===re||c===yt)return e.avail_out===0&&(i.last_flush=-1),Be;if(c===yr&&(t===Cm?be._tr_align(i):t!==$a&&(be._tr_stored_block(i,0,0,!1),t===Hm&&(et(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),tt(e),e.avail_out===0))return i.last_flush=-1,Be}return t!==Ke?Be:i.wrap<=0?Va:(i.wrap===2?(Z(i,e.adler&255),Z(i,e.adler>>8&255),Z(i,e.adler>>16&255),Z(i,e.adler>>24&255),Z(i,e.total_in&255),Z(i,e.total_in>>8&255),Z(i,e.total_in>>16&255),Z(i,e.total_in>>24&255)):(vr(i,e.adler>>>16),vr(i,e.adler&65535)),tt(e),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Be:Va)}function pp(e){var t;return!e||!e.state?ge:(t=e.state.status,t!==si&&t!==kn&&t!==oi&&t!==ai&&t!==li&&t!==wt&&t!==wr?Qe(e,ge):(e.state=null,t===wt?Qe(e,Wm):Be))}function bp(e,t){var r=t.length,i,s,n,o,l,c,u,f;if(!e||!e.state)return ge;if(i=e.state,o=i.wrap,o===2||o===1&&i.status!==si||i.lookahead)return ge;for(o===1&&(e.adler=ja(e.adler,t,r,0)),i.wrap=0,r>=i.w_size&&(o===0&&(et(i.head),i.strstart=0,i.block_start=0,i.insert=0),f=new ae.Buf8(i.w_size),ae.arraySet(f,t,r-i.w_size,i.w_size,0),t=f,r=i.w_size),l=e.avail_in,c=e.next_in,u=e.input,e.avail_in=r,e.next_in=0,e.input=t,vt(i);i.lookahead>=G;){s=i.strstart,n=i.lookahead-(G-1);do i.ins_h=(i.ins_h<<i.hash_shift^i.window[s+G-1])&i.hash_mask,i.prev[s&i.w_mask]=i.head[i.ins_h],i.head[i.ins_h]=s,s++;while(--n);i.strstart=s,i.lookahead=G-1,vt(i)}return i.strstart+=i.lookahead,i.block_start=i.strstart,i.insert=i.lookahead,i.lookahead=0,i.match_length=i.prev_length=G-1,i.match_available=0,e.next_in=c,e.input=u,e.avail_in=l,i.wrap=o,Be}Re.deflateInit=fp;Re.deflateInit2=qa;Re.deflateReset=Ya;Re.deflateResetKeep=Xa;Re.deflateSetHeader=dp;Re.deflate=mp;Re.deflateEnd=pp;Re.deflateSetDictionary=bp;Re.deflateInfo="pako deflate (from Nodeca project)"}),Bn=F(jt=>{"use strict";var hi=ze(),Ja=!0,Qa=!0;try{String.fromCharCode.apply(null,[0])}catch(e){Ja=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch(e){Qa=!1}var Sr=new hi.Buf8(256);for(var rt=0;rt<256;rt++)Sr[rt]=rt>=252?6:rt>=248?5:rt>=240?4:rt>=224?3:rt>=192?2:1;Sr[254]=Sr[254]=1;jt.string2buf=function(e){var t,r,i,s,n,o=e.length,l=0;for(s=0;s<o;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(i=e.charCodeAt(s+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),s++)),l+=r<128?1:r<2048?2:r<65536?3:4;for(t=new hi.Buf8(l),n=0,s=0;n<l;s++)r=e.charCodeAt(s),(r&64512)===55296&&s+1<o&&(i=e.charCodeAt(s+1),(i&64512)===56320&&(r=65536+(r-55296<<10)+(i-56320),s++)),r<128?t[n++]=r:r<2048?(t[n++]=192|r>>>6,t[n++]=128|r&63):r<65536?(t[n++]=224|r>>>12,t[n++]=128|r>>>6&63,t[n++]=128|r&63):(t[n++]=240|r>>>18,t[n++]=128|r>>>12&63,t[n++]=128|r>>>6&63,t[n++]=128|r&63);return t};function el(e,t){if(t<65534&&(e.subarray&&Qa||!e.subarray&&Ja))return String.fromCharCode.apply(null,hi.shrinkBuf(e,t));for(var r="",i=0;i<t;i++)r+=String.fromCharCode(e[i]);return r}jt.buf2binstring=function(e){return el(e,e.length)};jt.binstring2buf=function(e){for(var t=new hi.Buf8(e.length),r=0,i=t.length;r<i;r++)t[r]=e.charCodeAt(r);return t};jt.buf2string=function(e,t){var r,i,s,n,o=t||e.length,l=new Array(o*2);for(i=0,r=0;r<o;){if(s=e[r++],s<128){l[i++]=s;continue}if(n=Sr[s],n>4){l[i++]=65533,r+=n-1;continue}for(s&=n===2?31:n===3?15:7;n>1&&r<o;)s=s<<6|e[r++]&63,n--;if(n>1){l[i++]=65533;continue}s<65536?l[i++]=s:(s-=65536,l[i++]=55296|s>>10&1023,l[i++]=56320|s&1023)}return el(l,i)};jt.utf8border=function(e,t){var r;for(t=t||e.length,t>e.length&&(t=e.length),r=t-1;r>=0&&(e[r]&192)===128;)r--;return r<0||r===0?t:r+Sr[e[r]]>t?r:t}}),Ln=F((E_,tl)=>{"use strict";function gp(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}tl.exports=gp}),sl=F(Tr=>{"use strict";var Er=Ka(),xr=ze(),Fn=Bn(),Mn=ri(),_p=Ln(),rl=Object.prototype.toString,wp=0,Pn=4,$t=0,il=1,nl=2,yp=-1,vp=0,Sp=8;function St(e){if(!(this instanceof St))return new St(e);this.options=xr.assign({level:yp,method:Sp,chunkSize:16384,windowBits:15,memLevel:8,strategy:vp,to:""},e||{});var t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new _p,this.strm.avail_out=0;var r=Er.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(r!==$t)throw new Error(Mn[r]);if(t.header&&Er.deflateSetHeader(this.strm,t.header),t.dictionary){var i;if(typeof t.dictionary=="string"?i=Fn.string2buf(t.dictionary):rl.call(t.dictionary)==="[object ArrayBuffer]"?i=new Uint8Array(t.dictionary):i=t.dictionary,r=Er.deflateSetDictionary(this.strm,i),r!==$t)throw new Error(Mn[r]);this._dict_set=!0}}St.prototype.push=function(e,t){var r=this.strm,i=this.options.chunkSize,s,n;if(this.ended)return!1;n=t===~~t?t:t===!0?Pn:wp,typeof e=="string"?r.input=Fn.string2buf(e):rl.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new xr.Buf8(i),r.next_out=0,r.avail_out=i),s=Er.deflate(r,n),s!==il&&s!==$t)return this.onEnd(s),this.ended=!0,!1;(r.avail_out===0||r.avail_in===0&&(n===Pn||n===nl))&&(this.options.to==="string"?this.onData(Fn.buf2binstring(xr.shrinkBuf(r.output,r.next_out))):this.onData(xr.shrinkBuf(r.output,r.next_out)))}while((r.avail_in>0||r.avail_out===0)&&s!==il);return n===Pn?(s=Er.deflateEnd(this.strm),this.onEnd(s),this.ended=!0,s===$t):(n===nl&&(this.onEnd($t),r.avail_out=0),!0)};St.prototype.onData=function(e){this.chunks.push(e)};St.prototype.onEnd=function(e){e===$t&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=xr.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function Un(e,t){var r=new St(t);if(r.push(e,!0),r.err)throw r.msg||Mn[r.err];return r.result}function Tp(e,t){return t=t||{},t.raw=!0,Un(e,t)}function Ep(e,t){return t=t||{},t.gzip=!0,Un(e,t)}Tr.Deflate=St;Tr.deflate=Un;Tr.deflateRaw=Tp;Tr.gzip=Ep}),al=F((I_,ol)=>{"use strict";var ui=30,xp=12;ol.exports=function(t,r){var i,s,n,o,l,c,u,f,S,g,b,T,O,I,v,N,$,P,D,H,U,z,E,R,M;i=t.state,s=t.next_in,R=t.input,n=s+(t.avail_in-5),o=t.next_out,M=t.output,l=o-(r-t.avail_out),c=o+(t.avail_out-257),u=i.dmax,f=i.wsize,S=i.whave,g=i.wnext,b=i.window,T=i.hold,O=i.bits,I=i.lencode,v=i.distcode,N=(1<<i.lenbits)-1,$=(1<<i.distbits)-1;e:do{O<15&&(T+=R[s++]<<O,O+=8,T+=R[s++]<<O,O+=8),P=I[T&N];t:for(;;){if(D=P>>>24,T>>>=D,O-=D,D=P>>>16&255,D===0)M[o++]=P&65535;else if(D&16){H=P&65535,D&=15,D&&(O<D&&(T+=R[s++]<<O,O+=8),H+=T&(1<<D)-1,T>>>=D,O-=D),O<15&&(T+=R[s++]<<O,O+=8,T+=R[s++]<<O,O+=8),P=v[T&$];r:for(;;){if(D=P>>>24,T>>>=D,O-=D,D=P>>>16&255,D&16){if(U=P&65535,D&=15,O<D&&(T+=R[s++]<<O,O+=8,O<D&&(T+=R[s++]<<O,O+=8)),U+=T&(1<<D)-1,U>u){t.msg="invalid distance too far back",i.mode=ui;break e}if(T>>>=D,O-=D,D=o-l,U>D){if(D=U-D,D>S&&i.sane){t.msg="invalid distance too far back",i.mode=ui;break e}if(z=0,E=b,g===0){if(z+=f-D,D<H){H-=D;do M[o++]=b[z++];while(--D);z=o-U,E=M}}else if(g<D){if(z+=f+g-D,D-=g,D<H){H-=D;do M[o++]=b[z++];while(--D);if(z=0,g<H){D=g,H-=D;do M[o++]=b[z++];while(--D);z=o-U,E=M}}}else if(z+=g-D,D<H){H-=D;do M[o++]=b[z++];while(--D);z=o-U,E=M}for(;H>2;)M[o++]=E[z++],M[o++]=E[z++],M[o++]=E[z++],H-=3;H&&(M[o++]=E[z++],H>1&&(M[o++]=E[z++]))}else{z=o-U;do M[o++]=M[z++],M[o++]=M[z++],M[o++]=M[z++],H-=3;while(H>2);H&&(M[o++]=M[z++],H>1&&(M[o++]=M[z++]))}}else if((D&64)===0){P=v[(P&65535)+(T&(1<<D)-1)];continue r}else{t.msg="invalid distance code",i.mode=ui;break e}break}}else if((D&64)===0){P=I[(P&65535)+(T&(1<<D)-1)];continue t}else if(D&32){i.mode=xp;break e}else{t.msg="invalid literal/length code",i.mode=ui;break e}break}}while(s<n&&o<c);H=O>>3,s-=H,O-=H<<3,T&=(1<<O)-1,t.next_in=s,t.next_out=o,t.avail_in=s<n?5+(n-s):5-(s-n),t.avail_out=o<c?257+(c-o):257-(o-c),i.hold=T,i.bits=O;return}}),ml=F((O_,ll)=>{"use strict";var hl=ze(),Vt=15,ul=852,cl=592,dl=0,zn=1,fl=2,Ip=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],Op=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],Ap=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],Dp=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];ll.exports=function(t,r,i,s,n,o,l,c){var u=c.bits,f=0,S=0,g=0,b=0,T=0,O=0,I=0,v=0,N=0,$=0,P,D,H,U,z,E=null,R=0,M,se=new hl.Buf16(Vt+1),$e=new hl.Buf16(Vt+1),At=null,Pr=0,Ur,Dt,Nt;for(f=0;f<=Vt;f++)se[f]=0;for(S=0;S<s;S++)se[r[i+S]]++;for(T=u,b=Vt;b>=1&&!(se[b]!==0);b--);if(T>b&&(T=b),b===0)return n[o++]=1<<24|64<<16|0,n[o++]=1<<24|64<<16|0,c.bits=1,0;for(g=1;g<b&&!(se[g]!==0);g++);for(T<g&&(T=g),v=1,f=1;f<=Vt;f++)if(v<<=1,v-=se[f],v<0)return-1;if(v>0&&(t===dl||b!==1))return-1;for($e[1]=0,f=1;f<Vt;f++)$e[f+1]=$e[f]+se[f];for(S=0;S<s;S++)r[i+S]!==0&&(l[$e[r[i+S]]++]=S);if(t===dl?(E=At=l,M=19):t===zn?(E=Ip,R-=257,At=Op,Pr-=257,M=256):(E=Ap,At=Dp,M=-1),$=0,S=0,f=g,z=o,O=T,I=0,H=-1,N=1<<T,U=N-1,t===zn&&N>ul||t===fl&&N>cl)return 1;for(;;){Ur=f-I,l[S]<M?(Dt=0,Nt=l[S]):l[S]>M?(Dt=At[Pr+l[S]],Nt=E[R+l[S]]):(Dt=32+64,Nt=0),P=1<<f-I,D=1<<O,g=D;do D-=P,n[z+($>>I)+D]=Ur<<24|Dt<<16|Nt|0;while(D!==0);for(P=1<<f-1;$&P;)P>>=1;if(P!==0?($&=P-1,$+=P):$=0,S++,--se[f]===0){if(f===b)break;f=r[i+l[S]]}if(f>T&&($&U)!==H){for(I===0&&(I=T),z+=g,O=f-I,v=1<<O;O+I<b&&!(v-=se[O+I],v<=0);)O++,v<<=1;if(N+=1<<O,t===zn&&N>ul||t===fl&&N>cl)return 1;H=$&U,n[H]=T<<24|O<<16|z-o|0}}return $!==0&&(n[z+$]=f-I<<24|64<<16|0),c.bits=T,0}}),Yl=F(Ee=>{"use strict";var pe=ze(),Cn=On(),Fe=An(),Np=al(),Ir=ml(),kp=0,pl=1,bl=2,gl=4,Rp=5,ci=6,Tt=0,Bp=1,Lp=2,_e=-2,_l=-3,Hn=-4,Fp=-5,wl=8,yl=1,vl=2,Sl=3,Tl=4,El=5,xl=6,Il=7,Ol=8,Al=9,Dl=10,di=11,He=12,Wn=13,Nl=14,jn=15,kl=16,Rl=17,Bl=18,Ll=19,fi=20,mi=21,Fl=22,Ml=23,Pl=24,Ul=25,zl=26,$n=27,Cl=28,Hl=29,K=30,Vn=31,Mp=32,Pp=852,Up=592,zp=15,Cp=zp;function Wl(e){return(e>>>24&255)+(e>>>8&65280)+((e&65280)<<8)+((e&255)<<24)}function Hp(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new pe.Buf16(320),this.work=new pe.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function jl(e){var t;return!e||!e.state?_e:(t=e.state,e.total_in=e.total_out=t.total=0,e.msg="",t.wrap&&(e.adler=t.wrap&1),t.mode=yl,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new pe.Buf32(Pp),t.distcode=t.distdyn=new pe.Buf32(Up),t.sane=1,t.back=-1,Tt)}function $l(e){var t;return!e||!e.state?_e:(t=e.state,t.wsize=0,t.whave=0,t.wnext=0,jl(e))}function Vl(e,t){var r,i;return!e||!e.state?_e:(i=e.state,t<0?(r=0,t=-t):(r=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?_e:(i.window!==null&&i.wbits!==t&&(i.window=null),i.wrap=r,i.wbits=t,$l(e)))}function Gl(e,t){var r,i;return e?(i=new Hp,e.state=i,i.window=null,r=Vl(e,t),r!==Tt&&(e.state=null),r):_e}function Wp(e){return Gl(e,Cp)}var Zl=!0,Gn,Zn;function jp(e){if(Zl){var t;for(Gn=new pe.Buf32(512),Zn=new pe.Buf32(32),t=0;t<144;)e.lens[t++]=8;for(;t<256;)e.lens[t++]=9;for(;t<280;)e.lens[t++]=7;for(;t<288;)e.lens[t++]=8;for(Ir(pl,e.lens,0,288,Gn,0,e.work,{bits:9}),t=0;t<32;)e.lens[t++]=5;Ir(bl,e.lens,0,32,Zn,0,e.work,{bits:5}),Zl=!1}e.lencode=Gn,e.lenbits=9,e.distcode=Zn,e.distbits=5}function Xl(e,t,r,i){var s,n=e.state;return n.window===null&&(n.wsize=1<<n.wbits,n.wnext=0,n.whave=0,n.window=new pe.Buf8(n.wsize)),i>=n.wsize?(pe.arraySet(n.window,t,r-n.wsize,n.wsize,0),n.wnext=0,n.whave=n.wsize):(s=n.wsize-n.wnext,s>i&&(s=i),pe.arraySet(n.window,t,r-i,s,n.wnext),i-=s,i?(pe.arraySet(n.window,t,r-i,i,0),n.wnext=i,n.whave=n.wsize):(n.wnext+=s,n.wnext===n.wsize&&(n.wnext=0),n.whave<n.wsize&&(n.whave+=s))),0}function $p(e,t){var r,i,s,n,o,l,c,u,f,S,g,b,T,O,I=0,v,N,$,P,D,H,U,z,E=new pe.Buf8(4),R,M,se=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!e||!e.state||!e.output||!e.input&&e.avail_in!==0)return _e;r=e.state,r.mode===He&&(r.mode=Wn),o=e.next_out,s=e.output,c=e.avail_out,n=e.next_in,i=e.input,l=e.avail_in,u=r.hold,f=r.bits,S=l,g=c,z=Tt;e:for(;;)switch(r.mode){case yl:if(r.wrap===0){r.mode=Wn;break}for(;f<16;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}if(r.wrap&2&&u===35615){r.check=0,E[0]=u&255,E[1]=u>>>8&255,r.check=Fe(r.check,E,2,0),u=0,f=0,r.mode=vl;break}if(r.flags=0,r.head&&(r.head.done=!1),!(r.wrap&1)||(((u&255)<<8)+(u>>8))%31){e.msg="incorrect header check",r.mode=K;break}if((u&15)!==wl){e.msg="unknown compression method",r.mode=K;break}if(u>>>=4,f-=4,U=(u&15)+8,r.wbits===0)r.wbits=U;else if(U>r.wbits){e.msg="invalid window size",r.mode=K;break}r.dmax=1<<U,e.adler=r.check=1,r.mode=u&512?Dl:He,u=0,f=0;break;case vl:for(;f<16;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}if(r.flags=u,(r.flags&255)!==wl){e.msg="unknown compression method",r.mode=K;break}if(r.flags&57344){e.msg="unknown header flags set",r.mode=K;break}r.head&&(r.head.text=u>>8&1),r.flags&512&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Fe(r.check,E,2,0)),u=0,f=0,r.mode=Sl;case Sl:for(;f<32;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}r.head&&(r.head.time=u),r.flags&512&&(E[0]=u&255,E[1]=u>>>8&255,E[2]=u>>>16&255,E[3]=u>>>24&255,r.check=Fe(r.check,E,4,0)),u=0,f=0,r.mode=Tl;case Tl:for(;f<16;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}r.head&&(r.head.xflags=u&255,r.head.os=u>>8),r.flags&512&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Fe(r.check,E,2,0)),u=0,f=0,r.mode=El;case El:if(r.flags&1024){for(;f<16;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}r.length=u,r.head&&(r.head.extra_len=u),r.flags&512&&(E[0]=u&255,E[1]=u>>>8&255,r.check=Fe(r.check,E,2,0)),u=0,f=0}else r.head&&(r.head.extra=null);r.mode=xl;case xl:if(r.flags&1024&&(b=r.length,b>l&&(b=l),b&&(r.head&&(U=r.head.extra_len-r.length,r.head.extra||(r.head.extra=new Array(r.head.extra_len)),pe.arraySet(r.head.extra,i,n,b,U)),r.flags&512&&(r.check=Fe(r.check,i,b,n)),l-=b,n+=b,r.length-=b),r.length))break e;r.length=0,r.mode=Il;case Il:if(r.flags&2048){if(l===0)break e;b=0;do U=i[n+b++],r.head&&U&&r.length<65536&&(r.head.name+=String.fromCharCode(U));while(U&&b<l);if(r.flags&512&&(r.check=Fe(r.check,i,b,n)),l-=b,n+=b,U)break e}else r.head&&(r.head.name=null);r.length=0,r.mode=Ol;case Ol:if(r.flags&4096){if(l===0)break e;b=0;do U=i[n+b++],r.head&&U&&r.length<65536&&(r.head.comment+=String.fromCharCode(U));while(U&&b<l);if(r.flags&512&&(r.check=Fe(r.check,i,b,n)),l-=b,n+=b,U)break e}else r.head&&(r.head.comment=null);r.mode=Al;case Al:if(r.flags&512){for(;f<16;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}if(u!==(r.check&65535)){e.msg="header crc mismatch",r.mode=K;break}u=0,f=0}r.head&&(r.head.hcrc=r.flags>>9&1,r.head.done=!0),e.adler=r.check=0,r.mode=He;break;case Dl:for(;f<32;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}e.adler=r.check=Wl(u),u=0,f=0,r.mode=di;case di:if(r.havedict===0)return e.next_out=o,e.avail_out=c,e.next_in=n,e.avail_in=l,r.hold=u,r.bits=f,Lp;e.adler=r.check=1,r.mode=He;case He:if(t===Rp||t===ci)break e;case Wn:if(r.last){u>>>=f&7,f-=f&7,r.mode=$n;break}for(;f<3;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}r.last=u&1,u>>>=1,f-=1;switch(u&3){case 0:r.mode=Nl;break;case 1:if(jp(r),r.mode=fi,t===ci){u>>>=2,f-=2;break e}break;case 2:r.mode=Rl;break;case 3:e.msg="invalid block type",r.mode=K}u>>>=2,f-=2;break;case Nl:for(u>>>=f&7,f-=f&7;f<32;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}if((u&65535)!==(u>>>16^65535)){e.msg="invalid stored block lengths",r.mode=K;break}if(r.length=u&65535,u=0,f=0,r.mode=jn,t===ci)break e;case jn:r.mode=kl;case kl:if(b=r.length,b){if(b>l&&(b=l),b>c&&(b=c),b===0)break e;pe.arraySet(s,i,n,b,o),l-=b,n+=b,c-=b,o+=b,r.length-=b;break}r.mode=He;break;case Rl:for(;f<14;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}if(r.nlen=(u&31)+257,u>>>=5,f-=5,r.ndist=(u&31)+1,u>>>=5,f-=5,r.ncode=(u&15)+4,u>>>=4,f-=4,r.nlen>286||r.ndist>30){e.msg="too many length or distance symbols",r.mode=K;break}r.have=0,r.mode=Bl;case Bl:for(;r.have<r.ncode;){for(;f<3;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}r.lens[se[r.have++]]=u&7,u>>>=3,f-=3}for(;r.have<19;)r.lens[se[r.have++]]=0;if(r.lencode=r.lendyn,r.lenbits=7,R={bits:r.lenbits},z=Ir(kp,r.lens,0,19,r.lencode,0,r.work,R),r.lenbits=R.bits,z){e.msg="invalid code lengths set",r.mode=K;break}r.have=0,r.mode=Ll;case Ll:for(;r.have<r.nlen+r.ndist;){for(;!(I=r.lencode[u&(1<<r.lenbits)-1],v=I>>>24,N=I>>>16&255,$=I&65535,v<=f);){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}if($<16)u>>>=v,f-=v,r.lens[r.have++]=$;else{if($===16){for(M=v+2;f<M;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}if(u>>>=v,f-=v,r.have===0){e.msg="invalid bit length repeat",r.mode=K;break}U=r.lens[r.have-1],b=3+(u&3),u>>>=2,f-=2}else if($===17){for(M=v+3;f<M;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}u>>>=v,f-=v,U=0,b=3+(u&7),u>>>=3,f-=3}else{for(M=v+7;f<M;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}u>>>=v,f-=v,U=0,b=11+(u&127),u>>>=7,f-=7}if(r.have+b>r.nlen+r.ndist){e.msg="invalid bit length repeat",r.mode=K;break}for(;b--;)r.lens[r.have++]=U}}if(r.mode===K)break;if(r.lens[256]===0){e.msg="invalid code -- missing end-of-block",r.mode=K;break}if(r.lenbits=9,R={bits:r.lenbits},z=Ir(pl,r.lens,0,r.nlen,r.lencode,0,r.work,R),r.lenbits=R.bits,z){e.msg="invalid literal/lengths set",r.mode=K;break}if(r.distbits=6,r.distcode=r.distdyn,R={bits:r.distbits},z=Ir(bl,r.lens,r.nlen,r.ndist,r.distcode,0,r.work,R),r.distbits=R.bits,z){e.msg="invalid distances set",r.mode=K;break}if(r.mode=fi,t===ci)break e;case fi:r.mode=mi;case mi:if(l>=6&&c>=258){e.next_out=o,e.avail_out=c,e.next_in=n,e.avail_in=l,r.hold=u,r.bits=f,Np(e,g),o=e.next_out,s=e.output,c=e.avail_out,n=e.next_in,i=e.input,l=e.avail_in,u=r.hold,f=r.bits,r.mode===He&&(r.back=-1);break}for(r.back=0;!(I=r.lencode[u&(1<<r.lenbits)-1],v=I>>>24,N=I>>>16&255,$=I&65535,v<=f);){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}if(N&&(N&240)===0){for(P=v,D=N,H=$;!(I=r.lencode[H+((u&(1<<P+D)-1)>>P)],v=I>>>24,N=I>>>16&255,$=I&65535,P+v<=f);){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}u>>>=P,f-=P,r.back+=P}if(u>>>=v,f-=v,r.back+=v,r.length=$,N===0){r.mode=zl;break}if(N&32){r.back=-1,r.mode=He;break}if(N&64){e.msg="invalid literal/length code",r.mode=K;break}r.extra=N&15,r.mode=Fl;case Fl:if(r.extra){for(M=r.extra;f<M;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}r.length+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}r.was=r.length,r.mode=Ml;case Ml:for(;!(I=r.distcode[u&(1<<r.distbits)-1],v=I>>>24,N=I>>>16&255,$=I&65535,v<=f);){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}if((N&240)===0){for(P=v,D=N,H=$;!(I=r.distcode[H+((u&(1<<P+D)-1)>>P)],v=I>>>24,N=I>>>16&255,$=I&65535,P+v<=f);){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}u>>>=P,f-=P,r.back+=P}if(u>>>=v,f-=v,r.back+=v,N&64){e.msg="invalid distance code",r.mode=K;break}r.offset=$,r.extra=N&15,r.mode=Pl;case Pl:if(r.extra){for(M=r.extra;f<M;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}r.offset+=u&(1<<r.extra)-1,u>>>=r.extra,f-=r.extra,r.back+=r.extra}if(r.offset>r.dmax){e.msg="invalid distance too far back",r.mode=K;break}r.mode=Ul;case Ul:if(c===0)break e;if(b=g-c,r.offset>b){if(b=r.offset-b,b>r.whave&&r.sane){e.msg="invalid distance too far back",r.mode=K;break}b>r.wnext?(b-=r.wnext,T=r.wsize-b):T=r.wnext-b,b>r.length&&(b=r.length),O=r.window}else O=s,T=o-r.offset,b=r.length;b>c&&(b=c),c-=b,r.length-=b;do s[o++]=O[T++];while(--b);r.length===0&&(r.mode=mi);break;case zl:if(c===0)break e;s[o++]=r.length,c--,r.mode=mi;break;case $n:if(r.wrap){for(;f<32;){if(l===0)break e;l--,u|=i[n++]<<f,f+=8}if(g-=c,e.total_out+=g,r.total+=g,g&&(e.adler=r.check=r.flags?Fe(r.check,s,g,o-g):Cn(r.check,s,g,o-g)),g=c,(r.flags?u:Wl(u))!==r.check){e.msg="incorrect data check",r.mode=K;break}u=0,f=0}r.mode=Cl;case Cl:if(r.wrap&&r.flags){for(;f<32;){if(l===0)break e;l--,u+=i[n++]<<f,f+=8}if(u!==(r.total&4294967295)){e.msg="incorrect length check",r.mode=K;break}u=0,f=0}r.mode=Hl;case Hl:z=Bp;break e;case K:z=_l;break e;case Vn:return Hn;case Mp:default:return _e}return e.next_out=o,e.avail_out=c,e.next_in=n,e.avail_in=l,r.hold=u,r.bits=f,(r.wsize||g!==e.avail_out&&r.mode<K&&(r.mode<$n||t!==gl))&&Xl(e,e.output,e.next_out,g-e.avail_out)?(r.mode=Vn,Hn):(S-=e.avail_in,g-=e.avail_out,e.total_in+=S,e.total_out+=g,r.total+=g,r.wrap&&g&&(e.adler=r.check=r.flags?Fe(r.check,s,g,e.next_out-g):Cn(r.check,s,g,e.next_out-g)),e.data_type=r.bits+(r.last?64:0)+(r.mode===He?128:0)+(r.mode===fi||r.mode===jn?256:0),(S===0&&g===0||t===gl)&&z===Tt&&(z=Fp),z)}function Vp(e){if(!e||!e.state)return _e;var t=e.state;return t.window&&(t.window=null),e.state=null,Tt}function Gp(e,t){var r;return!e||!e.state?_e:(r=e.state,(r.wrap&2)===0?_e:(r.head=t,t.done=!1,Tt))}function Zp(e,t){var r=t.length,i,s,n;return!e||!e.state?_e:(i=e.state,i.wrap!==0&&i.mode!==di?_e:i.mode===di&&(s=1,s=Cn(s,t,r,0),s!==i.check)?_l:(n=Xl(e,t,r,r),n?(i.mode=Vn,Hn):(i.havedict=1,Tt)))}Ee.inflateReset=$l;Ee.inflateReset2=Vl;Ee.inflateResetKeep=jl;Ee.inflateInit=Wp;Ee.inflateInit2=Gl;Ee.inflate=$p;Ee.inflateEnd=Vp;Ee.inflateGetHeader=Gp;Ee.inflateSetDictionary=Zp;Ee.inflateInfo="pako inflate (from Nodeca project)"}),Xn=F((D_,ql)=>{"use strict";ql.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}}),Jl=F((N_,Kl)=>{"use strict";function Xp(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}Kl.exports=Xp}),eh=F(Or=>{"use strict";var Gt=Yl(),Ar=ze(),pi=Bn(),ee=Xn(),Yn=ri(),Yp=Ln(),qp=Jl(),Ql=Object.prototype.toString;function Et(e){if(!(this instanceof Et))return new Et(e);this.options=Ar.assign({chunkSize:16384,windowBits:0,to:""},e||{});var t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(e&&e.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&((t.windowBits&15)===0&&(t.windowBits|=15)),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Yp,this.strm.avail_out=0;var r=Gt.inflateInit2(this.strm,t.windowBits);if(r!==ee.Z_OK)throw new Error(Yn[r]);if(this.header=new qp,Gt.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=pi.string2buf(t.dictionary):Ql.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(r=Gt.inflateSetDictionary(this.strm,t.dictionary),r!==ee.Z_OK)))throw new Error(Yn[r])}Et.prototype.push=function(e,t){var r=this.strm,i=this.options.chunkSize,s=this.options.dictionary,n,o,l,c,u,f=!1;if(this.ended)return!1;o=t===~~t?t:t===!0?ee.Z_FINISH:ee.Z_NO_FLUSH,typeof e=="string"?r.input=pi.binstring2buf(e):Ql.call(e)==="[object ArrayBuffer]"?r.input=new Uint8Array(e):r.input=e,r.next_in=0,r.avail_in=r.input.length;do{if(r.avail_out===0&&(r.output=new Ar.Buf8(i),r.next_out=0,r.avail_out=i),n=Gt.inflate(r,ee.Z_NO_FLUSH),n===ee.Z_NEED_DICT&&s&&(n=Gt.inflateSetDictionary(this.strm,s)),n===ee.Z_BUF_ERROR&&f===!0&&(n=ee.Z_OK,f=!1),n!==ee.Z_STREAM_END&&n!==ee.Z_OK)return this.onEnd(n),this.ended=!0,!1;r.next_out&&((r.avail_out===0||n===ee.Z_STREAM_END||r.avail_in===0&&(o===ee.Z_FINISH||o===ee.Z_SYNC_FLUSH))&&(this.options.to==="string"?(l=pi.utf8border(r.output,r.next_out),c=r.next_out-l,u=pi.buf2string(r.output,l),r.next_out=c,r.avail_out=i-c,c&&Ar.arraySet(r.output,r.output,l,c,0),this.onData(u)):this.onData(Ar.shrinkBuf(r.output,r.next_out)))),r.avail_in===0&&r.avail_out===0&&(f=!0)}while((r.avail_in>0||r.avail_out===0)&&n!==ee.Z_STREAM_END);return n===ee.Z_STREAM_END&&(o=ee.Z_FINISH),o===ee.Z_FINISH?(n=Gt.inflateEnd(this.strm),this.onEnd(n),this.ended=!0,n===ee.Z_OK):(o===ee.Z_SYNC_FLUSH&&(this.onEnd(ee.Z_OK),r.avail_out=0),!0)};Et.prototype.onData=function(e){this.chunks.push(e)};Et.prototype.onEnd=function(e){e===ee.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=Ar.flattenChunks(this.chunks)),this.chunks=[],this.err=e,this.msg=this.strm.msg};function qn(e,t){var r=new Et(t);if(r.push(e,!0),r.err)throw r.msg||Yn[r.err];return r.result}function Kp(e,t){return t=t||{},t.raw=!0,qn(e,t)}Or.Inflate=Et;Or.inflate=qn;Or.inflateRaw=Kp;Or.ungzip=qn}),ih=F((R_,th)=>{"use strict";var Jp=ze().assign,Qp=sl(),eb=eh(),tb=Xn(),rh={};Jp(rh,Qp,eb,tb);th.exports=rh}),sh=F(bi=>{"use strict";var rb=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",ib=ih(),nh=q(),gi=me(),nb=rb?"uint8array":"array";bi.magic="\b\0";function xt(e,t){gi.call(this,"FlateWorker/"+e),this._pako=null,this._pakoAction=e,this._pakoOptions=t,this.meta={}}nh.inherits(xt,gi);xt.prototype.processChunk=function(e){this.meta=e.meta,this._pako===null&&this._createPako(),this._pako.push(nh.transformTo(nb,e.data),!1)};xt.prototype.flush=function(){gi.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)};xt.prototype.cleanUp=function(){gi.prototype.cleanUp.call(this),this._pako=null};xt.prototype._createPako=function(){this._pako=new ib[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var e=this;this._pako.onData=function(t){e.push({data:t,meta:e.meta})}};bi.compressWorker=function(e){return new xt("Deflate",e)};bi.uncompressWorker=function(){return new xt("Inflate",{})}}),Jn=F(Kn=>{"use strict";var oh=me();Kn.STORE={magic:"\0\0",compressWorker:function(e){return new oh("STORE compression")},uncompressWorker:function(){return new oh("STORE decompression")}};Kn.DEFLATE=sh()}),Qn=F(It=>{"use strict";It.LOCAL_FILE_HEADER="PK";It.CENTRAL_FILE_HEADER="PK";It.CENTRAL_DIRECTORY_END="PK";It.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07";It.ZIP64_CENTRAL_DIRECTORY_END="PK";It.DATA_DESCRIPTOR="PK\x07\b"}),uh=F((M_,ah)=>{"use strict";var Zt=q(),Xt=me(),es=pt(),lh=Kr(),_i=Qn(),Y=function(e,t){var r="",i;for(i=0;i<t;i++)r+=String.fromCharCode(e&255),e=e>>>8;return r},sb=function(e,t){var r=e;return e||(r=t?16893:33204),(r&65535)<<16},ob=function(e,t){return(e||0)&63},hh=function(e,t,r,i,s,n){var o=e.file,l=e.compression,c=n!==es.utf8encode,u=Zt.transformTo("string",n(o.name)),f=Zt.transformTo("string",es.utf8encode(o.name)),S=o.comment,g=Zt.transformTo("string",n(S)),b=Zt.transformTo("string",es.utf8encode(S)),T=f.length!==o.name.length,O=b.length!==S.length,I,v,N="",$="",P="",D=o.dir,H=o.date,U={crc32:0,compressedSize:0,uncompressedSize:0};(!t||r)&&(U.crc32=e.crc32,U.compressedSize=e.compressedSize,U.uncompressedSize=e.uncompressedSize);var z=0;t&&(z|=8),!c&&(T||O)&&(z|=2048);var E=0,R=0;D&&(E|=16),s==="UNIX"?(R=798,E|=sb(o.unixPermissions,D)):(R=20,E|=ob(o.dosPermissions,D)),I=H.getUTCHours(),I=I<<6,I=I|H.getUTCMinutes(),I=I<<5,I=I|H.getUTCSeconds()/2,v=H.getUTCFullYear()-1980,v=v<<4,v=v|H.getUTCMonth()+1,v=v<<5,v=v|H.getUTCDate(),T&&($=Y(1,1)+Y(lh(u),4)+f,N+="up"+Y($.length,2)+$),O&&(P=Y(1,1)+Y(lh(g),4)+b,N+="uc"+Y(P.length,2)+P);var M="";M+=`
\0`,M+=Y(z,2),M+=l.magic,M+=Y(I,2),M+=Y(v,2),M+=Y(U.crc32,4),M+=Y(U.compressedSize,4),M+=Y(U.uncompressedSize,4),M+=Y(u.length,2),M+=Y(N.length,2);var se=_i.LOCAL_FILE_HEADER+M+u+N,$e=_i.CENTRAL_FILE_HEADER+Y(R,2)+M+Y(g.length,2)+"\0\0\0\0"+Y(E,4)+Y(i,4)+u+N+g;return{fileRecord:se,dirRecord:$e}},ab=function(e,t,r,i,s){var n="",o=Zt.transformTo("string",s(i));return n=_i.CENTRAL_DIRECTORY_END+"\0\0\0\0"+Y(e,2)+Y(e,2)+Y(t,4)+Y(r,4)+Y(o.length,2)+o,n},lb=function(e){var t="";return t=_i.DATA_DESCRIPTOR+Y(e.crc32,4)+Y(e.compressedSize,4)+Y(e.uncompressedSize,4),t};function xe(e,t,r,i){Xt.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=t,this.zipPlatform=r,this.encodeFileName=i,this.streamFiles=e,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}Zt.inherits(xe,Xt);xe.prototype.push=function(e){var t=e.meta.percent||0,r=this.entriesCount,i=this._sources.length;this.accumulate?this.contentBuffer.push(e):(this.bytesWritten+=e.data.length,Xt.prototype.push.call(this,{data:e.data,meta:{currentFile:this.currentFile,percent:r?(t+100*(r-i-1))/r:100}}))};xe.prototype.openedSource=function(e){this.currentSourceOffset=this.bytesWritten,this.currentFile=e.file.name;var t=this.streamFiles&&!e.file.dir;if(t){var r=hh(e,t,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:r.fileRecord,meta:{percent:0}})}else this.accumulate=!0};xe.prototype.closedSource=function(e){this.accumulate=!1;var t=this.streamFiles&&!e.file.dir,r=hh(e,t,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(r.dirRecord),t)this.push({data:lb(e),meta:{percent:100}});else for(this.push({data:r.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null};xe.prototype.flush=function(){for(var e=this.bytesWritten,t=0;t<this.dirRecords.length;t++)this.push({data:this.dirRecords[t],meta:{percent:100}});var r=this.bytesWritten-e,i=ab(this.dirRecords.length,r,e,this.zipComment,this.encodeFileName);this.push({data:i,meta:{percent:100}})};xe.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()};xe.prototype.registerPrevious=function(e){this._sources.push(e);var t=this;return e.on("data",function(r){t.processChunk(r)}),e.on("end",function(){t.closedSource(t.previous.streamInfo),t._sources.length?t.prepareNextSource():t.end()}),e.on("error",function(r){t.error(r)}),this};xe.prototype.resume=function(){if(!Xt.prototype.resume.call(this))return!1;if(!this.previous&&this._sources.length)return this.prepareNextSource(),!0;if(!this.previous&&!this._sources.length&&!this.generatedError)return this.end(),!0};xe.prototype.error=function(e){var t=this._sources;if(!Xt.prototype.error.call(this,e))return!1;for(var r=0;r<t.length;r++)try{t[r].error(e)}catch(i){}return!0};xe.prototype.lock=function(){Xt.prototype.lock.call(this);for(var e=this._sources,t=0;t<e.length;t++)e[t].lock()};ah.exports=xe}),dh=F(ch=>{"use strict";var hb=Jn(),ub=uh(),cb=function(e,t){var r=e||t,i=hb[r];if(!i)throw new Error(r+" is not a valid compression method !");return i};ch.generateWorker=function(e,t,r){var i=new ub(t.streamFiles,r,t.platform,t.encodeFileName),s=0;try{e.forEach(function(n,o){s++;var l=cb(o.options.compression,t.compression),c=o.options.compressionOptions||t.compressionOptions||{},u=o.dir,f=o.date;o._compressWorker(l,c).withStreamInfo("file",{name:n,dir:u,date:f,comment:o.comment||"",unixPermissions:o.unixPermissions,dosPermissions:o.dosPermissions}).pipe(i)}),i.entriesCount=s}catch(n){i.error(n)}return i}}),mh=F((U_,fh)=>{"use strict";var db=q(),wi=me();function Dr(e,t){wi.call(this,"Nodejs stream input adapter for "+e),this._upstreamEnded=!1,this._bindStream(t)}db.inherits(Dr,wi);Dr.prototype._bindStream=function(e){var t=this;this._stream=e,e.pause(),e.on("data",function(r){t.push({data:r,meta:{percent:0}})}).on("error",function(r){t.isPaused?this.generatedError=r:t.error(r)}).on("end",function(){t.isPaused?t._upstreamEnded=!0:t.end()})};Dr.prototype.pause=function(){return wi.prototype.pause.call(this)?(this._stream.pause(),!0):!1};Dr.prototype.resume=function(){return wi.prototype.resume.call(this)?(this._upstreamEnded?this.end():this._stream.resume(),!0):!1};fh.exports=Dr}),Eh=F((z_,ph)=>{"use strict";var fb=pt(),Nr=q(),bh=me(),mb=nn(),gh=sn(),_h=Qr(),pb=ba(),bb=dh(),wh=or(),gb=mh(),Sh=function(e,t,r){var i=Nr.getTypeOf(t),s,n=Nr.extend(r||{},gh);n.date=n.date||new Date,n.compression!==null&&(n.compression=n.compression.toUpperCase()),typeof n.unixPermissions=="string"&&(n.unixPermissions=parseInt(n.unixPermissions,8)),n.unixPermissions&&n.unixPermissions&16384&&(n.dir=!0),n.dosPermissions&&n.dosPermissions&16&&(n.dir=!0),n.dir&&(e=yh(e)),n.createFolders&&(s=_b(e))&&vh.call(this,s,!0);var o=i==="string"&&n.binary===!1&&n.base64===!1;(!r||typeof r.binary=="undefined")&&(n.binary=!o);var l=t instanceof _h&&t.uncompressedSize===0;(l||n.dir||!t||t.length===0)&&(n.base64=!1,n.binary=!0,t="",n.compression="STORE",i="string");var c=null;t instanceof _h||t instanceof bh?c=t:wh.isNode&&wh.isStream(t)?c=new gb(e,t):c=Nr.prepareContent(e,t,n.binary,n.optimizedBinaryString,n.base64);var u=new pb(e,c,n);this.files[e]=u},_b=function(e){e.slice(-1)==="/"&&(e=e.substring(0,e.length-1));var t=e.lastIndexOf("/");return t>0?e.substring(0,t):""},yh=function(e){return e.slice(-1)!=="/"&&(e+="/"),e},vh=function(e,t){return t=typeof t!="undefined"?t:gh.createFolders,e=yh(e),this.files[e]||Sh.call(this,e,null,{dir:!0,createFolders:t}),this.files[e]};function Th(e){return Object.prototype.toString.call(e)==="[object RegExp]"}var wb={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(e){var t,r,i;for(t in this.files){if(!this.files.hasOwnProperty(t))continue;i=this.files[t],r=t.slice(this.root.length,t.length),r&&t.slice(0,this.root.length)===this.root&&e(r,i)}},filter:function(e){var t=[];return this.forEach(function(r,i){e(r,i)&&t.push(i)}),t},file:function(e,t,r){if(arguments.length===1)if(Th(e)){var i=e;return this.filter(function(n,o){return!o.dir&&i.test(n)})}else{var s=this.files[this.root+e];return s&&!s.dir?s:null}else e=this.root+e,Sh.call(this,e,t,r);return this},folder:function(e){if(!e)return this;if(Th(e))return this.filter(function(s,n){return n.dir&&e.test(s)});var t=this.root+e,r=vh.call(this,t),i=this.clone();return i.root=r.name,i},remove:function(e){e=this.root+e;var t=this.files[e];if(t||(e.slice(-1)!=="/"&&(e+="/"),t=this.files[e]),t&&!t.dir)delete this.files[e];else for(var r=this.filter(function(s,n){return n.name.slice(0,e.length)===e}),i=0;i<r.length;i++)delete this.files[r[i].name];return this},generate:function(e){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(e){var t,r={};try{if(r=Nr.extend(e||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:fb.utf8encode}),r.type=r.type.toLowerCase(),r.compression=r.compression.toUpperCase(),r.type==="binarystring"&&(r.type="string"),!r.type)throw new Error("No output type specified.");Nr.checkSupport(r.type),(r.platform==="darwin"||r.platform==="freebsd"||r.platform==="linux"||r.platform==="sunos")&&(r.platform="UNIX"),r.platform==="win32"&&(r.platform="DOS");var i=r.comment||this.comment||"";t=bb.generateWorker(this,r,i)}catch(s){t=new bh("error"),t.error(s)}return new mb(t,r.type||"string",r.mimeType)},generateAsync:function(e,t){return this.generateInternalStream(e).accumulate(t)},generateNodeStream:function(e,t){return e=e||{},e.type||(e.type="nodebuffer"),this.generateInternalStream(e).toNodejsStream(t)}};ph.exports=wb}),ts=F((C_,xh)=>{"use strict";var yb=q();function Ih(e){this.data=e,this.length=e.length,this.index=0,this.zero=0}Ih.prototype={checkOffset:function(e){this.checkIndex(this.index+e)},checkIndex:function(e){if(this.length<this.zero+e||e<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+e+"). Corrupted zip ?")},setIndex:function(e){this.checkIndex(e),this.index=e},skip:function(e){this.setIndex(this.index+e)},byteAt:function(e){},readInt:function(e){var t=0,r;for(this.checkOffset(e),r=this.index+e-1;r>=this.index;r--)t=(t<<8)+this.byteAt(r);return this.index+=e,t},readString:function(e){return yb.transformTo("string",this.readData(e))},readData:function(e){},lastIndexOfSignature:function(e){},readAndCheckSignature:function(e){},readDate:function(){var e=this.readInt(4);return new Date(Date.UTC((e>>25&127)+1980,(e>>21&15)-1,e>>16&31,e>>11&31,e>>5&63,(e&31)<<1))}};xh.exports=Ih}),rs=F((H_,Oh)=>{"use strict";var Ah=ts(),vb=q();function Yt(e){Ah.call(this,e);for(var t=0;t<this.data.length;t++)e[t]=e[t]&255}vb.inherits(Yt,Ah);Yt.prototype.byteAt=function(e){return this.data[this.zero+e]};Yt.prototype.lastIndexOfSignature=function(e){for(var t=e.charCodeAt(0),r=e.charCodeAt(1),i=e.charCodeAt(2),s=e.charCodeAt(3),n=this.length-4;n>=0;--n)if(this.data[n]===t&&this.data[n+1]===r&&this.data[n+2]===i&&this.data[n+3]===s)return n-this.zero;return-1};Yt.prototype.readAndCheckSignature=function(e){var t=e.charCodeAt(0),r=e.charCodeAt(1),i=e.charCodeAt(2),s=e.charCodeAt(3),n=this.readData(4);return t===n[0]&&r===n[1]&&i===n[2]&&s===n[3]};Yt.prototype.readData=function(e){if(this.checkOffset(e),e===0)return[];var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};Oh.exports=Yt}),kh=F((W_,Dh)=>{"use strict";var Nh=ts(),Sb=q();function qt(e){Nh.call(this,e)}Sb.inherits(qt,Nh);qt.prototype.byteAt=function(e){return this.data.charCodeAt(this.zero+e)};qt.prototype.lastIndexOfSignature=function(e){return this.data.lastIndexOf(e)-this.zero};qt.prototype.readAndCheckSignature=function(e){var t=this.readData(4);return e===t};qt.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};Dh.exports=qt}),ns=F((j_,Rh)=>{"use strict";var Bh=rs(),Tb=q();function is(e){Bh.call(this,e)}Tb.inherits(is,Bh);is.prototype.readData=function(e){if(this.checkOffset(e),e===0)return new Uint8Array(0);var t=this.data.subarray(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};Rh.exports=is}),Mh=F(($_,Lh)=>{"use strict";var Fh=ns(),Eb=q();function ss(e){Fh.call(this,e)}Eb.inherits(ss,Fh);ss.prototype.readData=function(e){this.checkOffset(e);var t=this.data.slice(this.zero+this.index,this.zero+this.index+e);return this.index+=e,t};Lh.exports=ss}),os=F((V_,Ph)=>{"use strict";var yi=q(),Uh=Ue(),xb=rs(),Ib=kh(),Ob=Mh(),Ab=ns();Ph.exports=function(e){var t=yi.getTypeOf(e);return yi.checkSupport(t),t==="string"&&!Uh.uint8array?new Ib(e):t==="nodebuffer"?new Ob(e):Uh.uint8array?new Ab(yi.transformTo("uint8array",e)):new xb(yi.transformTo("array",e))}}),Wh=F((G_,zh)=>{"use strict";var as=os(),it=q(),Db=Qr(),Ch=Kr(),vi=pt(),Si=Jn(),Nb=Ue(),kb=0,Rb=3,Bb=function(e){for(var t in Si){if(!Si.hasOwnProperty(t))continue;if(Si[t].magic===e)return Si[t]}return null};function Hh(e,t){this.options=e,this.loadOptions=t}Hh.prototype={isEncrypted:function(){return(this.bitFlag&1)===1},useUTF8:function(){return(this.bitFlag&2048)===2048},readLocalPart:function(e){var t,r;if(e.skip(22),this.fileNameLength=e.readInt(2),r=e.readInt(2),this.fileName=e.readData(this.fileNameLength),e.skip(r),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if(t=Bb(this.compressionMethod),t===null)throw new Error("Corrupted zip : compression "+it.pretty(this.compressionMethod)+" unknown (inner file : "+it.transformTo("string",this.fileName)+")");this.decompressed=new Db(this.compressedSize,this.uncompressedSize,this.crc32,t,e.readData(this.compressedSize))},readCentralPart:function(e){this.versionMadeBy=e.readInt(2),e.skip(2),this.bitFlag=e.readInt(2),this.compressionMethod=e.readString(2),this.date=e.readDate(),this.crc32=e.readInt(4),this.compressedSize=e.readInt(4),this.uncompressedSize=e.readInt(4);var t=e.readInt(2);if(this.extraFieldsLength=e.readInt(2),this.fileCommentLength=e.readInt(2),this.diskNumberStart=e.readInt(2),this.internalFileAttributes=e.readInt(2),this.externalFileAttributes=e.readInt(4),this.localHeaderOffset=e.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");e.skip(t),this.readExtraFields(e),this.parseZIP64ExtraField(e),this.fileComment=e.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var e=this.versionMadeBy>>8;this.dir=!!(this.externalFileAttributes&16),e===kb&&(this.dosPermissions=this.externalFileAttributes&63),e===Rb&&(this.unixPermissions=this.externalFileAttributes>>16&65535),!this.dir&&this.fileNameStr.slice(-1)==="/"&&(this.dir=!0)},parseZIP64ExtraField:function(e){if(!this.extraFields[1])return;var t=as(this.extraFields[1].value);this.uncompressedSize===it.MAX_VALUE_32BITS&&(this.uncompressedSize=t.readInt(8)),this.compressedSize===it.MAX_VALUE_32BITS&&(this.compressedSize=t.readInt(8)),this.localHeaderOffset===it.MAX_VALUE_32BITS&&(this.localHeaderOffset=t.readInt(8)),this.diskNumberStart===it.MAX_VALUE_32BITS&&(this.diskNumberStart=t.readInt(4))},readExtraFields:function(e){var t=e.index+this.extraFieldsLength,r,i,s;for(this.extraFields||(this.extraFields={});e.index+4<t;)r=e.readInt(2),i=e.readInt(2),s=e.readData(i),this.extraFields[r]={id:r,length:i,value:s};e.setIndex(t)},handleUTF8:function(){var e=Nb.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=vi.utf8decode(this.fileName),this.fileCommentStr=vi.utf8decode(this.fileComment);else{var t=this.findExtraFieldUnicodePath();if(t!==null)this.fileNameStr=t;else{var r=it.transformTo(e,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(r)}var i=this.findExtraFieldUnicodeComment();if(i!==null)this.fileCommentStr=i;else{var s=it.transformTo(e,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(s)}}},findExtraFieldUnicodePath:function(){var e=this.extraFields[28789];if(e){var t=as(e.value);return t.readInt(1)!==1||Ch(this.fileName)!==t.readInt(4)?null:vi.utf8decode(t.readData(e.length-5))}return null},findExtraFieldUnicodeComment:function(){var e=this.extraFields[25461];if(e){var t=as(e.value);return t.readInt(1)!==1||Ch(this.fileComment)!==t.readInt(4)?null:vi.utf8decode(t.readData(e.length-5))}return null}};zh.exports=Hh}),Vh=F((X_,jh)=>{"use strict";var Lb=os(),We=q(),Ie=Qn(),Fb=Wh(),Z_=pt(),Mb=Ue();function $h(e){this.files=[],this.loadOptions=e}$h.prototype={checkSignature:function(e){if(!this.reader.readAndCheckSignature(e)){this.reader.index-=4;var t=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+We.pretty(t)+", expected "+We.pretty(e)+")")}},isSignature:function(e,t){var r=this.reader.index;this.reader.setIndex(e);var i=this.reader.readString(4),s=i===t;return this.reader.setIndex(r),s},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var e=this.reader.readData(this.zipCommentLength),t=Mb.uint8array?"uint8array":"array",r=We.transformTo(t,e);this.zipComment=this.loadOptions.decodeFileName(r)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var e=this.zip64EndOfCentralSize-44,t=0,r,i,s;t<e;)r=this.reader.readInt(2),i=this.reader.readInt(4),s=this.reader.readData(i),this.zip64ExtensibleData[r]={id:r,length:i,value:s}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),this.disksCount>1)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var e,t;for(e=0;e<this.files.length;e++)t=this.files[e],this.reader.setIndex(t.localHeaderOffset),this.checkSignature(Ie.LOCAL_FILE_HEADER),t.readLocalPart(this.reader),t.handleUTF8(),t.processAttributes()},readCentralDir:function(){var e;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(Ie.CENTRAL_FILE_HEADER);)e=new Fb({zip64:this.zip64},this.loadOptions),e.readCentralPart(this.reader),this.files.push(e);if(this.centralDirRecords!==this.files.length&&(this.centralDirRecords!==0&&this.files.length===0))throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var e=this.reader.lastIndexOfSignature(Ie.CENTRAL_DIRECTORY_END);if(e<0){var t=!this.isSignature(0,Ie.LOCAL_FILE_HEADER);throw t?new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html"):new Error("Corrupted zip: can't find end of central directory")}this.reader.setIndex(e);var r=e;if(this.checkSignature(Ie.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===We.MAX_VALUE_16BITS||this.diskWithCentralDirStart===We.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===We.MAX_VALUE_16BITS||this.centralDirRecords===We.MAX_VALUE_16BITS||this.centralDirSize===We.MAX_VALUE_32BITS||this.centralDirOffset===We.MAX_VALUE_32BITS){if(this.zip64=!0,e=this.reader.lastIndexOfSignature(Ie.ZIP64_CENTRAL_DIRECTORY_LOCATOR),e<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(e),this.checkSignature(Ie.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,Ie.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(Ie.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(Ie.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var i=this.centralDirOffset+this.centralDirSize;this.zip64&&(i+=20,i+=12+this.zip64EndOfCentralSize);var s=r-i;if(s>0)this.isSignature(r,Ie.CENTRAL_FILE_HEADER)||(this.reader.zero=s);else if(s<0)throw new Error("Corrupted zip: missing "+Math.abs(s)+" bytes.")},prepareReader:function(e){this.reader=Lb(e)},load:function(e){this.prepareReader(e),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}};jh.exports=$h}),Xh=F((Y_,Gh)=>{"use strict";var ls=q(),Ti=Bt(),Pb=pt(),ls=q(),Ub=Vh(),zb=cn(),Zh=or();function Cb(e){return new Ti.Promise(function(t,r){var i=e.decompressed.getContentWorker().pipe(new zb);i.on("error",function(s){r(s)}).on("end",function(){i.streamInfo.crc32!==e.decompressed.crc32?r(new Error("Corrupted zip : CRC32 mismatch")):t()}).resume()})}Gh.exports=function(e,t){var r=this;return t=ls.extend(t||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:Pb.utf8decode}),Zh.isNode&&Zh.isStream(e)?Ti.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):ls.prepareContent("the loaded zip file",e,!0,t.optimizedBinaryString,t.base64).then(function(i){var s=new Ub(t);return s.load(i),s}).then(function(s){var n=[Ti.Promise.resolve(s)],o=s.files;if(t.checkCRC32)for(var l=0;l<o.length;l++)n.push(Cb(o[l]));return Ti.Promise.all(n)}).then(function(s){for(var n=s.shift(),o=n.files,l=0;l<o.length;l++){var c=o[l];r.file(c.fileNameStr,c.decompressed,{binary:!0,optimizedBinaryString:!0,date:c.date,dir:c.dir,comment:c.fileCommentStr.length?c.fileCommentStr:null,unixPermissions:c.unixPermissions,dosPermissions:c.dosPermissions,createFolders:t.createFolders})}return n.zipComment.length&&(r.comment=n.zipComment),r})}}),qh=F((q_,Yh)=>{"use strict";function we(){if(!(this instanceof we))return new we;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files={},this.comment=null,this.root="",this.clone=function(){var e=new we;for(var t in this)typeof this[t]!="function"&&(e[t]=this[t]);return e}}we.prototype=Eh();we.prototype.loadAsync=Xh();we.support=Ue();we.defaults=sn();we.version="3.5.0";we.loadAsync=function(e,t){return new we().loadAsync(e,t)};we.external=Bt();Yh.exports=we}),du=F((zw,cu)=>{cu.exports=function(){"use strict";function e(i,s){function n(){this.constructor=i}n.prototype=s.prototype,i.prototype=new n}function t(i,s,n,o){this.message=i,this.expected=s,this.found=n,this.location=o,this.name="SyntaxError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,t)}e(t,Error),t.buildMessage=function(i,s){var n={literal:function(g){return'"'+l(g.text)+'"'},class:function(g){var b="",T;for(T=0;T<g.parts.length;T++)b+=g.parts[T]instanceof Array?c(g.parts[T][0])+"-"+c(g.parts[T][1]):c(g.parts[T]);return"["+(g.inverted?"^":"")+b+"]"},any:function(g){return"any character"},end:function(g){return"end of input"},other:function(g){return g.description}};function o(g){return g.charCodeAt(0).toString(16).toUpperCase()}function l(g){return g.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+o(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(b){return"\\x"+o(b)})}function c(g){return g.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,function(b){return"\\x0"+o(b)}).replace(/[\x10-\x1F\x7F-\x9F]/g,function(b){return"\\x"+o(b)})}function u(g){return n[g.type](g)}function f(g){var b=new Array(g.length),T,O;for(T=0;T<g.length;T++)b[T]=u(g[T]);if(b.sort(),b.length>0){for(T=1,O=1;T<b.length;T++)b[T-1]!==b[T]&&(b[O]=b[T],O++);b.length=O}switch(b.length){case 1:return b[0];case 2:return b[0]+" or "+b[1];default:return b.slice(0,-1).join(", ")+", or "+b[b.length-1]}}function S(g){return g?'"'+l(g)+'"':"end of input"}return"Expected "+f(i)+" but "+S(s)+" found."};function r(i,s){s=s!==void 0?s:{};var n={},o={Code:mo},l=mo,c=function(a){return a},u=function(a){return a.filter(d=>d)},f=Q("if(<condition>)"),S="if",g=W("if",!0),b=function(a){return{type:"if",expr:a}},T="else",O=W("else",!0),I=function(a){return a},v=function(a){return{type:"else",then:a}},N="endif",$=W("endif",!0),P=function(a){return{type:"endif",then:a}},D="break",H=W("break",!0),U=function(){return{type:"break"}},z=Q("while(<condition>)"),E="while",R=W("while",!0),M=function(a){return{type:"while",expr:a}},se="endwhile",$e=W("endwhile",!0),At=function(){return{type:"endwhile"}},Pr="do",Ur=W("do",!0),Dt=function(){return{type:"do"}},Nt=Q("until(<condition>)"),Cu="until",Hu=W("until",!0),Wu=function(a){return{type:"until",expr:a}},ju="endswitch",$u=W("endswitch",!0),Vu=function(){return{type:"endswitch"}},Gu="switch",Zu=W("switch",!0),Xu=function(){return{type:"switch"}},Yu=Q("case(<condition>)"),qu="case",Ku=W("case",!0),Ju=function(a,d){return d},Qu=function(a,d){return{type:"case",expr:a,then:d}},ec="default",tc=W("default",!0),rc=function(a){return{type:"default",then:a}},ic="function",nc=W("function",!0),sc=function(){return{type:"function"}},oc=Q("return <var name>"),ac="return",lc=W("return",!0),hc=function(a){return{type:"return",to:a}},Os=function(a,d){return d},uc=function(a,d,p){return{type:"varsDec",datatype:a,modifiers:d,names:p}},cc=Q("assigment operator"),As=":=",dc=W(":=",!1),Ds="::=",fc=W("::=",!1),mc=function(a,d,p){return{type:d,to:a,operand:p}},pc=Q("equality operator"),bc="=",gc=W("=",!1),_c=function(a,d,p){return{type:d,first:a,second:p}},wc=Q("function call"),Ns="(",ks=W("(",!1),Ci=")",Hi=W(")",!1),yc=function(a,d){return{type:"call",name:a,args:d}},vc=Q("function call chain"),Rs=function(a,d){return d},Sc=function(a,d){return{type:"callChain",functions:[a].concat(d)}},Tc=Q("unary operator"),Ec=function(a,d){return{type:a,operand:d}},Bs=Q("expression"),Ls=function(a){return{type:"expression",body:a}},xc=Q("constant"),Fs='"',Ms=W('"',!1),Ps=/^[^"]/,Us=Ae(['"'],!0,!1),zs="'",Cs=W("'",!1),Hs=/^[^']/,Ws=Ae(["'"],!0,!1),Ic=/^[\-+]/,Oc=Ae(["-","+"],!1,!1),Ac=/^[0-9.]/,Dc=Ae([["0","9"],"."],!1,!1),js=/^[0-9.e]/,$s=Ae([["0","9"],".","e"],!1,!1),Nc="#",kc=W("#",!1),Vs=/^[0-9]/,Gs=Ae([["0","9"]],!1,!1),Rc=function(a){return{type:"const",value:a}},Bc=function(a){return{type:"var",name:a}},Lc=Q("valid function name"),Zs="-",Xs=W("-",!1),Ys="+",qs=W("+",!1),Fc="!",Mc=W("!",!1),Pc="^",Uc=W("^",!1),zc=function(){return"**"},Cc="*",Hc=W("*",!1),Wc="/",jc=W("/",!1),$c="%",Vc=W("%",!1),Ks=">>",Gc=W(">>",!1),Js=">=",Zc=W(">=",!1),Xc=">",Yc=W(">",!1),Qs="<<",qc=W("<<",!1),eo="<=",Kc=W("<=",!1),Jc="<",Qc=W("<",!1),to="==",ed=W("==",!1),ro="!=",td=W("!=",!1),io="&&",rd=W("&&",!1),id="&",nd=W("&",!1),no="||",sd=W("||",!1),od="|",ad=W("|",!1),ld=Q("operand"),so=function(a,d,p){return{action:d,op:p}},hd=function(a,d){return{first:a,rest:d}},ud=Q("operator"),cd="~",dd=W("~",!1),fd=function(a,d){return C(C({},d),{isNew:!!a})},md="handle",pd=W("HANDLE",!0),bd="string",gd=W("STRING",!0),_d="float",wd=W("FLOAT",!0),yd="colorref",vd=W("COLORREF",!0),Sd="integer",Td=W("INTEGER",!0),Ed="local",xd=W("LOCAL",!0),Id="nosave",Od=W("NOSAVE",!0),Ad="parameter",Dd=W("PARAMETER",!0),Wi=",",ji=W(",",!1),oo=function(a,d){return d},Nd=function(a,d){return[a].concat(d)},kd=Q("variable name"),ao=/^[_a-z\u0430-\u044F0-9]/i,lo=Ae(["_",["a","z"],["\u0430","\u044F"],["0","9"]],!1,!0),Rd=Q("space or tab"),Bd=/^[ \t]/,Ld=Ae([" ","	"],!1,!1),Fd=Q("new line"),Md=/^[\n]/,Pd=Ae([`
`],!1,!1),Ud=Q("whitespace"),ho=/^[ \t\n\r]/,uo=Ae([" ","	",`
`,"\r"],!1,!1),zd=Q("if !<condition>)"),h=0,j=0,zr=[{line:1,column:1}],Oe=0,$i=[],w=0,Cr;if("startRule"in s){if(!(s.startRule in o))throw new Error(`Can't start parsing from rule "`+s.startRule+'".');l=o[s.startRule]}function Hg(){return i.substring(j,h)}function Wg(){return rr(j,h)}function jg(a,d){throw d=d!==void 0?d:rr(j,h),fo([Q(a)],i.substring(j,h),d)}function $g(a,d){throw d=d!==void 0?d:rr(j,h),Hd(a,d)}function W(a,d){return{type:"literal",text:a,ignoreCase:d}}function Ae(a,d,p){return{type:"class",parts:a,inverted:d,ignoreCase:p}}function Vg(){return{type:"any"}}function Cd(){return{type:"end"}}function Q(a){return{type:"other",description:a}}function co(a){var d=zr[a],p;if(d)return d;for(p=a-1;!zr[p];)p--;for(d=zr[p],d={line:d.line,column:d.column};p<a;)i.charCodeAt(p)===10?(d.line++,d.column=1):d.column++,p++;return zr[a]=d,d}function rr(a,d){var p=co(a),m=co(d);return{start:{offset:a,line:p.line,column:p.column},end:{offset:d,line:m.line,column:m.column}}}function x(a){if(h<Oe)return;h>Oe&&(Oe=h,$i=[]),$i.push(a)}function Hd(a,d){return new t(a,null,null,d)}function fo(a,d,p){return new t(t.buildMessage(a,d),a,d,p)}function mo(){var a,d,p,m,_,y,L;for(a=h,d=[],p=h,m=[],_=B();_!==n;)m.push(_),_=B();if(m!==n)if(_=kt(),_===n&&(_=null),_!==n){for(y=[],L=B();L!==n;)y.push(L),L=B();y!==n?(L=_o(),L!==n?(j=p,m=c(_),p=m):(h=p,p=n)):(h=p,p=n)}else h=p,p=n;else h=p,p=n;for(;p!==n;){for(d.push(p),p=h,m=[],_=B();_!==n;)m.push(_),_=B();if(m!==n)if(_=kt(),_===n&&(_=null),_!==n){for(y=[],L=B();L!==n;)y.push(L),L=B();y!==n?(L=_o(),L!==n?(j=p,m=c(_),p=m):(h=p,p=n)):(h=p,p=n)}else h=p,p=n;else h=p,p=n}return d!==n&&(j=a,d=u(d)),a=d,a}function kt(){var a;return a=nf(),a===n&&(a=sf(),a===n&&(a=of(),a===n&&(a=Wd(),a===n&&(a=$d(),a===n&&(a=Vd(),a===n&&(a=Gd(),a===n&&(a=Zd(),a===n&&(a=Xd(),a===n&&(a=Yd(),a===n&&(a=qd(),a===n&&(a=Kd(),a===n&&(a=Jd(),a===n&&(a=Qd(),a===n&&(a=ef(),a===n&&(a=af(),a===n&&(a=tf(),a===n&&(a=rf()))))))))))))))))),a}function Wd(){var a;return a=jd(),a===n&&(a=pf()),a}function jd(){var a,d,p,m;return w++,a=h,i.substr(h,2).toLowerCase()===S?(d=i.substr(h,2),h+=2):(d=n,w===0&&x(g)),d!==n?(p=ce(),p!==n?(m=ir(),m!==n?(j=a,d=b(m),a=d):(h=a,a=n)):(h=a,a=n)):(h=a,a=n),w--,a===n&&(d=n,w===0&&x(f)),a}function $d(){var a,d,p,m,_;if(a=h,i.substr(h,4).toLowerCase()===T?(d=i.substr(h,4),h+=4):(d=n,w===0&&x(O)),d!==n){if(p=h,m=[],_=B(),_!==n)for(;_!==n;)m.push(_),_=B();else m=n;m!==n?(_=kt(),_!==n?(j=p,m=I(_),p=m):(h=p,p=n)):(h=p,p=n),p===n&&(p=null),p!==n?(j=a,d=v(p),a=d):(h=a,a=n)}else h=a,a=n;return a}function Vd(){var a,d,p,m,_;if(a=h,i.substr(h,5).toLowerCase()===N?(d=i.substr(h,5),h+=5):(d=n,w===0&&x($)),d!==n){if(p=h,m=[],_=B(),_!==n)for(;_!==n;)m.push(_),_=B();else m=n;m!==n?(_=kt(),_!==n?(j=p,m=I(_),p=m):(h=p,p=n)):(h=p,p=n),p===n&&(p=null),p!==n?(j=a,d=P(p),a=d):(h=a,a=n)}else h=a,a=n;return a}function Gd(){var a,d;return a=h,i.substr(h,5).toLowerCase()===D?(d=i.substr(h,5),h+=5):(d=n,w===0&&x(H)),d!==n&&(j=a,d=U()),a=d,a}function Zd(){var a,d,p,m;return w++,a=h,i.substr(h,5).toLowerCase()===E?(d=i.substr(h,5),h+=5):(d=n,w===0&&x(R)),d!==n?(p=ce(),p!==n?(m=ir(),m!==n?(j=a,d=M(m),a=d):(h=a,a=n)):(h=a,a=n)):(h=a,a=n),w--,a===n&&(d=n,w===0&&x(z)),a}function Xd(){var a,d;return a=h,i.substr(h,8).toLowerCase()===se?(d=i.substr(h,8),h+=8):(d=n,w===0&&x($e)),d!==n&&(j=a,d=At()),a=d,a}function Yd(){var a,d;return a=h,i.substr(h,2).toLowerCase()===Pr?(d=i.substr(h,2),h+=2):(d=n,w===0&&x(Ur)),d!==n&&(j=a,d=Dt()),a=d,a}function qd(){var a,d,p,m;return w++,a=h,i.substr(h,5).toLowerCase()===Cu?(d=i.substr(h,5),h+=5):(d=n,w===0&&x(Hu)),d!==n?(p=ce(),p!==n?(m=ir(),m!==n?(j=a,d=Wu(m),a=d):(h=a,a=n)):(h=a,a=n)):(h=a,a=n),w--,a===n&&(d=n,w===0&&x(Nt)),a}function Kd(){var a,d;return a=h,i.substr(h,9).toLowerCase()===ju?(d=i.substr(h,9),h+=9):(d=n,w===0&&x($u)),d!==n&&(j=a,d=Vu()),a=d,a}function Jd(){var a,d;return a=h,i.substr(h,6).toLowerCase()===Gu?(d=i.substr(h,6),h+=6):(d=n,w===0&&x(Zu)),d!==n&&(j=a,d=Xu()),a=d,a}function Qd(){var a,d,p,m,_,y,L;if(w++,a=h,i.substr(h,4).toLowerCase()===qu?(d=i.substr(h,4),h+=4):(d=n,w===0&&x(Ku)),d!==n)if(p=ce(),p!==n)if(m=ir(),m!==n){if(_=h,y=[],L=B(),L!==n)for(;L!==n;)y.push(L),L=B();else y=n;y!==n?(L=kt(),L!==n?(j=_,y=Ju(m,L),_=y):(h=_,_=n)):(h=_,_=n),_===n&&(_=null),_!==n?(j=a,d=Qu(m,_),a=d):(h=a,a=n)}else h=a,a=n;else h=a,a=n;else h=a,a=n;return w--,a===n&&(d=n,w===0&&x(Yu)),a}function ef(){var a,d,p,m,_;if(a=h,i.substr(h,7).toLowerCase()===ec?(d=i.substr(h,7),h+=7):(d=n,w===0&&x(tc)),d!==n){if(p=h,m=[],_=B(),_!==n)for(;_!==n;)m.push(_),_=B();else m=n;m!==n?(_=kt(),_!==n?(j=p,m=I(_),p=m):(h=p,p=n)):(h=p,p=n),p===n&&(p=null),p!==n?(j=a,d=rc(p),a=d):(h=a,a=n)}else h=a,a=n;return a}function tf(){var a,d;return a=h,i.substr(h,8).toLowerCase()===ic?(d=i.substr(h,8),h+=8):(d=n,w===0&&x(nc)),d!==n&&(j=a,d=sc()),a=d,a}function rf(){var a,d,p,m;return w++,a=h,i.substr(h,6).toLowerCase()===ac?(d=i.substr(h,6),h+=6):(d=n,w===0&&x(lc)),d!==n?(p=ce(),p!==n?(m=dt(),m!==n?(j=a,d=hc(m),a=d):(h=a,a=n)):(h=a,a=n)):(h=a,a=n),w--,a===n&&(d=n,w===0&&x(oc)),a}function nf(){var a,d,p,m,_,y,L,V,De;if(a=h,d=ff(),d!==n){if(p=[],m=B(),m!==n)for(;m!==n;)p.push(m),m=B();else p=n;if(p!==n)if(m=ce(),m!==n){if(_=[],y=h,L=bo(),L!==n){if(V=[],De=B(),De!==n)for(;De!==n;)V.push(De),De=B();else V=n;V!==n?(j=y,L=Os(d,L),y=L):(h=y,y=n)}else h=y,y=n;for(;y!==n;)if(_.push(y),y=h,L=bo(),L!==n){if(V=[],De=B(),De!==n)for(;De!==n;)V.push(De),De=B();else V=n;V!==n?(j=y,L=Os(d,L),y=L):(h=y,y=n)}else h=y,y=n;_!==n?(y=mf(),y!==n?(j=a,d=uc(d,_,y),a=d):(h=a,a=n)):(h=a,a=n)}else h=a,a=n;else h=a,a=n}else h=a,a=n;return a}function sf(){var a,d,p,m,_,y;if(w++,a=h,d=dt(),d!==n)if(p=ce(),p!==n)if(i.substr(h,2)===As?(m=As,h+=2):(m=n,w===0&&x(dc)),m===n&&(i.substr(h,3)===Ds?(m=Ds,h+=3):(m=n,w===0&&x(fc))),m!==n){for(_=[],y=B();y!==n;)_.push(y),y=B();_!==n?(y=ct(),y!==n?(j=a,d=mc(d,m,y),a=d):(h=a,a=n)):(h=a,a=n)}else h=a,a=n;else h=a,a=n;else h=a,a=n;return w--,a===n&&(d=n,w===0&&x(cc)),a}function of(){var a,d,p,m,_,y;if(w++,a=h,d=ct(),d!==n)if(p=ce(),p!==n)if(i.charCodeAt(h)===61?(m=bc,h++):(m=n,w===0&&x(gc)),m!==n){for(_=[],y=B();y!==n;)_.push(y),y=B();_!==n?(y=ct(),y!==n?(j=a,d=_c(d,m,y),a=d):(h=a,a=n)):(h=a,a=n)}else h=a,a=n;else h=a,a=n;else h=a,a=n;return w--,a===n&&(d=n,w===0&&x(pc)),a}function Hr(){var a,d,p,m,_,y,L,V;if(w++,a=h,d=cf(),d!==n){for(p=[],m=B();m!==n;)p.push(m),m=B();if(p!==n)if(i.charCodeAt(h)===40?(m=Ns,h++):(m=n,w===0&&x(ks)),m!==n){for(_=[],y=B();y!==n;)_.push(y),y=B();if(_!==n){for(y=[],L=go();L!==n;)y.push(L),L=go();if(y!==n){for(L=[],V=B();V!==n;)L.push(V),V=B();L!==n?(i.charCodeAt(h)===41?(V=Ci,h++):(V=n,w===0&&x(Hi)),V!==n?(j=a,d=yc(d,y),a=d):(h=a,a=n)):(h=a,a=n)}else h=a,a=n}else h=a,a=n}else h=a,a=n;else h=a,a=n}else h=a,a=n;return w--,a===n&&(d=n,w===0&&x(wc)),a}function af(){var a,d,p,m,_,y;if(w++,a=h,d=Hr(),d!==n){if(p=[],m=h,_=[],y=B(),y!==n)for(;y!==n;)_.push(y),y=B();else _=n;for(_!==n?(y=Hr(),y!==n?(j=m,_=Rs(d,y),m=_):(h=m,m=n)):(h=m,m=n);m!==n;){if(p.push(m),m=h,_=[],y=B(),y!==n)for(;y!==n;)_.push(y),y=B();else _=n;_!==n?(y=Hr(),y!==n?(j=m,_=Rs(d,y),m=_):(h=m,m=n)):(h=m,m=n)}p!==n?(j=a,d=Sc(d,p),a=d):(h=a,a=n)}else h=a,a=n;return w--,a===n&&(d=n,w===0&&x(vc)),a}function lf(){var a,d,p,m;if(w++,a=h,d=df(),d!==n){for(p=[],m=B();m!==n;)p.push(m),m=B();p!==n?(m=ct(),m!==n?(j=a,d=Ec(d,m),a=d):(h=a,a=n)):(h=a,a=n)}else h=a,a=n;return w--,a===n&&(d=n,w===0&&x(Tc)),a}function ir(){var a,d,p,m,_,y;if(w++,a=h,i.charCodeAt(h)===40?(d=Ns,h++):(d=n,w===0&&x(ks)),d!==n){for(p=[],m=B();m!==n;)p.push(m),m=B();if(p!==n)if(m=ct(),m!==n){for(_=[],y=B();y!==n;)_.push(y),y=B();_!==n?(i.charCodeAt(h)===41?(y=Ci,h++):(y=n,w===0&&x(Hi)),y!==n?(j=a,d=Ls(m),a=d):(h=a,a=n)):(h=a,a=n)}else h=a,a=n;else h=a,a=n}else h=a,a=n;return w--,a===n&&(d=n,w===0&&x(Bs)),a}function hf(){var a,d,p,m,_,y,L;if(w++,a=h,d=h,p=h,i.charCodeAt(h)===34?(m=Fs,h++):(m=n,w===0&&x(Ms)),m!==n){for(_=[],Ps.test(i.charAt(h))?(y=i.charAt(h),h++):(y=n,w===0&&x(Us));y!==n;)_.push(y),Ps.test(i.charAt(h))?(y=i.charAt(h),h++):(y=n,w===0&&x(Us));_!==n?(i.charCodeAt(h)===34?(y=Fs,h++):(y=n,w===0&&x(Ms)),y!==n?(m=[m,_,y],p=m):(h=p,p=n)):(h=p,p=n)}else h=p,p=n;if(p===n){if(p=h,i.charCodeAt(h)===39?(m=zs,h++):(m=n,w===0&&x(Cs)),m!==n){for(_=[],Hs.test(i.charAt(h))?(y=i.charAt(h),h++):(y=n,w===0&&x(Ws));y!==n;)_.push(y),Hs.test(i.charAt(h))?(y=i.charAt(h),h++):(y=n,w===0&&x(Ws));_!==n?(i.charCodeAt(h)===39?(y=zs,h++):(y=n,w===0&&x(Cs)),y!==n?(m=[m,_,y],p=m):(h=p,p=n)):(h=p,p=n)}else h=p,p=n;if(p===n){if(p=h,Ic.test(i.charAt(h))?(m=i.charAt(h),h++):(m=n,w===0&&x(Oc)),m===n&&(m=null),m!==n)if(Ac.test(i.charAt(h))?(_=i.charAt(h),h++):(_=n,w===0&&x(Dc)),_!==n){for(y=[],js.test(i.charAt(h))?(L=i.charAt(h),h++):(L=n,w===0&&x($s));L!==n;)y.push(L),js.test(i.charAt(h))?(L=i.charAt(h),h++):(L=n,w===0&&x($s));y!==n?(m=[m,_,y],p=m):(h=p,p=n)}else h=p,p=n;else h=p,p=n;if(p===n)if(p=h,i.charCodeAt(h)===35?(m=Nc,h++):(m=n,w===0&&x(kc)),m!==n){for(_=[],Vs.test(i.charAt(h))?(y=i.charAt(h),h++):(y=n,w===0&&x(Gs));y!==n;)_.push(y),Vs.test(i.charAt(h))?(y=i.charAt(h),h++):(y=n,w===0&&x(Gs));_!==n?(m=[m,_],p=m):(h=p,p=n)}else h=p,p=n}}return p!==n?d=i.substring(d,h):d=p,d!==n&&(j=a,d=Rc(d)),a=d,w--,a===n&&(d=n,w===0&&x(xc)),a}function uf(){var a,d;return a=h,d=dt(),d!==n&&(j=a,d=Bc(d)),a=d,a}function cf(){var a,d;return w++,a=dt(),w--,a===n&&(d=n,w===0&&x(Lc)),a}function df(){var a;return i.charCodeAt(h)===45?(a=Zs,h++):(a=n,w===0&&x(Xs)),a===n&&(i.charCodeAt(h)===43?(a=Ys,h++):(a=n,w===0&&x(qs)),a===n&&(i.charCodeAt(h)===33?(a=Fc,h++):(a=n,w===0&&x(Mc)))),a}function po(){var a,d;return a=h,i.charCodeAt(h)===94?(d=Pc,h++):(d=n,w===0&&x(Uc)),d!==n&&(j=a,d=zc()),a=d,a===n&&(i.charCodeAt(h)===42?(a=Cc,h++):(a=n,w===0&&x(Hc)),a===n&&(i.charCodeAt(h)===47?(a=Wc,h++):(a=n,w===0&&x(jc)),a===n&&(i.charCodeAt(h)===37?(a=$c,h++):(a=n,w===0&&x(Vc)),a===n&&(i.charCodeAt(h)===43?(a=Ys,h++):(a=n,w===0&&x(qs)),a===n&&(i.charCodeAt(h)===45?(a=Zs,h++):(a=n,w===0&&x(Xs)),a===n&&(i.substr(h,2)===Ks?(a=Ks,h+=2):(a=n,w===0&&x(Gc)),a===n&&(i.substr(h,2)===Js?(a=Js,h+=2):(a=n,w===0&&x(Zc)),a===n&&(i.charCodeAt(h)===62?(a=Xc,h++):(a=n,w===0&&x(Yc)),a===n&&(i.substr(h,2)===Qs?(a=Qs,h+=2):(a=n,w===0&&x(qc)),a===n&&(i.substr(h,2)===eo?(a=eo,h+=2):(a=n,w===0&&x(Kc)),a===n&&(i.charCodeAt(h)===60?(a=Jc,h++):(a=n,w===0&&x(Qc)),a===n&&(i.substr(h,2)===to?(a=to,h+=2):(a=n,w===0&&x(ed)),a===n&&(i.substr(h,2)===ro?(a=ro,h+=2):(a=n,w===0&&x(td)),a===n&&(i.substr(h,2)===io?(a=io,h+=2):(a=n,w===0&&x(rd)),a===n&&(i.charCodeAt(h)===38?(a=id,h++):(a=n,w===0&&x(nd)),a===n&&(i.substr(h,2)===no?(a=no,h+=2):(a=n,w===0&&x(sd)),a===n&&(i.charCodeAt(h)===124?(a=od,h++):(a=n,w===0&&x(ad))))))))))))))))))),a}function ct(){var a,d,p,m,_,y,L,V;if(w++,a=h,d=Vi(),d!==n){for(p=[],m=h,_=[],y=B();y!==n;)_.push(y),y=B();if(_!==n)if(y=po(),y!==n){for(L=[],V=B();V!==n;)L.push(V),V=B();L!==n?(V=Vi(),V!==n?(j=m,_=so(d,y,V),m=_):(h=m,m=n)):(h=m,m=n)}else h=m,m=n;else h=m,m=n;for(;m!==n;){for(p.push(m),m=h,_=[],y=B();y!==n;)_.push(y),y=B();if(_!==n)if(y=po(),y!==n){for(L=[],V=B();V!==n;)L.push(V),V=B();L!==n?(V=Vi(),V!==n?(j=m,_=so(d,y,V),m=_):(h=m,m=n)):(h=m,m=n)}else h=m,m=n;else h=m,m=n}p!==n?(j=a,d=hd(d,p),a=d):(h=a,a=n)}else h=a,a=n;return w--,a===n&&(d=n,w===0&&x(ld)),a}function Vi(){var a,d,p,m;if(w++,a=h,i.charCodeAt(h)===126?(d=cd,h++):(d=n,w===0&&x(dd)),d===n&&(d=null),d!==n){for(p=[],m=B();m!==n;)p.push(m),m=B();p!==n?(m=lf(),m===n&&(m=hf(),m===n&&(m=Hr(),m===n&&(m=uf(),m===n&&(m=ir())))),m!==n?(j=a,d=fd(d,m),a=d):(h=a,a=n)):(h=a,a=n)}else h=a,a=n;return w--,a===n&&(d=n,w===0&&x(ud)),a}function ff(){var a;return i.substr(h,6).toLowerCase()===md?(a=i.substr(h,6),h+=6):(a=n,w===0&&x(pd)),a===n&&(i.substr(h,6).toLowerCase()===bd?(a=i.substr(h,6),h+=6):(a=n,w===0&&x(gd)),a===n&&(i.substr(h,5).toLowerCase()===_d?(a=i.substr(h,5),h+=5):(a=n,w===0&&x(wd)),a===n&&(i.substr(h,8).toLowerCase()===yd?(a=i.substr(h,8),h+=8):(a=n,w===0&&x(vd)),a===n&&(i.substr(h,7).toLowerCase()===Sd?(a=i.substr(h,7),h+=7):(a=n,w===0&&x(Td)))))),a}function bo(){var a;return i.substr(h,5).toLowerCase()===Ed?(a=i.substr(h,5),h+=5):(a=n,w===0&&x(xd)),a===n&&(i.substr(h,6).toLowerCase()===Id?(a=i.substr(h,6),h+=6):(a=n,w===0&&x(Od)),a===n&&(i.substr(h,9).toLowerCase()===Ad?(a=i.substr(h,9),h+=9):(a=n,w===0&&x(Dd)))),a}function mf(){var a,d,p,m,_,y,L,V;if(a=h,d=dt(),d!==n){for(p=[],m=h,_=ce(),_!==n?(i.charCodeAt(h)===44?(y=Wi,h++):(y=n,w===0&&x(ji)),y!==n?(L=ce(),L!==n?(V=dt(),V!==n?(j=m,_=oo(d,V),m=_):(h=m,m=n)):(h=m,m=n)):(h=m,m=n)):(h=m,m=n);m!==n;)p.push(m),m=h,_=ce(),_!==n?(i.charCodeAt(h)===44?(y=Wi,h++):(y=n,w===0&&x(ji)),y!==n?(L=ce(),L!==n?(V=dt(),V!==n?(j=m,_=oo(d,V),m=_):(h=m,m=n)):(h=m,m=n)):(h=m,m=n)):(h=m,m=n);p!==n?(j=a,d=Nd(d,p),a=d):(h=a,a=n)}else h=a,a=n;return a}function go(){var a,d,p,m,_;for(a=h,d=[],p=B();p!==n;)d.push(p),p=B();if(d!==n)if(p=ct(),p!==n){for(m=[],_=B();_!==n;)m.push(_),_=B();m!==n?(i.charCodeAt(h)===44?(_=Wi,h++):(_=n,w===0&&x(ji)),_===n&&(_=null),_!==n?(j=a,d=I(p),a=d):(h=a,a=n)):(h=a,a=n)}else h=a,a=n;else h=a,a=n;return a}function dt(){var a,d,p;if(w++,a=h,d=[],ao.test(i.charAt(h))?(p=i.charAt(h),h++):(p=n,w===0&&x(lo)),p!==n)for(;p!==n;)d.push(p),ao.test(i.charAt(h))?(p=i.charAt(h),h++):(p=n,w===0&&x(lo));else d=n;return d!==n?a=i.substring(a,h):a=d,w--,a===n&&(d=n,w===0&&x(kd)),a}function B(){var a,d;return w++,Bd.test(i.charAt(h))?(a=i.charAt(h),h++):(a=n,w===0&&x(Ld)),w--,a===n&&(d=n,w===0&&x(Rd)),a}function _o(){var a,d;return w++,Md.test(i.charAt(h))?(a=i.charAt(h),h++):(a=n,w===0&&x(Pd)),w--,a===n&&(d=n,w===0&&x(Fd)),a}function ce(){var a,d;for(w++,a=[],ho.test(i.charAt(h))?(d=i.charAt(h),h++):(d=n,w===0&&x(uo));d!==n;)a.push(d),ho.test(i.charAt(h))?(d=i.charAt(h),h++):(d=n,w===0&&x(uo));return w--,a===n&&(d=n,w===0&&x(Ud)),a}function pf(){var a,d,p,m;return w++,a=h,i.substr(h,2).toLowerCase()===S?(d=i.substr(h,2),h+=2):(d=n,w===0&&x(g)),d!==n?(p=ce(),p!==n?(m=bf(),m!==n?(j=a,d=b(m),a=d):(h=a,a=n)):(h=a,a=n)):(h=a,a=n),w--,a===n&&(d=n,w===0&&x(zd)),a}function bf(){var a,d,p,m,_;for(w++,a=h,d=[],p=B();p!==n;)d.push(p),p=B();if(d!==n)if(p=ct(),p!==n){for(m=[],_=B();_!==n;)m.push(_),_=B();m!==n?(i.charCodeAt(h)===41?(_=Ci,h++):(_=n,w===0&&x(Hi)),_!==n?(j=a,d=Ls(p),a=d):(h=a,a=n)):(h=a,a=n)}else h=a,a=n;else h=a,a=n;return w--,a===n&&(d=n,w===0&&x(Bs)),a}if(Cr=l(),Cr!==n&&h===i.length)return Cr;throw Cr!==n&&h<i.length&&x(Cd()),fo($i,Oe<i.length?i.charAt(Oe):null,Oe<i.length?rr(Oe,Oe+1):rr(Oe,Oe))}return{SyntaxError:t,parse:r}}()}),Rr=F(Cg=>{Sf(Cg,{FastestExecutor:()=>Uu,SmoothExecutor:()=>Pu,options:()=>Fu,setLogLevel:()=>Mu,unzip:()=>Lu,version:()=>zu});const Lu=Bu,Fu={};function Mu(e){}const Pu=yo,Uu=vo,zu="0.8.0"});class yo{constructor(){this.frameId=0;this._running=!1}_loop(e){return requestAnimationFrame(()=>{e()?this.frameId=this._loop(e):this._running=!1})}_unloop(){cancelAnimationFrame(this.frameId)}get running(){return this._running}run(e){if(this._running)return;this._running=!0,this.frameId=this._loop(e)}stop(){if(!this._running)return;this._running=!1,this._unloop()}}class vo{constructor(e){this.frameId=0;this._running=!1;this.timeout=typeof e=="number"?e:0}_loop(e){return setTimeout(()=>{e()?this.frameId=this._loop(e):this._running=!1},this.timeout)}_unloop(){clearTimeout(this.frameId)}get running(){return this._running}run(e){if(this._running)return;this._running=!0,this.frameId=this._loop(e)}stop(){if(!this._running)return;this._running=!1,this._unloop()}}const gu=nr(qh()),Kh=["brushTools","penTools","dibTools","doubleDibTools","fontTools","stringTools","textTools"];function Kt(e){return e?e.map(t=>C({},t)):void 0}function Jh(e){var r,i;const t=C({},e);return t.brushTools=Kt(e.brushTools),t.penTools=Kt(e.penTools),t.dibTools=Kt(e.dibTools),t.doubleDibTools=Kt(e.doubleDibTools),t.fontTools=Kt(e.fontTools),t.stringTools=Kt(e.stringTools),t.textTools=(r=e.textTools)==null?void 0:r.map(s=>C(C({},s),{textCollection:s.textCollection.map(n=>C({},n))})),t.elements=(i=e.elements)==null?void 0:i.map(s=>s.type==="otGROUP2D"?C(C({},s),{childHandles:s.childHandles.slice()}):C({},s)),t.elementOrder=e.elementOrder&&e.elementOrder.slice(),t}function Qh(e,t){const r=e.find(i=>i.handle===t);if(!r||r.type!=="otGROUP2D")throw Error(`\u041D\u0430 \u0441\u0445\u0435\u043C\u0435 \u043D\u0435\u0442 \u0433\u0440\u0443\u043F\u043F\u044B ${t}`);return r}function eu(e,t){const r=t.childHandles[0],i=e.find(s=>s.handle===r);if(!i||i.type!=="otDOUBLEBITMAP2D")throw Error(`\u041D\u0430 \u0441\u0445\u0435\u043C\u0435 \u043D\u0435\u0442 \u0438\u043A\u043E\u043D\u043A\u0438 \u0438\u043C\u0438\u0434\u0436\u0430 #${t.handle}`);return i}function Hb(e,t){const r=new Map;let i=1;for(const s of t){for(;e.some(n=>n.handle===i);)++i;r.set(s.handle,i),s.handle=i,e.push(s)}return r}function Wb(e,t){const r={};for(const i of Kh){const s=t[i];if(!s)continue;const n=e[i];if(!n){e[i]=s;continue}r[i]=Hb(n,s)}return r}function nt(e,t,r){if(!e)return;for(const i of e){const s=i[t];i[t]=r.get(s)||s}}function jb(e,t,r){switch(t){case"fontTools":{const{textTools:i}=e;i&&i.forEach(s=>nt(s.textCollection,"fontHandle",r));break}case"stringTools":{const{textTools:i}=e;i&&i.forEach(s=>nt(s.textCollection,"stringHandle",r));break}case"dibTools":{nt(e.brushTools,"dibHandle",r);break}}}function $b(e,t,r){switch(t){case"brushTools":const i=e.filter(c=>c.type==="otLINE2D");nt(i,"brushHandle",r);break;case"penTools":const s=e.filter(c=>c.type==="otLINE2D");nt(s,"penHandle",r);break;case"dibTools":const n=e.filter(c=>c.type==="otBITMAP2D");nt(n,"dibHandle",r);break;case"doubleDibTools":const o=e.filter(c=>c.type==="otDOUBLEBITMAP2D");nt(o,"dibHandle",r);break;case"textTools":const l=e.filter(c=>c.type==="otTEXT2D");nt(l,"textToolHandle",r);break}}function Vb(e,t){for(const r of Kh){const i=t[r];if(!i)continue;jb(e,r,i),e.elements&&$b(e.elements,r,i)}}function Gb(e){let t,r;for(const i of e){if(i.type==="otGROUP2D")continue;(t===void 0||i.originX<t)&&(t=i.originX),(r===void 0||i.originY<r)&&(r=i.originY)}return{x:t||0,y:r||0}}function Zb(e,t){return e.some(r=>r.type==="otGROUP2D"&&r.childHandles.includes(t.handle))}function Xb(e,t,r){const i=new Map;if(t.length===0)return{map:i,rootHandle:0};let s=1;const n=[];for(const l of t){for(;e.some(c=>c.handle===s);)++s;if(Zb(t,l)||n.push(s),i.set(l.handle,s),l.handle=s,e.push(l),l.type==="otGROUP2D")continue;if(l.originX+=r.x,l.originY+=r.y,l.type==="otLINE2D"){l.coords=l.coords.slice();for(let c=0;c<l.coords.length;c+=2)l.coords[c+0]+=r.x,l.coords[c+1]+=r.y}}if(n.length===0)throw Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u043E\u0431\u044A\u0435\u0434\u0438\u043D\u0435\u043D\u0438\u044F \u0438\u043C\u0438\u0434\u0436\u0435\u0439");if(n.length===1)return{map:i,rootHandle:n[0]};for(;e.some(l=>l.handle===s);)++s;const o={type:"otGROUP2D",handle:s,childHandles:n,options:0,name:""};return e.push(o),{map:i,rootHandle:o.handle}}function Yb(e,t){for(const r of e){if(r.type!=="otGROUP2D")continue;r.childHandles=r.childHandles.map(i=>t.get(i)||i)}}function qb(e,t){return e.map(r=>t.get(r)||r)}function Kb(e){return e.elements!==void 0&&e.elements.length>0}class tu{constructor(e){const t=Jh(e);if(!Kb(t))throw Error("\u0421\u0445\u0435\u043C\u0430 \u043D\u0435 \u0438\u043C\u0435\u0435\u0442 \u044D\u043B\u0435\u043C\u0435\u043D\u0442\u043E\u0432");this.scheme=t}get result(){return this.scheme}insertChildImage(e,t){const{scheme:r}=this,i=Jh(t),s=Wb(r,i);if(Vb(i,s),!i.elements)return;const n=Qh(r.elements,e),o=eu(r.elements,n);o.hidden=!0;const l=Gb(i.elements),c={x:o.originX-l.x,y:o.originY-l.y},{map:u,rootHandle:f}=Xb(r.elements,i.elements,c);if(Yb(i.elements,u),n.childHandles.push(f),!i.elementOrder)return;const S=qb(i.elementOrder,u),g=r.elementOrder;r.elementOrder=g?g.concat(S):S}replaceIcon(e,t,r){const{scheme:i}=this,s=Qh(i.elements,e),n=eu(i.elements,s),o={type:"ttREFTODOUBLEDIB2D",handle:0,filename:t};let l=1;if(i.doubleDibTools){for(;i.doubleDibTools.some(u=>u.handle===l);)++l;i.doubleDibTools.push(o)}else i.doubleDibTools=[o];n.dibHandle=o.handle=l;let c=0;switch(t.toUpperCase()){case"SYSTEM.DBM":c=2;break;default:return}n.cropX=r%c*32,n.cropY=Math.floor(r/c)*32}}class ru{constructor(e){const t=this.lib=new Map;for(const r of e){const i=r.name.toUpperCase(),s=t.size;if(t.set(i,r),t.size===s){const n=e.filter(o=>o.name.toUpperCase()===i).map(o=>o.filepathDos);throw Error(`\u041A\u043E\u043D\u0444\u043B\u0438\u043A\u0442 \u0438\u043C\u0435\u043D \u0438\u043C\u0438\u0434\u0436\u0435\u0439: "${r.name}" \u043E\u0431\u043D\u0430\u0440\u0443\u0436\u0435\u043D \u0432 \u0444\u0430\u0439\u043B\u0430\u0445:
${n.join(`;
`)}.`)}}}get(e){return this.lib.get(e.toUpperCase())}getComposedScheme(e){const t=this.get(e);if(!(t==null?void 0:t.scheme))return;if(!t.children)return t.scheme;const r=new tu(t.scheme);for(const i of t.children){const s=this.get(i.classname);if(!s)throw Error(`\u041F\u043E\u0434\u0438\u043C\u0438\u0434\u0436 ${i.classname} #${i.schemeInfo.handle} \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D.`);const{handle:n}=i.schemeInfo;s.iconFile&&r.replaceIcon(n,s.iconFile,s.iconIndex||0),s.image&&!s.alwaysUseIcon()&&r.insertChildImage(n,s.image)}return r.result}}const hs=/[/\\]/;function Jt(e){return e.split(hs).map(t=>t.trim()).filter(t=>t.length>0)}function us(e){if(e.length!==1||!/[A-Z]/.test(e))throw Error(`\u041D\u0435\u043A\u043E\u0440\u0440\u0435\u043A\u0442\u043D\u044B\u0439 \u043F\u0440\u0435\u0444\u0438\u043A\u0441 \u0434\u0438\u0441\u043A\u0430: ${e}.`)}function iu(e,t){const r=e.split(":");if(r.length>2)throw Error("\u0414\u0432\u043E\u0435\u0442\u043E\u0447\u0438\u0435 \u043F\u043E\u0441\u043B\u0435 \u043F\u0440\u0435\u0444\u0438\u043A\u0441\u0430 \u0434\u0438\u0441\u043A\u0430 \u0434\u043E\u043B\u0436\u043D\u043E \u0432\u0441\u0442\u0440\u0435\u0447\u0430\u0442\u044C\u0441\u044F \u043B\u0438\u0448\u044C \u0435\u0434\u0438\u043D\u043E\u0436\u0434\u044B.");let i=t,s=r[0];if(r.length!==1){s=r[1];const n=r[0].trim().toUpperCase();us(n),i=n}return[i,Jt(s)]}const bu=nr(Rr());var A;(function(e){e[e.PI=Math.PI]="PI",e[e.WORD8=0]="WORD8",e[e.INT8=1]="INT8",e[e.WORD16=2]="WORD16",e[e.INT16=3]="INT16",e[e.WORD32=4]="WORD32",e[e.INT32=5]="INT32",e[e.FLOAT32=6]="FLOAT32",e[e.FLOAT40=7]="FLOAT40",e[e.FLOAT64=8]="FLOAT64",e[e.FLOAT80=9]="FLOAT80",e[e.PEN2D=1]="PEN2D",e[e.BRUSH2D=2]="BRUSH2D",e[e.DIB2D=3]="DIB2D",e[e.DOUBLEDIB2D=4]="DOUBLEDIB2D",e[e.FONT2D=5]="FONT2D",e[e.STRING2D=6]="STRING2D",e[e.TEXT2D=7]="TEXT2D",e[e.SPACE3D=8]="SPACE3D",e[e.TEXTURE3D=9]="TEXTURE3D",e[e.SIZE_RESTORED=0]="SIZE_RESTORED",e[e.SIZE_MINIMIZED=1]="SIZE_MINIMIZED",e[e.SIZE_MAXIMIZED=2]="SIZE_MAXIMIZED",e[e.SIZE_MAXSHOW=3]="SIZE_MAXSHOW",e[e.SIZE_MAXHIDE=4]="SIZE_MAXHIDE",e[e.OTGROUP2D=3]="OTGROUP2D",e[e.OTRGROUP2D=4]="OTRGROUP2D",e[e.OTGROUP3D=5]="OTGROUP3D",e[e.OTOBJECT3D=10]="OTOBJECT3D",e[e.OTLINE_2D=20]="OTLINE_2D",e[e.OTBITMAP_2D=21]="OTBITMAP_2D",e[e.OTDOUBLEBITMAP_2D=22]="OTDOUBLEBITMAP_2D",e[e.OTTEXT_2D=23]="OTTEXT_2D",e[e.OTVIEW3D_2D=24]="OTVIEW3D_2D",e[e.OTEDITFRAME=50]="OTEDITFRAME",e[e.OTROTATECENTER=51]="OTROTATECENTER",e[e.OTFRAME3D=52]="OTFRAME3D",e[e.OTAXIS3D=53]="OTAXIS3D",e[e.OTPEN2D=101]="OTPEN2D",e[e.OTBRUSH2D=102]="OTBRUSH2D",e[e.OTDIB2D=103]="OTDIB2D",e[e.OTDOUBLEDIB2D=104]="OTDOUBLEDIB2D",e[e.OTFONT2D=105]="OTFONT2D",e[e.OTSTRING2D=106]="OTSTRING2D",e[e.OTTEXT2D=107]="OTTEXT2D",e[e.OTREFTODIB2D=110]="OTREFTODIB2D",e[e.OTREFTODOUBLEDIB2D=111]="OTREFTODOUBLEDIB2D",e[e.ATTRSET=1]="ATTRSET",e[e.ATTRRESET=2]="ATTRRESET",e[e.ATTRPUT=3]="ATTRPUT",e[e.PFC_MOVEOBJECT=32768]="PFC_MOVEOBJECT",e[e.PFC_SETCURRENT=16384]="PFC_SETCURRENT",e[e.PFC_SETFRAME=8192]="PFC_SETFRAME",e[e.PFC_PENS=1]="PFC_PENS",e[e.PFC_BRUHS=2]="PFC_BRUHS",e[e.PFC_DIBS=4]="PFC_DIBS",e[e.PFC_DDIBS=8]="PFC_DDIBS",e[e.PFC_STRINGS=16]="PFC_STRINGS",e[e.PFC_FONTS=32]="PFC_FONTS",e[e.PFC_TEXTS=64]="PFC_TEXTS",e[e.PFC_3D=128]="PFC_3D",e[e.PFC_ALL=255]="PFC_ALL",e[e.OID_RESERVED=32e3]="OID_RESERVED",e[e.OID_RCENTER=32001]="OID_RCENTER",e[e.OID_FRAME2D1=32002]="OID_FRAME2D1",e[e.OID_FRAME2D2=32003]="OID_FRAME2D2",e[e.OID_FRAME2D3=32004]="OID_FRAME2D3",e[e.OID_FRAME2D4=32005]="OID_FRAME2D4",e[e.OID_FRAME2D5=32006]="OID_FRAME2D5",e[e.OID_FRAME2D6=32007]="OID_FRAME2D6",e[e.OID_FRAME2D7=32008]="OID_FRAME2D7",e[e.OID_FRAME2D8=32009]="OID_FRAME2D8",e[e.OID_FRAME2D=32010]="OID_FRAME2D",e[e.OID_AXIS3D=32100]="OID_AXIS3D",e[e.OID_FRAME3D1=32102]="OID_FRAME3D1",e[e.OID_FRAME3D2=32103]="OID_FRAME3D2",e[e.OID_FRAME3D3=32104]="OID_FRAME3D3",e[e.OID_FRAME3D4=32105]="OID_FRAME3D4",e[e.OID_FRAME3D5=32106]="OID_FRAME3D5",e[e.OID_FRAME3D6=32107]="OID_FRAME3D6",e[e.OID_FRAME3D7=32108]="OID_FRAME3D7",e[e.OID_FRAME3D8=32109]="OID_FRAME3D8",e[e.OID_FRAME3D=32110]="OID_FRAME3D",e[e.MB_OK=0]="MB_OK",e[e.MB_OKCANCEL=1]="MB_OKCANCEL",e[e.MB_ABORTRETRYIGNORE=2]="MB_ABORTRETRYIGNORE",e[e.MB_YESNOCANCEL=3]="MB_YESNOCANCEL",e[e.MB_YESNO=4]="MB_YESNO",e[e.MB_RETRYCANCEL=5]="MB_RETRYCANCEL",e[e.MB_TYPEMASK=15]="MB_TYPEMASK",e[e.MB_ICONHAND=16]="MB_ICONHAND",e[e.MB_ICONQUESTION=32]="MB_ICONQUESTION",e[e.MB_ICONEXCLAMATION=48]="MB_ICONEXCLAMATION",e[e.MB_ICONASTERISK=64]="MB_ICONASTERISK",e[e.MB_ICONMASK=240]="MB_ICONMASK",e[e.MB_ICONINFORMATION=64]="MB_ICONINFORMATION",e[e.MB_ICONSTOP=16]="MB_ICONSTOP",e[e.MB_DEFBUTTON1=0]="MB_DEFBUTTON1",e[e.MB_DEFBUTTON2=256]="MB_DEFBUTTON2",e[e.MB_DEFBUTTON3=512]="MB_DEFBUTTON3",e[e.MB_DEFMASK=3840]="MB_DEFMASK",e[e.MB_APPLMODAL=0]="MB_APPLMODAL",e[e.MB_SYSTEMMODAL=4096]="MB_SYSTEMMODAL",e[e.MB_TASKMODAL=8192]="MB_TASKMODAL",e[e.MB_NOFOCUS=32768]="MB_NOFOCUS",e[e.SW_HIDE=0]="SW_HIDE",e[e.SW_SHOWNORMAL=1]="SW_SHOWNORMAL",e[e.SW_NORMAL=1]="SW_NORMAL",e[e.SW_SHOWMINIMIZED=2]="SW_SHOWMINIMIZED",e[e.SW_SHOWMAXIMIZED=3]="SW_SHOWMAXIMIZED",e[e.SW_MAXIMIZE=3]="SW_MAXIMIZE",e[e.SW_SHOWNOACTIVATE=4]="SW_SHOWNOACTIVATE",e[e.SW_SHOW=5]="SW_SHOW",e[e.SW_MINIMIZE=6]="SW_MINIMIZE",e[e.SW_SHOWMINNOACTIVE=7]="SW_SHOWMINNOACTIVE",e[e.SW_SHOWNA=8]="SW_SHOWNA",e[e.SW_RESTORE=9]="SW_RESTORE",e[e.MCIERR_INVALID_DEVICE_ID=257]="MCIERR_INVALID_DEVICE_ID",e[e.MCIERR_UNRECOGNIZED_KEYWORD=259]="MCIERR_UNRECOGNIZED_KEYWORD",e[e.MCIERR_UNRECOGNIZED_COMMAND=261]="MCIERR_UNRECOGNIZED_COMMAND",e[e.MCIERR_HARDWARE=262]="MCIERR_HARDWARE",e[e.MCIERR_INVALID_DEVICE_NAME=263]="MCIERR_INVALID_DEVICE_NAME",e[e.MCIERR_OUT_OF_MEMORY=264]="MCIERR_OUT_OF_MEMORY",e[e.MCIERR_DEVICE_OPEN=265]="MCIERR_DEVICE_OPEN",e[e.MCIERR_CANNOT_LOAD_DRIVER=266]="MCIERR_CANNOT_LOAD_DRIVER",e[e.MCIERR_MISSING_COMMAND_STRING=267]="MCIERR_MISSING_COMMAND_STRING",e[e.MCIERR_PARAM_OVERFLOW=268]="MCIERR_PARAM_OVERFLOW",e[e.MCIERR_MISSING_STRING_ARGUMENT=269]="MCIERR_MISSING_STRING_ARGUMENT",e[e.MCIERR_BAD_INTEGER=270]="MCIERR_BAD_INTEGER",e[e.MCIERR_PARSER_INTERNAL=271]="MCIERR_PARSER_INTERNAL",e[e.MCIERR_DRIVER_INTERNAL=272]="MCIERR_DRIVER_INTERNAL",e[e.MCIERR_MISSING_PARAMETER=273]="MCIERR_MISSING_PARAMETER",e[e.MCIERR_UNSUPPORTED_FUNCTION=274]="MCIERR_UNSUPPORTED_FUNCTION",e[e.MCIERR_FILE_NOT_FOUND=275]="MCIERR_FILE_NOT_FOUND",e[e.MCIERR_DEVICE_NOT_READY=276]="MCIERR_DEVICE_NOT_READY",e[e.MCIERR_INTERNAL=277]="MCIERR_INTERNAL",e[e.MCIERR_DRIVER=278]="MCIERR_DRIVER",e[e.MCIERR_CANNOT_USE_ALL=279]="MCIERR_CANNOT_USE_ALL",e[e.MCIERR_MULTIPLE=280]="MCIERR_MULTIPLE",e[e.MCIERR_EXTENSION_NOT_FOUND=281]="MCIERR_EXTENSION_NOT_FOUND",e[e.MCIERR_OUTOFRANGE=282]="MCIERR_OUTOFRANGE",e[e.MCIERR_FLAGS_NOT_COMPATIBLE=284]="MCIERR_FLAGS_NOT_COMPATIBLE",e[e.MCIERR_FILE_NOT_SAVED=286]="MCIERR_FILE_NOT_SAVED",e[e.MCIERR_DEVICE_TYPE_REQUIRED=287]="MCIERR_DEVICE_TYPE_REQUIRED",e[e.MCIERR_DEVICE_LOCKED=288]="MCIERR_DEVICE_LOCKED",e[e.MCIERR_DUPLICATE_ALIAS=289]="MCIERR_DUPLICATE_ALIAS",e[e.MCIERR_BAD_CONSTANT=290]="MCIERR_BAD_CONSTANT",e[e.MCIERR_MUST_USE_SHAREABLE=291]="MCIERR_MUST_USE_SHAREABLE",e[e.MCIERR_MISSING_DEVICE_NAME=292]="MCIERR_MISSING_DEVICE_NAME",e[e.MCIERR_BAD_TIME_FORMAT=293]="MCIERR_BAD_TIME_FORMAT",e[e.MCIERR_NO_CLOSING_QUOTE=294]="MCIERR_NO_CLOSING_QUOTE",e[e.MCIERR_DUPLICATE_FLAGS=295]="MCIERR_DUPLICATE_FLAGS",e[e.MCIERR_INVALID_FILE=296]="MCIERR_INVALID_FILE",e[e.MCIERR_NULL_PARAMETER_BLOCK=297]="MCIERR_NULL_PARAMETER_BLOCK",e[e.MCIERR_UNNAMED_RESOURCE=298]="MCIERR_UNNAMED_RESOURCE",e[e.MCIERR_NEW_REQUIRES_ALIAS=299]="MCIERR_NEW_REQUIRES_ALIAS",e[e.MCIERR_NOTIFY_ON_AUTO_OPEN=300]="MCIERR_NOTIFY_ON_AUTO_OPEN",e[e.MCIERR_NO_ELEMENT_ALLOWED=301]="MCIERR_NO_ELEMENT_ALLOWED",e[e.MCIERR_NONAPPLICABLE_FUNCTION=302]="MCIERR_NONAPPLICABLE_FUNCTION",e[e.MCIERR_ILLEGAL_FOR_AUTO_OPEN=303]="MCIERR_ILLEGAL_FOR_AUTO_OPEN",e[e.MCIERR_FILENAME_REQUIRED=304]="MCIERR_FILENAME_REQUIRED",e[e.MCIERR_EXTRA_CHARACTERS=305]="MCIERR_EXTRA_CHARACTERS",e[e.MCIERR_DEVICE_NOT_INSTALLED=306]="MCIERR_DEVICE_NOT_INSTALLED",e[e.MCIERR_GET_CD=307]="MCIERR_GET_CD",e[e.MCIERR_SET_CD=308]="MCIERR_SET_CD",e[e.MCIERR_SET_DRIVE=309]="MCIERR_SET_DRIVE",e[e.MCIERR_DEVICE_LENGTH=310]="MCIERR_DEVICE_LENGTH",e[e.MCIERR_DEVICE_ORD_LENGTH=311]="MCIERR_DEVICE_ORD_LENGTH",e[e.MCIERR_NO_INTEGER=312]="MCIERR_NO_INTEGER",e[e.MCIERR_WAVE_OUTPUTSINUSE=320]="MCIERR_WAVE_OUTPUTSINUSE",e[e.MCIERR_WAVE_SETOUTPUTINUSE=321]="MCIERR_WAVE_SETOUTPUTINUSE",e[e.MCIERR_WAVE_INPUTSINUSE=322]="MCIERR_WAVE_INPUTSINUSE",e[e.MCIERR_WAVE_SETINPUTINUSE=323]="MCIERR_WAVE_SETINPUTINUSE",e[e.MCIERR_WAVE_OUTPUTUNSPECIFIED=324]="MCIERR_WAVE_OUTPUTUNSPECIFIED",e[e.MCIERR_WAVE_INPUTUNSPECIFIED=325]="MCIERR_WAVE_INPUTUNSPECIFIED",e[e.MCIERR_WAVE_OUTPUTSUNSUITABLE=326]="MCIERR_WAVE_OUTPUTSUNSUITABLE",e[e.MCIERR_WAVE_SETOUTPUTUNSUITABLE=327]="MCIERR_WAVE_SETOUTPUTUNSUITABLE",e[e.MCIERR_WAVE_INPUTSUNSUITABLE=328]="MCIERR_WAVE_INPUTSUNSUITABLE",e[e.MCIERR_WAVE_SETINPUTUNSUITABLE=329]="MCIERR_WAVE_SETINPUTUNSUITABLE",e[e.MCIERR_SEQ_DIV_INCOMPATIBLE=336]="MCIERR_SEQ_DIV_INCOMPATIBLE",e[e.MCIERR_SEQ_PORT_INUSE=337]="MCIERR_SEQ_PORT_INUSE",e[e.MCIERR_SEQ_PORT_NONEXISTENT=338]="MCIERR_SEQ_PORT_NONEXISTENT",e[e.MCIERR_SEQ_PORT_MAPNODEVICE=339]="MCIERR_SEQ_PORT_MAPNODEVICE",e[e.MCIERR_SEQ_PORT_MISCERROR=340]="MCIERR_SEQ_PORT_MISCERROR",e[e.MCIERR_SEQ_TIMER=341]="MCIERR_SEQ_TIMER",e[e.MCIERR_SEQ_PORTUNSPECIFIED=342]="MCIERR_SEQ_PORTUNSPECIFIED",e[e.MCIERR_SEQ_NOMIDIPRESENT=343]="MCIERR_SEQ_NOMIDIPRESENT",e[e.MCIERR_NO_WINDOW=346]="MCIERR_NO_WINDOW",e[e.MCIERR_CREATEWINDOW=347]="MCIERR_CREATEWINDOW",e[e.MCIERR_FILE_READ=348]="MCIERR_FILE_READ",e[e.MCIERR_FILE_WRITE=349]="MCIERR_FILE_WRITE",e[e.WS_VISIBLE=268435456]="WS_VISIBLE",e[e.WS_DISABLED=134217728]="WS_DISABLED",e[e.WS_CAPTION=12582912]="WS_CAPTION",e[e.WS_BORDER=8388608]="WS_BORDER",e[e.WS_DLGFRAME=4194304]="WS_DLGFRAME",e[e.WS_VSCROLL=2097152]="WS_VSCROLL",e[e.WS_HSCROLL=1048576]="WS_HSCROLL",e[e.WS_SYSMENU=524288]="WS_SYSMENU",e[e.WS_THICKFRAME=262144]="WS_THICKFRAME",e[e.WS_MINIMIZEBOX=131072]="WS_MINIMIZEBOX",e[e.WS_MAXIMIZEBOX=65536]="WS_MAXIMIZEBOX",e[e.WS_GROUP=131072]="WS_GROUP",e[e.WS_TABSTOP=65536]="WS_TABSTOP",e[e.WS_OVERLAPPED=0]="WS_OVERLAPPED",e[e.WS_POPUP=2147483648]="WS_POPUP",e[e.WS_CHILD=1073741824]="WS_CHILD",e[e.IDX_PRIMARY=1]="IDX_PRIMARY",e[e.IDX_UNIQUE=2]="IDX_UNIQUE",e[e.IDX_DESCENDING=4]="IDX_DESCENDING",e[e.IDX_MAINTAINED=8]="IDX_MAINTAINED",e[e.IDX_SUBSET=16]="IDX_SUBSET",e[e.IDX_EXPR=32]="IDX_EXPR",e[e.IDX_IDXOOD=64]="IDX_IDXOOD",e[e.IDX_CASEINSENS=128]="IDX_CASEINSENS",e[e.FLDDBCHAR=513]="FLDDBCHAR",e[e.FLDDBNUM=514]="FLDDBNUM",e[e.FLDDBMEMO=515]="FLDDBMEMO",e[e.FLDDBBOOL=516]="FLDDBBOOL",e[e.FLDDBDATE=517]="FLDDBDATE",e[e.FLDDBFLOAT=518]="FLDDBFLOAT",e[e.FLDDBLOCK=519]="FLDDBLOCK",e[e.FLDDBOLEBLOB=520]="FLDDBOLEBLOB",e[e.FLDDBBINARY=521]="FLDDBBINARY",e[e.FLDDBBYTES=522]="FLDDBBYTES",e[e.BS_PUSHBUTTON=0]="BS_PUSHBUTTON",e[e.BS_DEFPUSHBUTTON=1]="BS_DEFPUSHBUTTON",e[e.BS_CHECKBOX=2]="BS_CHECKBOX",e[e.BS_AUTOCHECKBOX=3]="BS_AUTOCHECKBOX",e[e.BS_RADIOBUTTON=4]="BS_RADIOBUTTON",e[e.BS_3STATE=5]="BS_3STATE",e[e.BS_AUTO3STATE=6]="BS_AUTO3STATE",e[e.BS_GROUPBOX=7]="BS_GROUPBOX",e[e.BS_USERBUTTON=8]="BS_USERBUTTON",e[e.BS_AUTORADIOBUTTON=9]="BS_AUTORADIOBUTTON",e[e.BS_OWNERDRAW=11]="BS_OWNERDRAW",e[e.BS_LEFTTEXT=32]="BS_LEFTTEXT",e[e.ES_LEFT=0]="ES_LEFT",e[e.ES_CENTER=1]="ES_CENTER",e[e.ES_RIGHT=2]="ES_RIGHT",e[e.ES_MULTILINE=4]="ES_MULTILINE",e[e.ES_UPPERCASE=8]="ES_UPPERCASE",e[e.ES_LOWERCASE=16]="ES_LOWERCASE",e[e.ES_PASSWORD=32]="ES_PASSWORD",e[e.ES_AUTOVSCROLL=64]="ES_AUTOVSCROLL",e[e.ES_AUTOHSCROLL=128]="ES_AUTOHSCROLL",e[e.ES_NOHIDESEL=256]="ES_NOHIDESEL",e[e.SBS_HORZ=0]="SBS_HORZ",e[e.SBS_VERT=1]="SBS_VERT",e[e.SBS_TOPALIGN=2]="SBS_TOPALIGN",e[e.SBS_LEFTALIGN=2]="SBS_LEFTALIGN",e[e.SBS_BOTTOMALIGN=4]="SBS_BOTTOMALIGN",e[e.SBS_RIGHTALIGN=4]="SBS_RIGHTALIGN",e[e.SBS_SIZEBOXTOPLEFTALIGN=2]="SBS_SIZEBOXTOPLEFTALIGN",e[e.SBS_SIZEBOXBOTTOMRIGHTALIGN=4]="SBS_SIZEBOXBOTTOMRIGHTALIGN",e[e.SBS_SIZEBOX=8]="SBS_SIZEBOX",e[e.LBS_NOTIFY=1]="LBS_NOTIFY",e[e.LBS_SORT=2]="LBS_SORT",e[e.LBS_NOREDRAW=4]="LBS_NOREDRAW",e[e.LBS_MULTIPLESEL=8]="LBS_MULTIPLESEL",e[e.LBS_OWNERDRAWFIXED=16]="LBS_OWNERDRAWFIXED",e[e.LBS_OWNERDRAWVARIABLE=32]="LBS_OWNERDRAWVARIABLE",e[e.LBS_HASSTRINGS=64]="LBS_HASSTRINGS",e[e.LBS_USETABSTOPS=128]="LBS_USETABSTOPS",e[e.LBS_NOINTEGRALHEIGHT=256]="LBS_NOINTEGRALHEIGHT",e[e.LBS_MULTICOLUMN=512]="LBS_MULTICOLUMN",e[e.LBS_WANTKEYBOARDINPUT=1024]="LBS_WANTKEYBOARDINPUT",e[e.LBS_EXTENDEDSEL=2048]="LBS_EXTENDEDSEL",e[e.CBS_SIMPLE=1]="CBS_SIMPLE",e[e.CBS_DROPDOWN=2]="CBS_DROPDOWN",e[e.CBS_DROPDOWNLIST=3]="CBS_DROPDOWNLIST",e[e.CBS_OWNERDRAWFIXED=16]="CBS_OWNERDRAWFIXED",e[e.CBS_OWNERDRAWVARIABLE=32]="CBS_OWNERDRAWVARIABLE",e[e.CBS_AUTOHSCROLL=64]="CBS_AUTOHSCROLL",e[e.CBS_OEMCONVERT=128]="CBS_OEMCONVERT",e[e.CBS_SORT=256]="CBS_SORT",e[e.CBS_HASSTRINGS=512]="CBS_HASSTRINGS",e[e.CBS_NOINTEGRALHEIGHT=1024]="CBS_NOINTEGRALHEIGHT",e[e.BS_SOLID=0]="BS_SOLID",e[e.BS_NULL=1]="BS_NULL",e[e.BS_HATCHED=2]="BS_HATCHED",e[e.BS_PATTERN=3]="BS_PATTERN",e[e.BS_GRADIENT_LINEAR=10]="BS_GRADIENT_LINEAR",e[e.HS_HORIZONTAL=0]="HS_HORIZONTAL",e[e.HS_VERTICAL=1]="HS_VERTICAL",e[e.HS_FDIAGONAL=2]="HS_FDIAGONAL",e[e.HS_BDIAGONAL=3]="HS_BDIAGONAL",e[e.HS_CROSS=4]="HS_CROSS",e[e.HS_DIAGCROSS=5]="HS_DIAGCROSS",e[e.PS_SOLID=0]="PS_SOLID",e[e.PS_DASH=1]="PS_DASH",e[e.PS_DOT=2]="PS_DOT",e[e.PS_DASHDOT=3]="PS_DASHDOT",e[e.PS_DASHDOTDOT=4]="PS_DASHDOTDOT",e[e.PS_NULL=5]="PS_NULL",e[e.PS_INSIDEFRAME=6]="PS_INSIDEFRAME",e[e.R2_BLACK=1]="R2_BLACK",e[e.R2_NOTMERGEPEN=2]="R2_NOTMERGEPEN",e[e.R2_MASKNOTPEN=3]="R2_MASKNOTPEN",e[e.R2_NOTCOPYPEN=4]="R2_NOTCOPYPEN",e[e.R2_MASKPENNOT=5]="R2_MASKPENNOT",e[e.R2_NOT=6]="R2_NOT",e[e.R2_XORPEN=7]="R2_XORPEN",e[e.R2_NOTMASKPEN=8]="R2_NOTMASKPEN",e[e.R2_MASKPEN=9]="R2_MASKPEN",e[e.R2_NOTXORPEN=10]="R2_NOTXORPEN",e[e.R2_NOP=11]="R2_NOP",e[e.R2_MERGENOTPEN=12]="R2_MERGENOTPEN",e[e.R2_COPYPEN=13]="R2_COPYPEN",e[e.R2_MERGEPENNOT=14]="R2_MERGEPENNOT",e[e.R2_MERGEPEN=15]="R2_MERGEPEN",e[e.R2_WHITE=16]="R2_WHITE",e[e.FILE_ATTRIBUTE_ARCHIVE=32]="FILE_ATTRIBUTE_ARCHIVE",e[e.FILE_ATTRIBUTE_COMPRESSED=2048]="FILE_ATTRIBUTE_COMPRESSED",e[e.FILE_ATTRIBUTE_DIRECTORY=16]="FILE_ATTRIBUTE_DIRECTORY",e[e.FILE_ATTRIBUTE_HIDDEN=2]="FILE_ATTRIBUTE_HIDDEN",e[e.FILE_ATTRIBUTE_NORMAL=128]="FILE_ATTRIBUTE_NORMAL",e[e.FILE_ATTRIBUTE_OFFLINE=4096]="FILE_ATTRIBUTE_OFFLINE",e[e.FILE_ATTRIBUTE_READONLY=1]="FILE_ATTRIBUTE_READONLY",e[e.FILE_ATTRIBUTE_SYSTEM=4]="FILE_ATTRIBUTE_SYSTEM",e[e.FILE_ATTRIBUTE_TEMPORARY=256]="FILE_ATTRIBUTE_TEMPORARY",e[e.VF_LOCAL=2]="VF_LOCAL",e[e.VF_EQVAR=256]="VF_EQVAR",e[e.VF_ARGUMENT=512]="VF_ARGUMENT",e[e.VF_RETURN=1024]="VF_RETURN",e[e.CUR_ARROW=0]="CUR_ARROW",e[e.CUR_CROSS=1]="CUR_CROSS",e[e.CUR_TEXT=2]="CUR_TEXT",e[e.CUR_NO=3]="CUR_NO",e[e.CUR_SIZE=4]="CUR_SIZE",e[e.CUR_SIZENESW=5]="CUR_SIZENESW",e[e.CUR_SIZENS=6]="CUR_SIZENS",e[e.CUR_SIZENWSE=7]="CUR_SIZENWSE",e[e.CUR_SIZEWE=8]="CUR_SIZEWE",e[e.CUR_UPARROW=9]="CUR_UPARROW",e[e.CUR_WAIT=10]="CUR_WAIT",e[e.CUR_LINK=11]="CUR_LINK",e[e.CUR_HELP=12]="CUR_HELP",e[e.SHADOWTYPE_STENCIL_MODULATIVE=18]="SHADOWTYPE_STENCIL_MODULATIVE",e[e.SHADOWTYPE_STENCIL_ADDITIVE=17]="SHADOWTYPE_STENCIL_ADDITIVE",e[e.SHADOWTYPE_TEXTURE_MODULATIVE=34]="SHADOWTYPE_TEXTURE_MODULATIVE",e[e.SHADOWTYPE_TEXTURE_ADDITIVE=33]="SHADOWTYPE_TEXTURE_ADDITIVE",e[e.FOG_NONE=0]="FOG_NONE",e[e.FOG_EXP=1]="FOG_EXP",e[e.FOG_EXP2=2]="FOG_EXP2",e[e.FOG_LINEAR=3]="FOG_LINEAR",e[e.TEX_TYPE_1D=1]="TEX_TYPE_1D",e[e.TEX_TYPE_2D=2]="TEX_TYPE_2D",e[e.TEX_TYPE_3D=3]="TEX_TYPE_3D",e[e.TEX_TYPE_CUBE_MAP=4]="TEX_TYPE_CUBE_MAP",e[e.SBF_ONE=0]="SBF_ONE",e[e.SBF_ZERO=1]="SBF_ZERO",e[e.SBF_DEST_COLOUR=2]="SBF_DEST_COLOUR",e[e.SBF_SOURCE_COLOUR=3]="SBF_SOURCE_COLOUR",e[e.SBF_ONE_MINUS_DEST_COLOUR=4]="SBF_ONE_MINUS_DEST_COLOUR",e[e.SBF_ONE_MINUS_SOURCE_COLOUR=5]="SBF_ONE_MINUS_SOURCE_COLOUR",e[e.SBF_DEST_ALPHA=6]="SBF_DEST_ALPHA",e[e.SBF_SOURCE_ALPHA=7]="SBF_SOURCE_ALPHA",e[e.SBF_ONE_MINUS_DEST_ALPHA=8]="SBF_ONE_MINUS_DEST_ALPHA",e[e.SBF_ONE_MINUS_SOURCE_ALPHA=9]="SBF_ONE_MINUS_SOURCE_ALPHA",e[e.CMPF_ALWAYS_FAIL=0]="CMPF_ALWAYS_FAIL",e[e.CMPF_ALWAYS_PASS=1]="CMPF_ALWAYS_PASS",e[e.CMPF_LESS=2]="CMPF_LESS",e[e.CMPF_LESS_EQUAL=3]="CMPF_LESS_EQUAL",e[e.CMPF_EQUAL=4]="CMPF_EQUAL",e[e.CMPF_NOT_EQUAL=5]="CMPF_NOT_EQUAL",e[e.CMPF_GREATER_EQUAL=6]="CMPF_GREATER_EQUAL",e[e.CMPF_GREATER=7]="CMPF_GREATER",e[e.CULL_NONE=1]="CULL_NONE",e[e.CULL_CLOCKWISE=2]="CULL_CLOCKWISE",e[e.CULL_ANTICLOCKWISE=3]="CULL_ANTICLOCKWISE",e[e.SO_FLAT=0]="SO_FLAT",e[e.SO_GOURAUD=1]="SO_GOURAUD",e[e.SO_PHONG=2]="SO_PHONG",e[e.PM_POINTS=1]="PM_POINTS",e[e.PM_WIREFRAME=2]="PM_WIREFRAME",e[e.PM_SOLID=3]="PM_SOLID",e[e.LT_POINT=0]="LT_POINT",e[e.LT_DIRECTIONAL=1]="LT_DIRECTIONAL",e[e.LT_SPOTLIGHT=2]="LT_SPOTLIGHT",e[e.PT_ORTHOGRAPHIC=0]="PT_ORTHOGRAPHIC",e[e.PT_PERSPECTIVE=1]="PT_PERSPECTIVE",e[e.OT_POINT_LIST=1]="OT_POINT_LIST",e[e.OT_LINE_LIST=2]="OT_LINE_LIST",e[e.OT_LINE_STRIP=3]="OT_LINE_STRIP",e[e.OT_TRIANGLE_LIST=4]="OT_TRIANGLE_LIST",e[e.OT_TRIANGLE_STRIP=5]="OT_TRIANGLE_STRIP",e[e.OT_TRIANGLE_FAN=6]="OT_TRIANGLE_FAN",e[e.BBT_POINT=0]="BBT_POINT",e[e.BBT_ORIENTED_COMMON=1]="BBT_ORIENTED_COMMON",e[e.BBT_ORIENTED_SELF=2]="BBT_ORIENTED_SELF",e[e.BBT_PERPENDICULAR_COMMON=3]="BBT_PERPENDICULAR_COMMON",e[e.BBT_PERPENDICULAR_SELF=4]="BBT_PERPENDICULAR_SELF",e[e.GMM_RELATIVE=0]="GMM_RELATIVE",e[e.GMM_PIXELS=1]="GMM_PIXELS",e[e.GMM_RELATIVE_ASPECT_ADJUSTED=2]="GMM_RELATIVE_ASPECT_ADJUSTED",e[e.GHA_LEFT=0]="GHA_LEFT",e[e.GHA_CENTER=1]="GHA_CENTER",e[e.GHA_RIGHT=2]="GHA_RIGHT",e[e.GVA_TOP=0]="GVA_TOP",e[e.GVA_CENTER=1]="GVA_CENTER",e[e.GVA_BOTTOM=2]="GVA_BOTTOM",e[e.MTHA_LEFT=0]="MTHA_LEFT",e[e.MTHA_CENTER=1]="MTHA_CENTER",e[e.MTVA_BELOW=0]="MTVA_BELOW",e[e.MTVA_ABOVE=1]="MTVA_ABOVE",e[e.MTVA_CENTER=2]="MTVA_CENTER",e[e.PT_BOOL=0]="PT_BOOL",e[e.PT_REAL=1]="PT_REAL",e[e.PT_INT=2]="PT_INT",e[e.PT_UNSIGNED_INT=3]="PT_UNSIGNED_INT",e[e.PT_SHORT=4]="PT_SHORT",e[e.PT_UNSIGNED_SHORT=5]="PT_UNSIGNED_SHORT",e[e.PT_LONG=6]="PT_LONG",e[e.PT_UNSIGNED_LONG=7]="PT_UNSIGNED_LONG",e[e.PT_STRING=8]="PT_STRING",e[e.PT_VECTOR3=9]="PT_VECTOR3",e[e.PT_MATRIX3=10]="PT_MATRIX3",e[e.PT_MATRIX4=11]="PT_MATRIX4",e[e.PT_QUATERNION=12]="PT_QUATERNION",e[e.PT_COLOURVALUE=13]="PT_COLOURVALUE",e[e.NUI_SP_HIP_CENTER=0]="NUI_SP_HIP_CENTER",e[e.NUI_SP_SPINE=1]="NUI_SP_SPINE",e[e.NUI_SP_SHOULDER_CENTER=2]="NUI_SP_SHOULDER_CENTER",e[e.NUI_SP_HEAD=3]="NUI_SP_HEAD",e[e.NUI_SP_SHOULDER_LEFT=4]="NUI_SP_SHOULDER_LEFT",e[e.NUI_SP_ELBOW_LEFT=5]="NUI_SP_ELBOW_LEFT",e[e.NUI_SP_WRIST_LEFT=6]="NUI_SP_WRIST_LEFT",e[e.NUI_SP_HAND_LEFT=7]="NUI_SP_HAND_LEFT",e[e.NUI_SP_SHOULDER_RIGHT=8]="NUI_SP_SHOULDER_RIGHT",e[e.NUI_SP_ELBOW_RIGHT=9]="NUI_SP_ELBOW_RIGHT",e[e.NUI_SP_WRIST_RIGHT=10]="NUI_SP_WRIST_RIGHT",e[e.NUI_SP_HAND_RIGHT=11]="NUI_SP_HAND_RIGHT",e[e.NUI_SP_HIP_LEFT=12]="NUI_SP_HIP_LEFT",e[e.NUI_SP_KNEE_LEFT=13]="NUI_SP_KNEE_LEFT",e[e.NUI_SP_ANKLE_LEFT=14]="NUI_SP_ANKLE_LEFT",e[e.NUI_SP_FOOT_LEFT=15]="NUI_SP_FOOT_LEFT",e[e.NUI_SP_HIP_RIGHT=16]="NUI_SP_HIP_RIGHT",e[e.NUI_SP_KNEE_RIGHT=17]="NUI_SP_KNEE_RIGHT",e[e.NUI_SP_ANKLE_RIGHT=18]="NUI_SP_ANKLE_RIGHT",e[e.NUI_SP_FOOT_RIGHT=19]="NUI_SP_FOOT_RIGHT",e[e.NUI_SP_COUNT=20]="NUI_SP_COUNT",e[e.WM_DESTROY=2]="WM_DESTROY",e[e.WM_MOVE=3]="WM_MOVE",e[e.WM_SIZE=5]="WM_SIZE",e[e.WM_CLOSE=16]="WM_CLOSE",e[e.WM_GETMINMAXINFO=36]="WM_GETMINMAXINFO",e[e.WM_COMMAND=273]="WM_COMMAND",e[e.WM_MOUSEMOVE=512]="WM_MOUSEMOVE",e[e.WM_LBUTTONDOWN=513]="WM_LBUTTONDOWN",e[e.WM_LBUTTONUP=514]="WM_LBUTTONUP",e[e.WM_LBUTTONDBLCLK=515]="WM_LBUTTONDBLCLK",e[e.WM_RBUTTONDOWN=516]="WM_RBUTTONDOWN",e[e.WM_RBUTTONUP=517]="WM_RBUTTONUP",e[e.WM_RBUTTONDBLCLK=518]="WM_RBUTTONDBLCLK",e[e.WM_MBUTTONDOWN=519]="WM_MBUTTONDOWN",e[e.WM_MBUTTONUP=520]="WM_MBUTTONUP",e[e.WM_MBUTTONDBLCLK=521]="WM_MBUTTONDBLCLK",e[e.WM_ALLMOUSEMESSAGE=1536]="WM_ALLMOUSEMESSAGE",e[e.WM_ALLKEYMESSAGE=1537]="WM_ALLKEYMESSAGE",e[e.WM_KEYDOWN=256]="WM_KEYDOWN",e[e.WM_KEYUP=257]="WM_KEYUP",e[e.WM_CANCLOSE=1538]="WM_CANCLOSE",e[e.WM_SPACEDONE=1539]="WM_SPACEDONE",e[e.WM_SPACEINIT=1540]="WM_SPACEINIT",e[e.WM_CONTROLNOTIFY=1544]="WM_CONTROLNOTIFY",e[e.WM_HYPERJUMP=1546]="WM_HYPERJUMP"})(A||(A={}));const hu=nr(Rr());var k;(function(e){e[e.Float=1]="Float",e[e.Handle=2]="Handle",e[e.String=3]="String",e[e.ColorRef=4]="ColorRef"})(k||(k={}));class cs{constructor(e,t){this.x=0;this.y=0;this.width=0;this.height=0;this.hidden=!1;const r=this.elem=document.createElement("input");r.setAttribute("type","text"),r.setAttribute("class","stratum-textbox"),r.style.setProperty("position","absolute"),this.setOrigin(t.x,t.y),this.setSize(t.width,t.height),this.setText(t.text),this.setHidden(t.hidden),e.appendChild(r)}setOrigin(e,t){this.elem.style.setProperty("left",e+"px"),this.elem.style.setProperty("top",t+"px")}setSize(e,t){this.elem.style.setProperty("width",e+"px"),this.elem.style.setProperty("height",t+"px")}setHidden(e){this.elem.hidden=e}text(){return this.elem.value}setText(e){this.elem.value=e}destroy(){this.elem.remove()}onEdit(e){this.elem.addEventListener("input",e)}offEdit(e){this.elem.removeEventListener("input",e)}}class J extends Map{static create(e){return new Map(e)}static getFreeHandle(e,t){let r=t||0;for(;e.has(++r););return r}}class Ei{constructor(e,{handle:t,name:r,options:i,hidden:s,originX:n,originY:o,type:l,dibHandle:c,width:u,height:f,cropX:S,cropY:g,cropW:b,cropH:T}){this.type="bitmap";this.scene=e,this.handle=t,this.name=r||"",this.markDeleted=!1,e.dirty=!0,this.isDouble=l!=="otBITMAP2D";const O=(this.isDouble?e.doubleDibs:e.dibs).get(c);O==null||O.subscribe(this),this.dib=O||null,this._originX=n,this._originY=o;const I=(O==null?void 0:O.width())||0,v=(O==null?void 0:O.height())||0;this._width=s?1:u||I,this._height=s?1:f||v,this.hardHidden=!!s,this.cropX=S||0,this.cropY=g||0,this.cropW=b||I,this.cropH=T||v;const N=i||0;this._visible=1,this._selectable=N&8?0:1;const $=N>>8&31;this._layer=1<<$,this._parent=null}toolChanged(){this.scene.dirty=!0}parentHandle(){var e;return((e=this._parent)==null?void 0:e.handle)||0}originX(){return this._originX}originY(){return this._originY}setOrigin(e,t){var r;return this._originX=e,this._originY=t,(r=this._parent)==null||r.updateBorders(),this.scene.dirty=!0,1}width(){return this._width}actualWidth(){return this._width}height(){return this._height}actualHeight(){return this._height}setSize(e,t){var s;if(e<0||t<0)return 0;const r=this._width,i=this._height;return r===0||i===0||(this.onParentResized(this._originX,this._originY,e/r,t/i),(s=this._parent)==null||s.updateBorders()),1}angle(){return 0}rotate(e,t,r){var i;return r===0||(this.onParentRotated(e,t,r),(i=this._parent)==null||i.updateBorders()),1}setShow(e){return this._visible=e,this.scene.dirty=!0,1}setBitmapRect(e,t,r,i){return e<0||t<0||r<0||i<0?0:(this.cropX=e,this.cropY=t,this.cropW=r,this.cropH=i,this.scene.dirty=!0,1)}dibHandle(){return!this.isDouble&&this.dib?this.dib.handle:0}doubleDIBHandle(){return this.isDouble&&this.dib?this.dib.handle:0}delete(){var e,t;(e=this.dib)==null||e.unsubscribe(this),(t=this._parent)==null||t.removeChild(this),this.markDeleted=!0,this.scene.dirty=!0}getChildByName(e){return this.name===e?this.handle:0}minX(){return this._originX}minY(){return this._originY}maxX(){return this._originX+this._width}maxY(){return this._originY+this._height}onParentChanged(e){var t;if(e===this._parent)return;(t=this._parent)==null||t.removeChild(this),this._parent=e}onParentMoved(e,t){this._originX+=e,this._originY+=t,this.scene.dirty=!0}onParentResized(e,t,r,i){this._originX=e+(this._originX-e)*r,this._originY=t+(this._originY-t)*i,this._width*=r,this._height*=i,this.scene.dirty=!0}onParentRotated(e,t,r){const i=Math.sin(r),s=Math.cos(r),n=this._originX-e,o=this._originY-t,l=n*s-o*i,c=n*i+o*s;this._originX=l+e,this._originY=c+t,this.scene.dirty=!0}render(e,t,r,i){if(this.hardHidden||!this.dib||this._visible===0||(this._layer&i)!==0)return;const s=this._originX-t,n=this._originY-r;this.dib.render(e,this.cropX,this.cropY,this.cropW,this.cropH,s,n,this._width,this._height)}tryClick(e,t,r){if(this.hardHidden||!this.dib||this._visible===0||(this._layer&r)!==0||this._selectable===0)return;const i=e-this._originX,s=t-this._originY;if(i<0||s<0||i>this._width||s>this._height)return;const n=i*(this.cropW/this._width)+this.cropX,o=s*(this.cropH/this._height)+this.cropY;return this.dib.tryClick(n,o)?this._parent?this._parent.root():this:void 0}pointOriginX(){return 0}pointOriginY(){return 0}setPointOrigin(){return 0}addPoint(){return 0}pointCount(){return 0}penHandle(){return 0}brushHandle(){return 0}textToolHandle(){return 0}controlText(){return""}setControlText(){return 0}itemHandle(){return 0}deleteItem(){return 0}deletePoint(){return 0}addItem(){return 0}}class xi{constructor(e,t,{handle:r,options:i,name:s,originX:n,originY:o,width:l,height:c,className:u,text:f}){this.type="control";if(u!=="EDIT")throw Error(`\u042D\u043B\u0435\u043C\u0435\u043D\u0442 \u0432\u0432\u043E\u0434\u0430 ${u} \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D.`);this.handle=r,this.name=s||"",this.scene=e,this.markDeleted=!1,this._originX=n,this._originY=o,this._width=l,this._height=c;const S=i||0;this._visible=1,this._selectable=S&8?0:1;const g=S>>8&31;this._layer=1<<g,this._parent=null,e.dirty=!0,this.lastX=n-e.originX(),this.lastY=o-e.originY(),this.lastWidth=l,this.lastHeight=c,this.lastHidden=!this._visible,this.wrapper=t.textInput({x:this.lastX,y:this.lastY,width:l,height:c,text:f,hidden:this.lastHidden}),this.wrapper.onEdit(()=>e.dispatchControlNotifyEvent(this.handle,768))}parentHandle(){var e;return((e=this._parent)==null?void 0:e.handle)||0}originX(){return this._originX}originY(){return this._originY}setOrigin(e,t){var r;return this._originX=e,this._originY=t,(r=this._parent)==null||r.updateBorders(),this.scene.dirty=!0,1}width(){return this._width}actualWidth(){return this._width}height(){return this._height}actualHeight(){return this._height}setSize(e,t){var s;if(e<0||t<0)return 0;const r=this._width,i=this._height;return r===0||i===0||(this.onParentResized(this._originX,this._originY,e/r,t/i),(s=this._parent)==null||s.updateBorders()),1}angle(){return 0}rotate(e,t,r){var i;return r===0||(this.onParentRotated(e,t,r),(i=this._parent)==null||i.updateBorders()),1}setShow(e){return this._visible=e,this.scene.dirty=!0,1}controlText(){return this.wrapper.text()}setControlText(e){return this.wrapper.setText(e),1}delete(){var e;this.wrapper.destroy(),(e=this._parent)==null||e.removeChild(this),this.markDeleted=!0,this.scene.dirty=!0}getChildByName(e){return this.name===e?this.handle:0}minX(){return this._originX}minY(){return this._originY}maxX(){return this._originX+this._width}maxY(){return this._originY+this._height}onParentChanged(e){var t;if(e===this._parent)return;(t=this._parent)==null||t.removeChild(this),this._parent=e}onParentMoved(e,t){this._originX+=e,this._originY+=t,this.scene.dirty=!0}onParentResized(e,t,r,i){this._originX=e+(this._originX-e)*r,this._originY=t+(this._originY-t)*i,this._width*=r,this._height*=i,this.scene.dirty=!0}onParentRotated(e,t,r){const i=Math.sin(r),s=Math.cos(r),n=this._originX-e,o=this._originY-t,l=n*s-o*i,c=n*i+o*s;this._originX=l+e,this._originY=c+t,this.scene.dirty=!0}render(e,t,r,i){const s=this._visible===0||(this._layer&i)!==0;s!==this.lastHidden&&(this.lastHidden=s,this.wrapper.setHidden(s));const n=this._originX-t,o=this._originY-r;(n!==this.lastX||o!==this.lastY)&&(this.lastX=n,this.lastY=o,this.wrapper.setOrigin(n,o));const l=this._width,c=this._height;(l!==this.lastWidth||c!==this.lastHeight)&&(this.lastWidth=l,this.lastHeight=c,this.wrapper.setSize(l,c))}tryClick(e,t,r){if(this._visible===0||(this._layer&r)!==0||this._selectable===0)return;const i=e-this._originX,s=t-this._originY;return i<0||s<0||i>this._width||s>this._height?void 0:this._parent?this._parent.root():this}textToolHandle(){return 0}setBitmapRect(){return 0}itemHandle(){return 0}deleteItem(){return 0}pointOriginX(){return 0}pointOriginY(){return 0}setPointOrigin(){return 0}addPoint(){return 0}pointCount(){return 0}penHandle(){return 0}brushHandle(){return 0}deletePoint(){return 0}addItem(){return 0}dibHandle(){return 0}doubleDIBHandle(){return 0}}class kr{constructor(e,{handle:t,name:r}){this.type="group";this._minX=0;this._maxX=0;this._minY=0;this._maxY=0;this._parent=null;this.scene=e,this.handle=t,this.name=r||"",this.children=[],this.markDeleted=!1}addChildren(e){var t;return e.length===0?this:(this._minX=Infinity,this._maxX=-Infinity,this._minY=Infinity,this._maxY=-Infinity,e.forEach(r=>{const i=this.scene.objects.get(r);if(!i)return;this._minX=Math.min(this._minX,i.minX()),this._minY=Math.min(this._minY,i.minY()),this._maxX=Math.max(this._maxX,i.maxX()),this._maxY=Math.max(this._maxY,i.maxY()),i.onParentChanged(this),this.children.push(i)}),(t=this._parent)==null||t.updateBorders(),this)}root(){let e=this;for(;e._parent;)e=e._parent;return e}ungroup(){this.markDeleted=!0;for(const e of this.children.values())e.onParentChanged(null);this.onParentChanged(null)}removeChild(e){if(this.markDeleted)return;this.children=this.children.filter(t=>t.handle!==e.handle),this.children.length===0&&(this._minX=0,this._maxX=0,this._minY=0,this._maxY=0),this.updateBorders()}updateBorders(){var e;if(this.children.length===0)return;this._minX=Infinity,this._maxX=-Infinity,this._minY=Infinity,this._maxY=-Infinity;for(const t of this.children.values())this._minX=Math.min(this._minX,t.minX()),this._minY=Math.min(this._minY,t.minY()),this._maxX=Math.max(this._maxX,t.maxX()),this._maxY=Math.max(this._maxY,t.maxY());(e=this._parent)==null||e.updateBorders()}parentHandle(){var e;return((e=this._parent)==null?void 0:e.handle)||0}originX(){return this._minX}originY(){return this._minY}setOrigin(e,t){var r;return this.onParentMoved(e-this._minX,t-this._minY),(r=this._parent)==null||r.updateBorders(),1}width(){return this._maxX-this._minX}actualWidth(){return this._maxX-this._minX}height(){return this._maxY-this._minY}actualHeight(){return this._maxY-this._minY}setSize(e,t){var s;if(e<0||t<0)return 0;const r=this.width(),i=this.height();return r===0||i===0||(this.onParentResized(this._minX,this._minY,e/r,t/i),(s=this._parent)==null||s.updateBorders()),1}angle(){return 0}rotate(e,t,r){var i;return r===0||(this.onParentRotated(e,t,r),(i=this._parent)==null||i.updateBorders()),1}setShow(e){for(const t of this.children.values())t.setShow(e);return 1}itemHandle(e){return e<0||e>=this.children.length?0:this.children[e].handle}addItem(e){const t=this.scene.objects.get(e);return!t||this.children.some(r=>r.handle===e)?0:(t.onParentChanged(this),this.children.push(t),this.updateBorders(),1)}deleteItem(e){const t=this.children.find(r=>r.handle===e);return t?(t.onParentChanged(null),1):0}delete(){this.markDeleted=!0;for(const e of this.children.values())e.delete();this.onParentChanged(null)}getChildByName(e){if(this.name===e)return this.handle;for(const t of this.children.values()){const r=t.getChildByName(e);if(r!==0)return r}return 0}minX(){return this._minX}minY(){return this._minY}maxX(){return this._maxX}maxY(){return this._maxY}onParentChanged(e){var t;if(e===this._parent)return;{let r=e;for(;r;){if(r===this)return;r=r._parent}}(t=this._parent)==null||t.removeChild(this),this._parent=e}onParentMoved(e,t){if(this.children.length===0)return;for(const r of this.children.values())r.onParentMoved(e,t);this._minX+=e,this._minY+=t,this._maxX+=e,this._maxY+=t}onParentResized(e,t,r,i){if(this.children.length===0)return;this._minX=Infinity,this._maxX=-Infinity,this._minY=Infinity,this._maxY=-Infinity;for(const s of this.children.values())s.onParentResized(e,t,r,i),this._minX=Math.min(this._minX,s.minX()),this._minY=Math.min(this._minY,s.minY()),this._maxX=Math.max(this._maxX,s.maxX()),this._maxY=Math.max(this._maxY,s.maxY())}onParentRotated(e,t,r){if(this.children.length===0)return;this._minX=Infinity,this._maxX=-Infinity,this._minY=Infinity,this._maxY=-Infinity;for(const i of this.children.values())i.onParentRotated(e,t,r),this._minX=Math.min(this._minX,i.minX()),this._minY=Math.min(this._minY,i.minY()),this._maxX=Math.max(this._maxX,i.maxX()),this._maxY=Math.max(this._maxY,i.maxY())}addPoint(){return 0}deletePoint(){return 0}pointOriginY(){return 0}pointOriginX(){return 0}setPointOrigin(){return 0}penHandle(){return 0}brushHandle(){return 0}textToolHandle(){return 0}controlText(){return""}setControlText(){return 0}setBitmapRect(){return 0}dibHandle(){return 0}doubleDIBHandle(){return 0}}class Ii{constructor(e,{handle:t,name:r,options:i,coords:s,penHandle:n,brushHandle:o}){this.type="line";var T,O;if(s.length<2)throw Error("\u041B\u0438\u043D\u0438\u044F \u043D\u0435 \u0438\u043C\u0435\u0435\u0442 \u0442\u043E\u0447\u0435\u043A");this.scene=e,this.handle=t,this.name=r||"",this.cnv=document.createElement("canvas");const l=this.cnv.getContext("2d",{alpha:!0});if(!l)throw Error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442 \u0440\u0435\u043D\u0434\u0435\u0440\u0438\u043D\u0433\u0430");this.ctx2=l,this.markDeleted=!1,this.needRedraw=!0,e.dirty=!0;let c=s[0],u=s[1],f=c,S=u;for(let I=2;I<s.length;I+=2){const v=s[I+0],N=s[I+1];v<c&&(c=v),v>f&&(f=v),N<u&&(u=N),N>S&&(S=N)}this.coords=s.slice();for(let I=0;I<s.length;I+=2)this.coords[I+0]-=c,this.coords[I+1]-=u;this._originX=c,this._originY=u,this._width=f-c,this._height=S-u;const g=i||0;this._visible=1,this._selectable=g&8?0:1;const b=g>>8&31;this._layer=1<<b,this._parent=null,this.pen=e.pens.get(n)||null,this.brush=e.brushes.get(o)||null,(T=this.pen)==null||T.subscribe(this),(O=this.brush)==null||O.subscribe(this)}parentHandle(){var e;return((e=this._parent)==null?void 0:e.handle)||0}originX(){return this._originX}originY(){return this._originY}setOrigin(e,t){var r;return this._originX=e,this._originY=t,(r=this._parent)==null||r.updateBorders(),this.scene.dirty=!0,1}width(){return this._width}actualWidth(){return this._width}height(){return this._height}actualHeight(){return this._height}setSize(e,t){var s;if(e<0||t<0)return 0;const r=this._width,i=this._height;return r===0||i===0||(this.onParentResized(this._originX,this._originY,e/r,t/i),(s=this._parent)==null||s.updateBorders()),1}angle(){return 0}rotate(e,t,r){var i;return r===0||(this.onParentRotated(e,t,r),(i=this._parent)==null||i.updateBorders()),1}setShow(e){return this._visible=e,this.scene.dirty=!0,1}pointOriginX(e){const t=e*2;return t<0||t>=this.coords.length?0:this.coords[t+0]+this._originX}pointOriginY(e){const t=e*2;return t<0||t>=this.coords.length?0:this.coords[t+1]+this._originY}updateSize(){var s;let e=Infinity,t=-Infinity,r=Infinity,i=-Infinity;for(let n=0;n<this.coords.length;n+=2){const o=this.coords[n+0],l=this.coords[n+1];o<e&&(e=o),o>t&&(t=o),l<r&&(r=l),l>i&&(i=l)}if(e!==0||r!==0){for(let n=0;n<this.coords.length;n+=2)this.coords[n+0]-=e,this.coords[n+1]-=r;this._originX+=e,this._originY+=r}this._width=t-e,this._height=i-r,(s=this._parent)==null||s.updateBorders(),this.scene.dirty=!0,this.needRedraw=!0}setPointOrigin(e,t,r){const i=e*2;if(i<0||i>=this.coords.length)return 0;const s=t-this._originX,n=r-this._originY;return this.coords[i+0]=s,this.coords[i+1]=n,this.updateSize(),1}addPoint(e,t,r){if(Math.floor(e)===0)return 0;const i=t-this._originX,s=r-this._originY,n=e*2;return n<0||n>=this.coords.length?this.coords.push(i,s):this.coords.splice(n,0,i,s),this.updateSize(),1}deletePoint(e){const t=e*2;return e<1||t>this.coords.length?0:(this.coords.splice(t,2),this.updateSize(),1)}pointCount(){return this.coords.length/2}penHandle(){return this.pen?this.pen.handle:0}brushHandle(){return this.brush?this.brush.handle:0}delete(){var e,t,r;(e=this.pen)==null||e.unsubscribe(this),(t=this.brush)==null||t.unsubscribe(this),(r=this._parent)==null||r.removeChild(this),this.markDeleted=!0,this.scene.dirty=!0}getChildByName(e){return this.name===e?this.handle:0}minX(){return this._originX}minY(){return this._originY}maxX(){return this._originX+this._width}maxY(){return this._originY+this._height}onParentChanged(e){var t;if(e===this._parent)return;(t=this._parent)==null||t.removeChild(this),this._parent=e}onParentMoved(e,t){this._originX+=e,this._originY+=t,this.scene.dirty=!0}onParentResized(e,t,r,i){this._originX=e+(this._originX-e)*r,this._originY=t+(this._originY-t)*i;for(let s=0;s<this.coords.length;s+=2)this.coords[s+0]*=r,this.coords[s+1]*=i;this._width*=r,this._height*=i,this.needRedraw=!0,this.scene.dirty=!0}onParentRotated(e,t,r){const i=e-this._originX,s=t-this._originY;let n=Infinity,o=-Infinity,l=Infinity,c=-Infinity;const u=Math.sin(r),f=Math.cos(r);for(let S=0;S<this.coords.length;S+=2){const g=this.coords[S+0]-i,b=this.coords[S+1]-s,T=g*f-b*u+i,O=g*u+b*f+s;this.coords[S+0]=T,this.coords[S+1]=O,T<n&&(n=T),T>o&&(o=T),O<l&&(l=O),O>c&&(c=O)}for(let S=0;S<this.coords.length;S+=2)this.coords[S+0]-=n,this.coords[S+1]-=l;this._originX+=n,this._originY+=l,this._width=o-n,this._height=c-l,this.scene.dirty=!0,this.needRedraw=!0}render(e,t,r,i){var c;if(this._visible===0||(this._layer&i)!==0)return;const s=this.pen?this.pen.width()||.5:0,n=this._originX-t-s,o=this._originY-r-s;if(!this.needRedraw){e.drawImage(this.cnv,n,o);return}this.cnv.width=Math.max(this._width+s*4,1),this.cnv.height=Math.max(this._height+s*4,1);const l=this.ctx2;l.beginPath(),l.moveTo(this.coords[0]+s,this.coords[1]+s);for(let u=2;u<this.coords.length;u+=2)l.lineTo(this.coords[u]+s,this.coords[u+1]+s);if(this.brush&&this.coords.length>4){const u=this.brush.style();u!==1&&(l.closePath(),l.fillStyle=u===0?this.brush.cssColor():u===3&&((c=this.brush.dibTool())==null?void 0:c.pattern(l))||"white",l.fill("evenodd"))}this.pen&&(l.lineWidth=s,l.strokeStyle=this.pen.cssColor(),l.stroke()),this.needRedraw=!1,e.drawImage(this.cnv,n,o)}tryClick(e,t,r){var o;if(this._visible===0||(this._layer&r)!==0||this._selectable===0)return;const i=((o=this.pen)==null?void 0:o.width())||0,s=e-this._originX+i,n=t-this._originY+i;return s<0||n<0||s>this._width+i*2||n>this._height+i*2||this.ctx2.getImageData(s,n,1,1).data[3]===0?void 0:this._parent?this._parent.root():this}toolChanged(){this.needRedraw=!0,this.scene.dirty=!0}textToolHandle(){return 0}controlText(){return""}setControlText(){return 0}setBitmapRect(){return 0}itemHandle(){return 0}deleteItem(){return 0}addItem(){return 0}dibHandle(){return 0}doubleDIBHandle(){return 0}}class Oi{constructor(e,{handle:t,name:r,options:i,originX:s,originY:n,width:o,height:l,angle:c,textToolHandle:u}){this.type="text";var g;this.scene=e,this.handle=t,this.name=r||"",this.markDeleted=!1,e.dirty=!0,this.textTool=e.texts.get(u)||null,(g=this.textTool)==null||g.subscribe(this),this._originX=s,this._originY=n,this._angle=c/-10*Math.PI/180,this._width=o||this.actualWidth(),this._height=l||this.actualHeight();const f=i||0;this._visible=1,this._selectable=f&8?0:1;const S=f>>8&31;this._layer=1<<S,this._parent=null}toolChanged(){this.scene.dirty=!0}parentHandle(){var e;return((e=this._parent)==null?void 0:e.handle)||0}originX(){return this._originX}originY(){return this._originY}setOrigin(e,t){var r;return this._originX=e,this._originY=t,(r=this._parent)==null||r.updateBorders(),this.scene.dirty=!0,1}width(){return this._width}height(){return this._height}actualWidth(){var e;return((e=this.textTool)==null?void 0:e.width())||0}actualHeight(){var e;return((e=this.textTool)==null?void 0:e.height())||0}setSize(e,t){var r;return e<0||t<0?0:(this._width=e,this._height=t,(r=this._parent)==null||r.updateBorders(),this.scene.dirty=!0,1)}angle(){return this._angle}rotate(e,t,r){var i;return r===0||(this.onParentRotated(e,t,r),(i=this._parent)==null||i.updateBorders()),1}setShow(e){return this._visible=e,this.scene.dirty=!0,1}textToolHandle(){return this.textTool?this.textTool.handle:0}delete(){var e,t;(e=this.textTool)==null||e.unsubscribe(this),(t=this._parent)==null||t.removeChild(this),this.markDeleted=!0,this.scene.dirty=!0}getChildByName(e){return this.name===e?this.handle:0}minX(){return this._originX}minY(){return this._originY}maxX(){return this._originX+this._width}maxY(){return this._originY+this._height}onParentChanged(e){var t;if(e===this._parent)return;(t=this._parent)==null||t.removeChild(this),this._parent=e}onParentMoved(e,t){this._originX+=e,this._originY+=t,this.scene.dirty=!0}onParentResized(e,t,r,i){this._originX=e+(this._originX-e)*r,this._originY=t+(this._originY-t)*i,this._width*=r,this._height*=i,this.scene.dirty=!0}onParentRotated(e,t,r){const i=Math.sin(r),s=Math.cos(r),n=this._originX-e,o=this._originY-t,l=n*s-o*i,c=n*i+o*s;this._originX=l+e,this._originY=c+t,this._angle+=r,this.scene.dirty=!0}render(e,t,r,i){if(!this.textTool||this._visible===0||(this._layer&i)!==0)return;const s=this._originX-t,n=this._originY-r;this.textTool.render(e,s,n,this._width,this._height,this._angle)}tryClick(e,t,r){if(!this.textTool||this._visible===0||(this._layer&r)!==0||this._selectable===0)return;const i=Math.sin(-this._angle),s=Math.cos(-this._angle),n=e-this._originX,o=t-this._originY,l=n*s-o*i,c=n*i+o*s;return l<0||c<0||l>this._width||c>this._height?void 0:this._parent?this._parent.root():this}addPoint(){return 0}pointOriginY(){return 0}pointOriginX(){return 0}setPointOrigin(){return 0}penHandle(){return 0}brushHandle(){return 0}controlText(){return""}setControlText(){return 0}setBitmapRect(){return 0}itemHandle(){return 0}deleteItem(){return 0}deletePoint(){return 0}addItem(){return 0}dibHandle(){return 0}doubleDIBHandle(){return 0}}const Jb=["gray","blue","navy","gray","#b5b5b5","white","black","black","black","white","gray","gray","gray","navy","white","#b5b5b5","gray","gray","black","gray","white"],nu=1<<24,su=2<<24;function ou(e){const t=e.toLowerCase().trim();if(t.startsWith("transparent"))return nu;if(t.startsWith("syscolor"))return su|parseInt(t.split("(")[1].split(")")[0]);if(t.startsWith("rgb")){const r=t.split("(")[1].split(")")[0].split(",").map(i=>parseInt(i));return r[0]|r[1]<<8|r[2]<<16}throw Error(`\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u0446\u0432\u0435\u0442: ${e}`)}function je(e){if(e&nu)return"transparent";const t=e&255;if(e&su)return Jb[t]||"black";const r=e>>8&255,i=e>>16&255;return`rgb(${t},${r},${i})`}class Ai{constructor(e,{handle:t,color:r,hatch:i,rop2:s,style:n,dibHandle:o}){this.handle=t,this.subs=new Set,this._color=r,this._cssColor=je(r),this._style=n,this._hatch=i,this._rop=s,this._dibTool=o&&e.dibs.get(o)||null}subscribe(e){this.subs.add(e)}unsubscribe(e){this.subs.delete(e)}dibTool(){return this._dibTool}color(){return this._color}cssColor(){return this._cssColor}setColor(e){return this._color=e,this._cssColor=je(e),this.subs.forEach(t=>t.toolChanged()),1}style(){return this._style}setStyle(e){return this._style=e,1}hatch(){return this._hatch}setHatch(e){return this._hatch=e,1}rop(){return this._rop}setRop(e){return this._rop=e,1}}const au=nr(Rr());class st{constructor(e,t){this.p=0;this.meta=C({},t),this.v=e instanceof ArrayBuffer?new DataView(e):new DataView(e.buffer,e.byteOffset,e.byteLength)}get position(){return this.p}seek(e){return this.p=e,this}skip(e){return this.p+=e,this}get size(){return this.v.byteLength}eof(){return this.p>=this.size}bytes(e){const t=new Uint8Array(this.v.buffer,this.v.byteOffset+this.p,e);return this.p+=e,t}byte(){const e=this.v.getUint8(this.p);return this.p+=1,e}int16(){const e=this.v.getInt16(this.p,!0);return this.p+=2,e}uint16(){const e=this.v.getUint16(this.p,!0);return this.p+=2,e}int32(){const e=this.v.getInt32(this.p,!0);return this.p+=4,e}uint32(){const e=this.v.getUint32(this.p,!0);return this.p+=4,e}float64(){const e=this.v.getFloat64(this.p,!0);return this.p+=8,e}fixedString(e){return e>0?st.d.decode(this.bytes(e)):""}string(){return this.fixedString(this.uint16())}nulltString(e){const t=this.p;let r=0;for(;r<e-1&&this.v.getUint8(t+ ++r)!==0;);const i=this.fixedString(r);return this.p+=1,i}vmString(){const e=this.uint16()*2,t=this.v.getUint8(this.p+e-2)===0?2:1,r=this.fixedString(e-t);return this.p+=t,r}point2d(){return{x:this.float64(),y:this.float64()}}point2dInt(){return{x:this.int16(),y:this.int16()}}}st.d=new TextDecoder("windows-1251");class ot extends Error{constructor(e,t){super(`\u041E\u0448\u0438\u0431\u043A\u0430 \u0447\u0442\u0435\u043D\u0438\u044F ${e.meta.filepathDos||""}:
${t}`)}}class Me extends ot{constructor(e,t,r){super(e,`\u0421\u0438\u0433\u043D\u0430\u0442\u0443\u0440\u0430: 0x${t.toString(16)}, \u043E\u0436\u0438\u0434\u0430\u043B\u043E\u0441\u044C 0x${r.toString(16)}.`)}}class Qb{constructor(e,t=!1,r=0){this.width=0;this.height=0;this.bitPP=0;this.maskRed=0;this.maskGreen=0;this.maskBlue=0;this.mask0=0;this.fileSize=0;this.reserved=0;this.offset=0;this.headerSize=0;this.planes=0;this.compress=0;this.rawSize=0;this.hr=0;this.vr=0;this.colors=0;this.importantColors=0;this.pos=r,this.view=e,this.is_with_alpha=!!t,this.bottom_up=!0,this.flag="BM",this.pos+=2,this.parseHeader(),this.parseRGBA()}parseHeader(){if(this.fileSize=this.view.getUint32(this.pos,!0),this.pos+=4,this.reserved=this.view.getUint32(this.pos,!0),this.pos+=4,this.offset=this.view.getUint32(this.pos,!0),this.pos+=4,this.headerSize=this.view.getUint32(this.pos,!0),this.pos+=4,this.width=this.view.getUint32(this.pos,!0),this.pos+=4,this.height=this.view.getInt32(this.pos,!0),this.pos+=4,this.planes=this.view.getUint16(this.pos,!0),this.pos+=2,this.bitPP=this.view.getUint16(this.pos,!0),this.pos+=2,this.compress=this.view.getUint32(this.pos,!0),this.pos+=4,this.rawSize=this.view.getUint32(this.pos,!0),this.pos+=4,this.hr=this.view.getUint32(this.pos,!0),this.pos+=4,this.vr=this.view.getUint32(this.pos,!0),this.pos+=4,this.colors=this.view.getUint32(this.pos,!0),this.pos+=4,this.importantColors=this.view.getUint32(this.pos,!0),this.pos+=4,this.bitPP===16&&this.is_with_alpha&&(this.bitPP=15),this.bitPP<15){const e=this.colors===0?1<<this.bitPP:this.colors;this.palette=new Array(e);for(let t=0;t<e;t++){const r=this.view.getUint8(this.pos++),i=this.view.getUint8(this.pos++),s=this.view.getUint8(this.pos++),n=this.view.getUint8(this.pos++);this.palette[t]={red:s,green:i,blue:r,quad:n}}}this.height<0&&(this.height*=-1,this.bottom_up=!1)}parseRGBA(){const e="bit"+this.bitPP,t=this.width*this.height*4;if(this.data=new Uint8ClampedArray(t),e!=="bit1"&&e!=="bit4"&&e!=="bit8"&&e!=="bit15"&&e!=="bit16"&&e!=="bit24"&&e!=="bit32")throw new Error("Unknown bit: "+e);this[e]()}bit1(){const e=Math.ceil(this.width/8),t=e%4;let r=this.height>=0?this.height-1:-this.height;for(r=this.height-1;r>=0;r--){const i=this.bottom_up?r:this.height-1-r;for(let s=0;s<e;s++){const n=this.view.getUint8(this.pos++),o=i*this.width*4+s*8*4;for(let l=0;l<8&&s*8+l<this.width;l++){const c=this.palette[n>>7-l&1];this.data[o+l*4]=c.red,this.data[o+l*4+1]=c.green,this.data[o+l*4+2]=c.blue,this.data[o+l*4+3]=255}}t!==0&&(this.pos+=4-t)}}bit4(){if(this.compress===2){this.data.fill(255);let e=0,t=this.bottom_up?this.height-1:0,r=!1;const i=s=>{const n=this.palette[s];this.data[e]=n.red,this.data[e+1]=n.green,this.data[e+2]=n.blue,this.data[e+3]=255,e+=4};for(;e<this.data.length;){const s=this.view.getUint8(this.pos++),n=this.view.getUint8(this.pos++);if(s===0)if(n===0){this.bottom_up?t--:t++,e=t*this.width*4,r=!1;continue}else{if(n===1)break;if(n===2){const o=this.view.getUint8(this.pos++),l=this.view.getUint8(this.pos++);this.bottom_up?t-=l:t+=l,e+=l*this.width*4+o*4}else{let o=this.view.getUint8(this.pos++);for(let l=0;l<n;l++)r?i.call(this,o&15):i.call(this,(o&240)>>4),l&1&&l+1<n&&(o=this.view.getUint8(this.pos++)),r=!r;(n+1>>1&1)===1&&this.pos++}}else for(let o=0;o<s;o++)r?i.call(this,n&15):i.call(this,(n&240)>>4),r=!r}}else{const e=Math.ceil(this.width/2),t=e%4;for(let r=this.height-1;r>=0;r--){const i=this.bottom_up?r:this.height-1-r;for(let s=0;s<e;s++){const n=this.view.getUint8(this.pos++),o=i*this.width*4+s*2*4,l=n>>4,c=n&15;let u=this.palette[l];if(this.data[o]=u.red,this.data[o+1]=u.green,this.data[o+2]=u.blue,this.data[o+3]=255,s*2+1>=this.width)break;u=this.palette[c],this.data[o+4]=u.red,this.data[o+4+1]=u.green,this.data[o+4+2]=u.blue,this.data[o+4+3]=255}t!==0&&(this.pos+=4-t)}}}bit8(){if(this.compress===1){this.data.fill(255);let e=0,t=this.bottom_up?this.height-1:0;const r=i=>{const s=this.palette[i];this.data[e]=s.red,this.data[e+1]=s.green,this.data[e+2]=s.blue,this.data[e+3]=255,e+=4};for(;e<this.data.length;){const i=this.view.getUint8(this.pos++),s=this.view.getUint8(this.pos++);if(i===0)if(s===0){this.bottom_up?t--:t++,e=t*this.width*4;continue}else{if(s===1)break;if(s===2){const n=this.view.getUint8(this.pos++),o=this.view.getUint8(this.pos++);this.bottom_up?t-=o:t+=o,e+=o*this.width*4+n*4}else{for(let n=0;n<s;n++){const o=this.view.getUint8(this.pos++);r.call(this,o)}(s&1)===1&&this.pos++}}else for(let n=0;n<i;n++)r.call(this,s)}}else{const e=this.width%4;for(let t=this.height-1;t>=0;t--){const r=this.bottom_up?t:this.height-1-t;for(let i=0;i<this.width;i++){const s=this.view.getUint8(this.pos++),n=r*this.width*4+i*4;if(s<this.palette.length){const o=this.palette[s];this.data[n]=o.red,this.data[n+1]=o.green,this.data[n+2]=o.blue,this.data[n+3]=255}else this.data[n]=255,this.data[n+1]=255,this.data[n+2]=255,this.data[n+3]=255}e!==0&&(this.pos+=4-e)}}}bit15(){const e=this.width%3,t=parseInt("11111",2),r=t;for(let i=this.height-1;i>=0;i--){const s=this.bottom_up?i:this.height-1-i;for(let n=0;n<this.width;n++){const o=this.view.getUint16(this.pos,!0);this.pos+=2;const l=(o&r)/r*255|0,c=(o>>5&r)/r*255|0,u=(o>>10&r)/r*255|0,f=s*this.width*4+n*4;this.data[f]=u,this.data[f+1]=c,this.data[f+2]=l,this.data[f+3]=255}this.pos+=e}}bit16(){const e=this.width%2*2;this.maskRed=31744,this.maskGreen=992,this.maskBlue=31,this.mask0=0,this.compress===3&&(this.maskRed=this.view.getUint32(this.pos,!0),this.pos+=4,this.maskGreen=this.view.getUint32(this.pos,!0),this.pos+=4,this.maskBlue=this.view.getUint32(this.pos,!0),this.pos+=4,this.mask0=this.view.getUint32(this.pos,!0),this.pos+=4);const t=[0,0,0];for(let r=0;r<16;r++)this.maskRed>>r&1&&t[0]++,this.maskGreen>>r&1&&t[1]++,this.maskBlue>>r&1&&t[2]++;t[1]+=t[0],t[2]+=t[1],t[0]=8-t[0],t[1]-=8,t[2]-=8;for(let r=this.height-1;r>=0;r--){const i=this.bottom_up?r:this.height-1-r;for(let s=0;s<this.width;s++){const n=this.view.getUint16(this.pos,!0);this.pos+=2;const o=(n&this.maskBlue)<<t[0],l=(n&this.maskGreen)>>t[1],c=(n&this.maskRed)>>t[2],u=i*this.width*4+s*4;this.data[u]=c,this.data[u+1]=l,this.data[u+2]=o,this.data[u+3]=255}this.pos+=e}}bit24(){for(let e=this.height-1;e>=0;e--){const t=this.bottom_up?e:this.height-1-e;for(let r=0;r<this.width;r++){const i=this.view.getUint8(this.pos++),s=this.view.getUint8(this.pos++),n=this.view.getUint8(this.pos++),o=t*this.width*4+r*4;this.data[o]=n,this.data[o+1]=s,this.data[o+2]=i,this.data[o+3]=255}this.pos+=this.width%4}}bit32(){if(this.compress===3){this.maskRed=this.view.getUint32(this.pos,!0),this.pos+=4,this.maskGreen=this.view.getUint32(this.pos,!0),this.pos+=4,this.maskBlue=this.view.getUint32(this.pos,!0),this.pos+=4,this.mask0=this.view.getUint32(this.pos,!0),this.pos+=4;for(let e=this.height-1;e>=0;e--){const t=this.bottom_up?e:this.height-1-e;for(let r=0;r<this.width;r++){this.view.getUint8(this.pos++);const i=this.view.getUint8(this.pos++),s=this.view.getUint8(this.pos++),n=this.view.getUint8(this.pos++),o=t*this.width*4+r*4;this.data[o]=n,this.data[o+1]=s,this.data[o+2]=i,this.data[o+3]=255}}}else for(let e=this.height-1;e>=0;e--){const t=this.bottom_up?e:this.height-1-e;for(let r=0;r<this.width;r++){const i=this.view.getUint8(this.pos++),s=this.view.getUint8(this.pos++),n=this.view.getUint8(this.pos++);this.view.getUint8(this.pos++);const o=t*this.width*4+r*4;this.data[o]=n,this.data[o+1]=s,this.data[o+2]=i,this.data[o+3]=255}}}getData(){return this.data}}function Di(e){return new Qb(e)}function ds(e){const t=e.position,r=e.uint16();if(r!==19778)throw new Me(e,r,19778);const i=e.int32();return e.seek(t),i}function fs(e){return new DataView(e.buffer,e.byteOffset)}function Ni(e){const t=e.bytes(ds(e)),{data:r,width:i,height:s}=Di(fs(t)),n=document.createElement("canvas");n.width=i,n.height=s;const o=n.getContext("2d",{alpha:!1});if(!o)throw Error(`\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 ${e.meta.filepathDos}`);return o.putImageData(new ImageData(r,i,s),0,0),n}function Qt(e){const t=e.bytes(ds(e)),r=e.bytes(ds(e)),{data:i,width:s,height:n}=Di(fs(t)),{data:o}=Di(fs(r));for(let u=3;u<i.length&&u<o.length;u+=4)i[u]=255^o[u-1];const l=document.createElement("canvas");l.width=s,l.height=n;const c=l.getContext("2d",{alpha:!0});if(!c)throw Error(`\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 ${e.meta.filepathDos}`);return c.putImageData(new ImageData(i,s,n),0,0),l}class Ot{constructor(e){if(this.handle=e.handle,this._pattern=null,this.subs=new Set,e.type==="ttDIB2D"||e.type==="ttDOUBLEDIB2D")this.img=e.img.width>0&&e.img.height>0?e.img.getContext("2d"):null;else{this.img=null;const t=au.options.iconsLocation;if(!t)return;const r=`${t.endsWith("/")?t:t+"/"}${e.filename.toUpperCase()}`;if(e.type==="ttREFTODIB2D"){const i=new Image;i.addEventListener("load",()=>{if(i.width===0||i.height===0)return;const s=document.createElement("canvas");s.width=i.width,s.height=i.height;const n=s.getContext("2d",{alpha:!1});if(!n)throw Error(`\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435 ${e.filename}`);n.drawImage(i,0,0),this.img=s.getContext("2d")||null}),i.src=r}else fetch(r).then(i=>i.arrayBuffer()).then(i=>{const s=Qt(new st(i,{filepathDos:r}));if(s.width===0||s.height===0)return;this.img=s.getContext("2d")||null})}}subscribe(e){this.subs.add(e)}unsubscribe(e){this.subs.delete(e)}getPixel(e,t){if(!this.img)return 0;const r=this.img.getImageData(e,t,1,1).data,i=r[0],s=r[1]<<8,n=r[2]<<16;return i|s|n}setPixel(e,t,r){if(!this.img)return 1;const i=r&255,s=r>>8&255,n=r>>16&255,o=this.img.createImageData(1,1),l=o.data;return l[0]=i,l[1]=s,l[2]=n,l[3]=255,this.img.putImageData(o,e,t),this.subs.forEach(c=>c.toolChanged()),1}pattern(e){return this.img?this._pattern?this._pattern:this._pattern=e.createPattern(this.img.canvas,"repeat"):null}render(e,t,r,i,s,n,o,l,c){this.img&&e.drawImage(this.img.canvas,t,r,i,s,n,o,l,c)}tryClick(e,t){return this.img?this.img.getImageData(e,t,1,1).data[3]!==0:!1}width(){var e;return((e=this.img)==null?void 0:e.canvas.width)||0}height(){var e;return((e=this.img)==null?void 0:e.canvas.height)||0}}class ki{constructor({handle:e,fontName:t,height:r,italic:i,underline:s,strikeOut:n,weight:o}){this.handle=e,this.subs=new Set,this._name=t,this._size=r||0,this._size*=this._size<0?-1:1,this._style=(i?1:0)|(s?2:0)|(n?4:0)|(o?8:0),this._cssName=t.toUpperCase().endsWith(" CYR")?t.slice(0,t.length-4):t}subscribe(e){this.subs.add(e)}unsubscribe(e){this.subs.delete(e)}name(){return this._name}setName(e){return this._name=e,this._cssName=e.endsWith(" CYR")?e.slice(0,e.length-4):e,this.subs.forEach(t=>t.toolChanged()),1}size(){return this._size}setSize(e){return this._size=e,this.subs.forEach(t=>t.toolChanged()),1}style(){return this._style}setStyle(e){return this._style=e,this.subs.forEach(t=>t.toolChanged()),1}underline(){return!!(this._style&2)}strikeOut(){return!!(this._style&4)}toCSSString(){return`${this._style&8?"bold":""} ${this._style&1?"italic":""} ${this._size}px ${this._cssName}`}}class Ri{constructor({handle:e,color:t,rop2:r,style:i,width:s}){this.handle=e,this.subs=new Set,this._color=t,this._cssColor=je(t),this._width=s,this._style=i,this._rop=r}subscribe(e){this.subs.add(e)}unsubscribe(e){this.subs.delete(e)}color(){return this._color}cssColor(){return this._cssColor}setColor(e){return this._color=e,this._cssColor=je(e),this.subs.forEach(t=>t.toolChanged()),1}width(){return this._width}setWidth(e){return this._width=e,this.subs.forEach(t=>t.toolChanged()),1}style(){return this._style}setStyle(e){return this._style=e,1}rop(){return this._rop}setRop(e){return this._rop=e,1}}class Bi{constructor({handle:e,text:t}){this.handle=e,this.subs=new Set,this._text=t}subscribe(e){this.subs.add(e)}unsubscribe(e){this.subs.delete(e)}text(){return this._text}setText(e){return this._text=e,this.subs.forEach(t=>t.toolChanged()),1}}class Li{constructor(e,{handle:t,textCollection:r}){this.handle=t,this.subs=new Set,this.scene=e,this.cnv=document.createElement("canvas"),this.ctx2=this.cnv.getContext("2d",{alpha:!0}),this.needUpdatePrepared=!0,this.needRedraw=!0,this.textCollection=r.map(i=>{const s=e.fonts.get(i.fontHandle)||null;s==null||s.subscribe(this);const n=e.strings.get(i.stringHandle)||null;return n==null||n.subscribe(this),{font:s,string:n,fgColor:i.fgColor,bgColor:i.bgColor}}),this.prepared=[],this._width=0,this._height=0}subscribe(e){this.subs.add(e)}unsubscribe(e){this.subs.delete(e)}toolChanged(){this.needRedraw=!0,this.needUpdatePrepared=!0,this.subs.forEach(e=>e.toolChanged())}textCount(){return this.textCollection.length}fontHandle(e){if(e<0||e>=this.textCollection.length)return 0;const t=this.textCollection[e].font;return t?t.handle:0}stringHandle(e){if(e<0||e>=this.textCollection.length)return 0;const t=this.textCollection[e].string;return t?t.handle:0}fgColor(e){return e<0||e>=this.textCollection.length?0:this.textCollection[e].fgColor}bgColor(e){return e<0||e>=this.textCollection.length?0:this.textCollection[e].bgColor}updatePrepared(){if(!this.needUpdatePrepared)return;const e=this.ctx2,t=[];let r=0,i=0,s=0,n=0,o=[];for(const l of this.textCollection){const c=l.font,u=l.string;if(!c||!u)continue;const f=je(l.fgColor),S=je(l.bgColor),g=c.toCSSString(),b=c.size(),T=u.text().split(`\r
`);e.font=g;let O=!1;for(const I of T){O&&(t.push({row:o,height:n}),i=Math.max(i,s),r+=n,o=[],s=0,n=0);const v=e.measureText(I).width;o.push({elem:I,font:g,width:v,height:b,fgColor:f,bgColor:S,underline:c.underline(),strikeout:c.strikeOut()}),s+=v,O=!0,n=Math.max(n,b)}}t.push({row:o,height:n}),i=Math.max(i,s),r+=n,this._width=i*1.01,this._height=r*1.01,this.prepared=t,this.needUpdatePrepared=!1}redraw(){if(!this.needRedraw)return;this.updatePrepared(),this.cnv.width=Math.max(this._width,1),this.cnv.height=Math.max(this._height,1);const e=this.ctx2;let t=0,r=0;for(const{row:i,height:s}of this.prepared){t=0,r+=s;for(const{elem:n,font:o,width:l,height:c,bgColor:u,fgColor:f,underline:S,strikeout:g}of i){e.font=o,e.textAlign="left",e.textBaseline="ideographic";const b=c,T=(s-b)/4;e.fillStyle=u,e.fillRect(t,r-b-T,l,b),e.fillStyle=f;const O=r-T+b/15;e.fillText(n,t,O);const I=b/20;g&&e.fillRect(t,r-b/2.5,l,I),S&&e.fillRect(t,r-I,l,I),t+=l}}this.needRedraw=!1}render(e,t,r,i,s,n){if(this.redraw(),this.cnv.width===0||this.cnv.height===0)return;e.save(),e.translate(t,r),e.rotate(n),e.drawImage(this.cnv,0,0,i*1.02,s*1.02,0,0,i*1.02,s*1.02),e.restore()}width(){return this.updatePrepared(),this._width}height(){return this.updatePrepared(),this._height}setValues(e,t,r,i,s){var o,l,c,u;if(e<0||e>=this.textCollection.length)return 0;const n=this.textCollection[e];if(t>0&&((o=n.font)==null?void 0:o.handle)!==t){(l=n.font)==null||l.unsubscribe(this);const f=this.scene.fonts.get(t)||null;f==null||f.subscribe(this),n.font=f}if(r>0&&((c=n.string)==null?void 0:c.handle)!==r){(u=n.string)==null||u.unsubscribe(this);const f=this.scene.strings.get(r)||null;f==null||f.subscribe(this),n.string=f}return n.fgColor=i,n.bgColor=s,this.needUpdatePrepared=!0,this.needRedraw=!0,this.subs.forEach(f=>f.toolChanged()),1}}class ms{constructor(e,t,r){this.capture=null;this.moveSubs=new Map;this.leftButtonUpSubs=new Map;this.leftButtonDownSubs=new Map;this.rightButtonUpSubs=new Map;this.rightButtonDownSubs=new Map;this.middleButtonUpSubs=new Map;this.middleButtonDownSubs=new Map;this.blocked=!1;this.controlNotifySubs=new Map;var l,c,u,f,S,g,b,T,O,I;this.cnv=e;const i=e.getContext("2d",{alpha:!1});if(!i)throw Error("\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u0442\u044C \u043A\u043E\u043D\u0442\u0435\u043A\u0441\u0442 \u0440\u0435\u043D\u0434\u0435\u0440\u0438\u043D\u0433\u0430");i.fillStyle="white",i.fillRect(0,0,this.cnv.width,this.cnv.height),this.ctx=i,this.dirty=!1,this.html=t;const s=v=>this.pointerEventHandler(v);if(e.addEventListener("pointerdown",s),e.addEventListener("pointerup",s),e.addEventListener("pointerleave",s),e.addEventListener("pointermove",s),this.fillStyle="white",!r){this._originX=0,this._originY=0,this._scale=1,this.layers=0,this.objects=new Map,this.primaryObjects=[],this.pens=new Map,this.brushes=new Map,this.dibs=new Map,this.doubleDibs=new Map,this.strings=new Map,this.fonts=new Map,this.texts=new Map,this.matrix=[1,0,0,0,1,0,0,0,1];return}if(this.pens=new Map((l=r.penTools)==null?void 0:l.map(v=>[v.handle,new Ri(v)])),this.dibs=new Map((c=r.dibTools)==null?void 0:c.map(v=>[v.handle,new Ot(v)])),this.brushes=new Map((u=r.brushTools)==null?void 0:u.map(v=>[v.handle,new Ai(this,v)])),this.doubleDibs=new Map((f=r.doubleDibTools)==null?void 0:f.map(v=>[v.handle,new Ot(v)])),this.strings=new Map((S=r.stringTools)==null?void 0:S.map(v=>[v.handle,new Bi(v)])),this.fonts=new Map((g=r.fontTools)==null?void 0:g.map(v=>[v.handle,new ki(v)])),this.texts=new Map((b=r.textTools)==null?void 0:b.map(v=>[v.handle,new Li(this,v)])),r.brushHandle>0){const v=this.brushes.get(r.brushHandle);v&&(this.fillStyle=v.cssColor())}this.matrix=((T=r.crdSystem)==null?void 0:T.matrix.slice())||[1,0,0,0,1,0,0,0,1],this._originX=r.origin.x,this._originY=r.origin.y,this.layers=r.layers,this._scale=1;const n=new Set,o=v=>{switch(v.type){case"otGROUP2D":const N=new kr(this,v);return n.add({g:N,h:v.childHandles}),[v.handle,N];case"otLINE2D":return[v.handle,new Ii(this,v)];case"otTEXT2D":return[v.handle,new Oi(this,v)];case"otCONTROL2D":return[v.handle,new xi(this,t,v)];case"otBITMAP2D":case"otDOUBLEBITMAP2D":return[v.handle,new Ei(this,v)]}};this.objects=new Map((O=r.elements)==null?void 0:O.map(o)),n.forEach(v=>v.g.addChildren(v.h)),this.primaryObjects=[],(I=r.elementOrder)==null||I.forEach(v=>{const N=this.objects.get(v);if(!N||N.type==="group")return;this.primaryObjects.push(N)})}render(){if(!this.dirty)return;this.ctx.fillStyle=this.fillStyle,this.ctx.fillRect(0,0,this.cnv.width,this.cnv.height),this.primaryObjects.forEach(e=>e.render(this.ctx,this._originX,this._originY,this.layers)),this.dirty=!1}originX(){return this._originX}originY(){return this._originY}setOrigin(e,t){return this._originX=e,this._originY=t,this.dirty=!0,1}scale(){return this._scale}setScale(e){return this._scale=e,1}createLine(e,t,r){const i=J.getFreeHandle(this.objects),s=new Ii(this,{handle:i,penHandle:t,brushHandle:r,coords:e});return this.objects.set(i,s),this.primaryObjects.push(s),i}createBitmap(e,t,r,i){const s=J.getFreeHandle(this.objects),n=new Ei(this,{handle:s,originX:e,originY:t,type:i?"otDOUBLEBITMAP2D":"otBITMAP2D",dibHandle:r});return this.objects.set(s,n),this.primaryObjects.push(n),s}createText(e,t,r,i){const s=J.getFreeHandle(this.objects),n=new Oi(this,{handle:s,originX:e,originY:t,angle:r,textToolHandle:i});return this.objects.set(s,n),this.primaryObjects.push(n),s}createControl(e,t,r,i,s,n,o){if(s!=="EDIT"&&s!=="BUTTON"&&s!=="COMBOBOX")return 0;const l=J.getFreeHandle(this.objects),c=new xi(this,this.html,{handle:l,originX:e,originY:t,width:r,height:i,className:s,text:n});return this.objects.set(l,c),this.primaryObjects.push(c),l}createGroup(e){const t=J.getFreeHandle(this.objects),r=new kr(this,{handle:t}).addChildren(e);return this.objects.set(t,r),t}insertVectorDrawing(e,t,r,i){var v,N,$,P,D,H,U,z;if(!i.elements)return 0;const s=this.pens,n=this.dibs,o=this.brushes,l=this.doubleDibs,c=this.strings,u=this.fonts,f=this.texts,S=this.objects;this.pens=new Map((v=i.penTools)==null?void 0:v.map(E=>[E.handle,new Ri(E)])),this.dibs=new Map((N=i.dibTools)==null?void 0:N.map(E=>[E.handle,new Ot(E)])),this.brushes=new Map(($=i.brushTools)==null?void 0:$.map(E=>[E.handle,new Ai(this,E)])),this.doubleDibs=new Map((P=i.doubleDibTools)==null?void 0:P.map(E=>[E.handle,new Ot(E)])),this.strings=new Map((D=i.stringTools)==null?void 0:D.map(E=>[E.handle,new Bi(E)])),this.fonts=new Map((H=i.fontTools)==null?void 0:H.map(E=>[E.handle,new ki(E)])),this.texts=new Map((U=i.textTools)==null?void 0:U.map(E=>[E.handle,new Li(this,E)]));const g=new Set,b=E=>{switch(E.type){case"otGROUP2D":const R=new kr(this,E);return g.add({g:R,h:E.childHandles}),[E.handle,R];case"otLINE2D":return[E.handle,new Ii(this,E)];case"otTEXT2D":return[E.handle,new Oi(this,E)];case"otCONTROL2D":return[E.handle,new xi(this,this.html,E)];case"otBITMAP2D":case"otDOUBLEBITMAP2D":return[E.handle,new Ei(this,E)]}},T=i.elements.map(b);this.objects=new Map(T),g.forEach(E=>E.g.addChildren(E.h)),(z=i.elementOrder)==null||z.forEach(E=>{const R=this.objects.get(E);if(!R||R.type==="group")return;this.primaryObjects.push(R)});const O=T.filter(E=>E[1].parentHandle()===0).map(E=>E[1].handle);if(O.length===0)throw Error("\u041E\u0448\u0438\u0431\u043A\u0430 \u0432\u0441\u0442\u0430\u0432\u043A\u0438 \u0438\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u044F");let I;if(O.length>1){const E=J.getFreeHandle(this.objects),R=new kr(this,{handle:E}).addChildren(O);this.objects.set(E,R),I=R}else I=this.objects.values().next().value;return I.setOrigin(e,t),this.pens.forEach(E=>{const R=J.getFreeHandle(s);E.handle=R,s.set(R,E)}),this.dibs.forEach(E=>{const R=J.getFreeHandle(n);E.handle=R,n.set(R,E)}),this.brushes.forEach(E=>{const R=J.getFreeHandle(o);E.handle=R,o.set(R,E)}),this.doubleDibs.forEach(E=>{const R=J.getFreeHandle(l);E.handle=R,l.set(R,E)}),this.strings.forEach(E=>{const R=J.getFreeHandle(c);E.handle=R,c.set(R,E)}),this.fonts.forEach(E=>{const R=J.getFreeHandle(u);E.handle=R,u.set(R,E)}),this.texts.forEach(E=>{const R=J.getFreeHandle(f);E.handle=R,f.set(R,E)}),this.objects.forEach(E=>{const R=J.getFreeHandle(S);E.handle=R,S.set(R,E)}),this.pens=s,this.dibs=n,this.brushes=o,this.doubleDibs=l,this.strings=c,this.fonts=u,this.texts=f,this.objects=S,I.handle}deleteObject(e){const t=this.objects.get(e);return t?(t.delete(),this.objects=new Map([...this.objects].filter(r=>!r[1].markDeleted)),this.primaryObjects=this.primaryObjects.filter(r=>!r.markDeleted),1):0}deleteGroup2d(e){const t=this.objects.get(e);return!t||t.type!=="group"?0:(t.ungroup(),this.objects.delete(e),1)}getObjectZOrder(e){for(let t=0;t<this.primaryObjects.length;++t)if(this.primaryObjects[t].handle===e)return t+1;return 0}setObjectZOrder(e,t){if(t<1)return 0;const r=Math.floor(t),i=this.primaryObjects.find(n=>n.handle===e);if(!i)return 0;const s=[];for(let n=0;n<this.primaryObjects.length;++n){r===n+1&&s.push(i);const o=this.primaryObjects[n];o!==i&&s.push(o)}return r>this.primaryObjects.length&&s.push(i),this.dirty=!0,1}moveObjectToTop(e){const t=this.primaryObjects.find(i=>i.handle===e);if(!t)return 0;const r=this.primaryObjects.filter(i=>i!==t);return r.push(t),this.dirty=!0,1}getObject2dByName(e,t){if(t==="")return 0;if(e){const r=this.objects.get(e);return r?r.getChildByName(t):0}for(const r of this.objects.values())if(r.name===t)return r.handle;return 0}setObjectName(e,t){const r=this.objects.get(e);return r?(r.name=t,1):0}getObjectFromPoint2d(e,t){for(let r=this.primaryObjects.length-1;r>=0;--r){const i=this.primaryObjects[r].tryClick(e,t,this.layers);if(i)return i.handle}return 0}isIntersect(e,t){const r=this.objects.get(e);if(!r)return 0;const i=this.objects.get(t);return i&&(r.maxX()>=i.minX()&&i.maxX()>=r.minX()&&r.maxY()>=i.minY()&&i.maxY()>=r.minY())?1:0}createPenTool(e,t,r,i){const s=J.getFreeHandle(this.pens);return this.pens.set(s,new Ri({handle:s,color:r,width:t,rop2:i,style:e})),s}createBrushTool(e,t,r,i,s){const n=J.getFreeHandle(this.brushes);return this.brushes.set(n,new Ai(this,{handle:n,color:r,hatch:t,dibHandle:i,style:e,rop2:s})),n}createDIBTool(e){const t=J.getFreeHandle(this.dibs);return this.dibs.set(t,new Ot({handle:t,type:"ttDIB2D",img:e})),t}createDoubleDIBTool(e){const t=J.getFreeHandle(this.doubleDibs);return this.doubleDibs.set(t,new Ot({handle:t,type:"ttDOUBLEDIB2D",img:e})),t}createStringTool(e){const t=J.getFreeHandle(this.strings);return this.strings.set(t,new Bi({handle:t,text:e})),t}createFontTool(e,t,r){const i=J.getFreeHandle(this.fonts),s=r&1,n=r&2,o=r&4,l=r&8;return this.fonts.set(i,new ki({handle:i,fontName:e,height:-t,italic:s,underline:n,strikeOut:o,weight:l})),i}createTextTool(e,t,r,i){const s=J.getFreeHandle(this.texts);return this.texts.set(s,new Li(this,{handle:s,textCollection:[{fgColor:r,bgColor:i,fontHandle:e,stringHandle:t}]})),s}setCapture(e){this.capture=e}releaseCapture(){this.capture=null}onMouse(e,t,r){switch(t){case A.WM_MOUSEMOVE:this.moveSubs.set(e,r);break;case A.WM_LBUTTONDOWN:this.leftButtonDownSubs.set(e,r);break;case A.WM_LBUTTONUP:this.leftButtonUpSubs.set(e,r);break;case A.WM_RBUTTONDOWN:this.rightButtonDownSubs.set(e,r);break;case A.WM_RBUTTONUP:this.rightButtonUpSubs.set(e,r);break;case A.WM_MBUTTONDOWN:this.middleButtonDownSubs.set(e,r);break;case A.WM_MBUTTONUP:this.middleButtonUpSubs.set(e,r);break;case A.WM_ALLMOUSEMESSAGE:this.moveSubs.set(e,r),this.leftButtonDownSubs.set(e,r),this.leftButtonUpSubs.set(e,r),this.rightButtonDownSubs.set(e,r),this.rightButtonUpSubs.set(e,r),this.middleButtonDownSubs.set(e,r),this.middleButtonUpSubs.set(e,r);break}}offMouse(e,t){switch(t){case A.WM_MOUSEMOVE:this.moveSubs.delete(e);break;case A.WM_LBUTTONDOWN:this.leftButtonDownSubs.delete(e);break;case A.WM_LBUTTONUP:this.leftButtonUpSubs.delete(e);break;case A.WM_RBUTTONDOWN:this.rightButtonDownSubs.delete(e);break;case A.WM_RBUTTONUP:this.rightButtonUpSubs.delete(e);break;case A.WM_MBUTTONDOWN:this.middleButtonDownSubs.delete(e);break;case A.WM_MBUTTONUP:this.middleButtonUpSubs.delete(e);break;case A.WM_ALLMOUSEMESSAGE:this.moveSubs.delete(e),this.leftButtonDownSubs.delete(e),this.leftButtonUpSubs.delete(e),this.rightButtonDownSubs.delete(e),this.rightButtonUpSubs.delete(e),this.middleButtonDownSubs.delete(e),this.middleButtonUpSubs.delete(e);break}}pointerEventHandler(e){const t=e.target.getBoundingClientRect(),r=e.clientX-t.left+this.originX(),i=e.clientY-t.top+this.originY(),s=e.buttons&1?1:0,n=e.buttons&2?2:0,o=e.buttons&4?16:0,l=s|n|o;le.keyState[1]=s,le.keyState[2]=n,le.keyState[4]=o;switch(e.type){case"pointerdown":{this.blocked=!0;switch(e.button){case 0:this.dispatchMouseEvent(this.leftButtonDownSubs,A.WM_LBUTTONDOWN,r,i,l);return;case 1:this.dispatchMouseEvent(this.middleButtonDownSubs,A.WM_MBUTTONDOWN,r,i,l);return;case 2:this.dispatchMouseEvent(this.rightButtonDownSubs,A.WM_RBUTTONDOWN,r,i,l);return}return}case"pointerup":{switch(e.button){case 0:this.dispatchMouseEvent(this.leftButtonUpSubs,A.WM_LBUTTONUP,r,i,l);return;case 1:this.dispatchMouseEvent(this.middleButtonUpSubs,A.WM_MBUTTONUP,r,i,l);return;case 2:this.dispatchMouseEvent(this.rightButtonUpSubs,A.WM_RBUTTONUP,r,i,l);return}return}case"pointerleave":{this.dispatchMouseEvent(this.leftButtonUpSubs,A.WM_LBUTTONUP,r,i,0);return}case"pointermove":if(this.blocked){this.blocked=!1;return}this.dispatchMouseEvent(this.moveSubs,A.WM_MOUSEMOVE,r,i,l);return}}dispatchMouseEvent(e,t,r,i,s){this.capture&&this.capture.receive(t,r,i,s);for(const[n,o]of e)(o===0||this.getObjectFromPoint2d(r,i)===o)&&n.receive(t,r,i,s)}onControlNotify(e,t){this.controlNotifySubs.set(e,t)}offControlNotify(e){this.controlNotifySubs.delete(e)}dispatchControlNotifyEvent(e,t){for(const[r,i]of this.controlNotifySubs)(i===0||i===e)&&r.receive(A.WM_CONTROLNOTIFY,e,0,t)}}class lu{constructor({handle:e,wname:t,attribute:r,vdr:i,host:s,disableResize:n}){this.classname="";this.filename="";this.closeSubs=new Set;this.sizeSubs=new Set;this._originX=0;this._originY=0;var c;if(this.ignoreSetSize=n!=null?n:!1,this.resizible=!((c=i==null?void 0:i.otDATAITEMS)==null?void 0:c.some(u=>u.id===11)),i==null?void 0:i.source){const{name:u,origin:f}=i.source;f==="class"?this.classname=u:f==="file"&&(this.filename=u)}const o=this.view=document.createElement("div");o.style.setProperty("position","relative"),o.style.setProperty("overflow","hidden"),o.style.setProperty("width","100%"),o.style.setProperty("height","100%");const l=this.cnv=document.createElement("canvas");l.style.setProperty("top","0px"),l.style.setProperty("left","0px"),l.style.setProperty("position","absolute"),l.style.setProperty("touch-action","pinch-zoom"),o.appendChild(l),this.wnd=s.window({title:r.toUpperCase().includes("WS_NOCAPTION")?void 0:t,view:o}),l.width=this.width(),l.height=this.height(),this.scene=new ms(l,this,i)}textInput(e){return new cs(this.view,e)}onSpaceDone(e){this.closeSubs.add(e)}offClose(e){this.closeSubs.delete(e)}dispatchClose(){for(const e of this.closeSubs)e.receive(A.WM_SPACEDONE)}onResize(e){this.sizeSubs.add(e)}offResize(e){this.sizeSubs.delete(e)}onControlNotifty(e,t){this.scene.onControlNotify(e,t)}offControlNotify(e){this.scene.offControlNotify(e)}onMouse(e,t,r){this.scene.onMouse(e,t,r)}offMouse(e,t){this.scene.offMouse(e,t)}redraw(){const{view:e,scene:t}=this,r=e.clientWidth,i=e.clientHeight;if(r!==this.cnv.width||i!==this.cnv.height){this.cnv.width=r,this.cnv.height=i;for(const s of this.sizeSubs)s.receive(A.WM_SIZE,r,i)}t.render()}close(){this.wnd.close()}getProp(e){const t=e.toUpperCase();return t==="CLASSNAME"?this.classname:t==="FILENAME"?this.filename:""}width(){const e=this.view.clientWidth;return e>0?e:window.innerWidth}height(){const e=this.view.clientHeight;return e>0?e:window.innerHeight}setSize(e,t){if(this.ignoreSetSize===!0)return 1;if(this.wnd.setSize(e,t),this.resizible===!0)return 1;const{view:{style:r}}=this;return r.setProperty("width",e+"px"),r.setProperty("height",t+"px"),1}toTop(){return this.wnd.toTop(),1}setAttrib(e){return 1}originX(){return this._originX}originY(){return this._originY}setOrigin(e,t){return this._originX=e,this._originY=t,1}}class le{constructor(e,t,r){this.classes=e;this.dir=t;this.host=r;this.computer=new hu.SmoothExecutor;this.hspaceToWname=new Map;this.wnameToHspace=new Map;this.scenes=new Map;this.windows=new Map;this.targetScene=null;this.level=0;this.unsub=new Set;this.unsubS=0;this.oldFloats=new Float64Array(0),this.newFloats=new Float64Array(0),this.oldInts=new Int32Array(0),this.newInts=new Int32Array(0),this.oldStrings=[],this.newStrings=[],this.olds=[],this.news=[],this.shouldClose=!1}init({floatsCount:e,intsCount:t,stringsCount:r}){return this.oldFloats=new Float64Array(e),this.newFloats=new Float64Array(e),this.oldInts=new Int32Array(t),this.newInts=new Int32Array(t),this.oldStrings=new Array(r).fill(""),this.newStrings=new Array(r).fill(""),this.olds[k.Float]=this.oldFloats,this.olds[k.Handle]=this.oldInts,this.olds[k.ColorRef]=this.oldInts,this.olds[k.String]=this.oldStrings,this.news[k.Float]=this.newFloats,this.news[k.Handle]=this.newInts,this.news[k.ColorRef]=this.newInts,this.news[k.String]=this.newStrings,this}sync(){this.oldFloats.set(this.newFloats),this.oldInts.set(this.newInts);for(let e=0;e<this.newStrings.length;++e)this.oldStrings[e]=this.newStrings[e];return this}assertZeroIndexEmpty(){if(this.oldFloats[0]!==0||"undefined"in this.oldFloats||this.newFloats[0]!==0||"undefined"in this.newFloats||this.oldInts[0]!==0||"undefined"in this.oldInts||this.newInts[0]!==0||"undefined"in this.newInts||this.oldStrings[0]!==""||"undefined"in this.oldStrings||this.newStrings[0]!==""||"undefined"in this.newStrings)throw Error("\u0411\u044B\u043B\u043E \u0438\u0437\u043C\u0435\u043D\u0435\u043D\u043E \u0437\u0430\u0440\u0435\u0437\u0435\u0440\u0432\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u043E\u0435 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u0435 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u043E\u0439")}stratum_getTime(e,t,r,i,s,n,o,l){const c=new Date;e[t]=c.getHours(),r[i]=c.getMinutes(),s[n]=c.getSeconds(),o[l]=c.getMilliseconds()*.1}stratum_getDate(e,t,r,i,s,n){const o=new Date;e[t]=o.getFullYear(),r[i]=o.getMonth(),s[n]=o.getDate()}stratum_getTickCount(){return new Date().getTime()-le.startupTime}stratum_newArray(){throw Error("\u0424\u0443\u043D\u043A\u0446\u0438\u044F New \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D\u0430")}stratum_logMessage(e){}stratum_MCISendString(){return 263}stratum_MCISendStringStr(){return""}stratum_system(e,...t){return 0}stratum_getAsyncKeyState(e){return le.keyState[e]>0?1:0}stratum_closeAll(){this.shouldClose=!0}stratum_quit(e){if(e<=0)return;this.shouldClose=!0}stratum_openSchemeWindow(e,t,r){const i=this.classes.getComposedScheme(t);return this.openWindow(e,r,i)}stratum_loadSpaceWindow(e,t,r){const i=this.dir.get(t),s=i&&!i.dir?i.readSyncAs("vdr"):void 0;return this.openWindow(e,r,s)}stratum_createObjectFromFile2D(e,t,r,i,s){const n=this.scenes.get(e);if(typeof n=="undefined")return 0;const o=this.dir.get(t),l=o&&!o.dir&&o.readSyncAs("vdr");return l?n.insertVectorDrawing(r,i,s,l):0}stratum_getClassDirectory(e){const t=this.classes.get(e);return typeof t!="undefined"?t.directoryDos:""}stratum_fileExist(e){const t=this.dir.get(e);return typeof t!="undefined"?1:0}stratum_getWindowName(e){const t=this.hspaceToWname.get(e);return typeof t!="undefined"?t:""}stratum_getSpaceOrg2dx(e){const t=this.scenes.get(e);return typeof t!="undefined"?t.originX():0}stratum_getSpaceOrg2dy(e){const t=this.scenes.get(e);return typeof t!="undefined"?t.originY():0}stratum_setSpaceOrg2d(e,t,r){const i=this.scenes.get(e);return typeof i!="undefined"?i.setOrigin(t,r):0}stratum_getScaleSpace2d(e){const t=this.scenes.get(e);return typeof t!="undefined"?t.scale():0}stratum_setScaleSpace2d(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.setScale(t):0}stratum_getObjectOrg2dx(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.originX():0}stratum_getObjectOrg2dy(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.originY():0}stratum_setObjectOrg2d(e,t,r,i){const s=this.getObject(e,t);return typeof s!="undefined"?s.setOrigin(r,i):0}stratum_getObjectAngle2d(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.angle():0}stratum_rotateObject2d(e,t,r,i,s){const n=this.getObject(e,t);return typeof n!="undefined"?n.rotate(r,i,s):0}stratum_getActualWidth2d(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.actualWidth():0}stratum_getActualHeight2d(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.actualHeight():0}stratum_getActualSize2d(e,t,r,i,s,n){const o=this.getObject(e,t);return typeof o=="undefined"?0:(r[i]=o.actualWidth(),s[n]=o.actualHeight(),1)}stratum_getObjectWidth2d(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.width():0}stratum_getObjectHeight2d(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.height():0}stratum_setObjectSize2d(e,t,r,i){const s=this.getObject(e,t);return typeof s!="undefined"?s.setSize(r,i):0}stratum_getZOrder2d(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.getObjectZOrder(t):0}stratum_setZOrder2d(e,t,r){const i=this.scenes.get(e);return typeof i!="undefined"?i.setObjectZOrder(t,r):0}stratum_setObjectName2d(e,t,r){const i=this.scenes.get(e);return typeof i!="undefined"?i.setObjectName(t,r):0}stratum_setShowObject2d(e,t,r){const i=this.getObject(e,t);return typeof i!="undefined"?i.setShow(r):0}stratum_objectToTop2d(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.moveObjectToTop(t):0}stratum_deleteObject2d(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.deleteObject(t):0}stratum_createGroup2d(e,...t){const r=this.scenes.get(e);return typeof r!="undefined"?r.createGroup(t):0}stratum_addGroupItem2d(e,t,r){const i=this.getObject(e,t);return typeof i!="undefined"?i.addItem(r):0}stratum_getGroupItem2d(e,t,r){const i=this.getObject(e,t);return typeof i!="undefined"?i.itemHandle(r):0}stratum_delGroupItem2d(e,t,r){const i=this.getObject(e,t);return typeof i!="undefined"?i.deleteItem(r):0}stratum_getObject2dByName(e,t,r){const i=this.scenes.get(e);return typeof i!="undefined"?i.getObject2dByName(t,r):0}stratum_getObjectParent2d(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.parentHandle():0}stratum_deleteGroup2d(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.deleteGroup2d(t):0}stratum_getObjectFromPoint2d(e,t,r){const i=this.scenes.get(e);return typeof i!="undefined"?i.getObjectFromPoint2d(t,r):0}stratum_isObjectsIntersect2d(e,t,r,i){const s=this.scenes.get(e);return typeof s!="undefined"?s.isIntersect(t,r):0}stratum_createPolyLine2d(e,t,r,...i){const s=this.scenes.get(e);return typeof s!="undefined"?s.createLine(i,t,r):0}stratum_createLine2d(e,t,r,i,s){const n=this.scenes.get(e);return typeof n!="undefined"?n.createLine([i,s],t,r):0}stratum_addPoint2d(e,t,r,i,s){const n=this.getObject(e,t);return typeof n!="undefined"?n.addPoint(r,i,s):0}stratum_delpoint2d(e,t,r){const i=this.getObject(e,t);return typeof i!="undefined"?i.deletePoint(r):0}stratum_getVectorPoint2dx(e,t,r){const i=this.getObject(e,t);return typeof i!="undefined"?i.pointOriginX(r):0}stratum_getVectorPoint2dy(e,t,r){const i=this.getObject(e,t);return typeof i!="undefined"?i.pointOriginY(r):0}stratum_setVectorPoint2d(e,t,r,i,s){const n=this.getObject(e,t);return typeof n!="undefined"?n.setPointOrigin(r,i,s):0}stratum_getPenObject2d(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.penHandle():0}stratum_getBrushObject2d(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.brushHandle():0}stratum_createRasterText2D(e,t,r,i,s){const n=this.scenes.get(e);return typeof n!="undefined"?n.createText(r,i,s,t):0}stratum_getTextObject2d(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.textToolHandle():0}stratum_getControlText2d(e,t,r,i){const s=this.getObject(e,t);return typeof s=="undefined"?"":typeof r=="undefined"||typeof i=="undefined"?s.controlText():s.controlText().slice(r,r+i)}stratum_setControlText2d(e,t,r){const i=this.getObject(e,t);return typeof i!="undefined"?i.setControlText(r):0}stratum_createBitmap2d(e,t,r,i){const s=this.scenes.get(e);return typeof s!="undefined"?s.createBitmap(r,i,t,!1):0}stratum_createDoubleBitmap2D(e,t,r,i){const s=this.scenes.get(e);return typeof s!="undefined"?s.createBitmap(r,i,t,!0):0}stratum_setBitmapSrcRect2d(e,t,r,i,s,n){const o=this.getObject(e,t);return typeof o!="undefined"?o.setBitmapRect(r,i,s,n):0}stratum_getDibObject2d(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.dibHandle():0}stratum_getDoubleDibObject2d(e,t){const r=this.getObject(e,t);return typeof r!="undefined"?r.doubleDIBHandle():0}stratum_createPen2d(e,t,r,i,s){const n=this.scenes.get(e);return typeof n!="undefined"?n.createPenTool(t,r,i,s):0}stratum_getPenStyle2d(e,t){const r=this.getTPen(e,t);return typeof r!="undefined"?r.style():0}stratum_setPenStyle2d(e,t,r){const i=this.getTPen(e,t);return typeof i!="undefined"?i.setStyle(r):0}stratum_getPenWidth2d(e,t){const r=this.getTPen(e,t);return typeof r!="undefined"?r.width():0}stratum_setPenWidth2d(e,t,r){const i=this.getTPen(e,t);return typeof i!="undefined"?i.setWidth(r):0}stratum_getPenColor2d(e,t){const r=this.getTPen(e,t);return typeof r!="undefined"?r.color():0}stratum_setPenColor2d(e,t,r){const i=this.getTPen(e,t);return typeof i!="undefined"?i.setColor(r):0}stratum_getPenRop2d(e,t){const r=this.getTPen(e,t);return typeof r!="undefined"?r.rop():0}stratum_setPenRop2d(e,t,r){const i=this.getTPen(e,t);return typeof i!="undefined"?i.setRop(r):0}stratum_createBrush2d(e,t,r,i,s,n){const o=this.scenes.get(e);return typeof o!="undefined"?o.createBrushTool(t,r,i,s,n):0}stratum_getBrushStyle2d(e,t){const r=this.getTBrush(e,t);return typeof r!="undefined"?r.style():0}stratum_setBrushStyle2d(e,t,r){const i=this.getTBrush(e,t);return typeof i!="undefined"?i.setStyle(r):0}stratum_getBrushHatch2d(e,t){const r=this.getTBrush(e,t);return typeof r!="undefined"?r.hatch():0}stratum_setBrushHatch2d(e,t,r){const i=this.getTBrush(e,t);return typeof i!="undefined"?i.setHatch(r):0}stratum_getBrushColor2d(e,t){const r=this.getTBrush(e,t);return typeof r!="undefined"?r.color():0}stratum_setBrushColor2d(e,t,r){const i=this.getTBrush(e,t);return typeof i!="undefined"?i.setColor(r):0}stratum_getBrushRop2d(e,t){const r=this.getTBrush(e,t);return typeof r!="undefined"?r.rop():0}stratum_setBrushRop2d(e,t,r){const i=this.getTBrush(e,t);return typeof i!="undefined"?i.setRop(r):0}stratum_createDIB2d(e,t){const r=this.scenes.get(e);if(typeof r=="undefined")return 0;const i=this.dir.get(t),s=i&&!i.dir&&i.readSyncAs("bmp");return s?r.createDIBTool(s):0}stratum_createDoubleDib2D(e,t){const r=this.scenes.get(e);if(typeof r=="undefined")return 0;const i=this.dir.get(t),s=i&&!i.dir&&i.readSyncAs("dbm");return s?r.createDoubleDIBTool(s):0}stratum_getDibPixel2D(e,t,r,i){const s=this.getTDIB(e,t);return typeof s!="undefined"?s.getPixel(r,i):0}stratum_setDibPixel2D(e,t,r,i,s){const n=this.getTDIB(e,t);return typeof n!="undefined"?n.setPixel(r,i,s):0}stratum_createText2D(e,t,r,i,s){const n=this.scenes.get(e);return typeof n!="undefined"?n.createTextTool(t,r,i,s):0}stratum_getTextCount2d(e,t){const r=this.getTText(e,t);return typeof r!="undefined"?r.textCount():0}stratum_getTextFont2d(e,t,r=0){const i=this.getTText(e,t);return typeof i!="undefined"?i.fontHandle(r):0}stratum_getTextString2d(e,t,r=0){const i=this.getTText(e,t);return typeof i!="undefined"?i.stringHandle(r):0}stratum_getTextFgColor2d(e,t,r=0){const i=this.getTText(e,t);return typeof i!="undefined"?i.fgColor(r):0}stratum_getTextBkColor2d(e,t,r=0){const i=this.getTText(e,t);return typeof i!="undefined"?i.bgColor(r):0}stratum_setText2D(e,t,r,i,s,n,o){const l=this.getTText(e,t);if(typeof l=="undefined")return 0;const c=typeof o!="undefined"?r:0,u=typeof o!="undefined"?i:r,f=typeof o!="undefined"?s:i,S=typeof o!="undefined"?n:s,g=typeof o!="undefined"?o:n;return l.setValues(c,u,f,S,g)}stratum_createString2D(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.createStringTool(t):0}stratum_getstring2d(e,t){const r=this.getTString(e,t);return typeof r!="undefined"?r.text():""}stratum_setString2d(e,t,r){const i=this.getTString(e,t);return typeof i!="undefined"?i.setText(r):0}stratum_createFont2D(e,t,r,i){const s=this.scenes.get(e);return typeof s!="undefined"?s.createFontTool(t,r,i):0}stratum_getFontName2d(e,t){const r=this.getTFont(e,t);return typeof r!="undefined"?r.name():""}stratum_getFontSize2d(e,t){const r=this.getTFont(e,t);return typeof r!="undefined"?r.size():0}stratum_getFontStyle2d(e,t){const r=this.getTFont(e,t);return typeof r!="undefined"?r.style():0}stratum_setFontName2d(e,t,r){const i=this.getTFont(e,t);return typeof i!="undefined"?i.setName(r):0}stratum_setFontSize2d(e,t,r){const i=this.getTFont(e,t);return typeof i!="undefined"?i.setSize(r):0}stratum_setFontStyle2d(e,t,r){const i=this.getTFont(e,t);return typeof i!="undefined"?i.setStyle(r):0}stratum_isWindowExist(e){const t=this.windows.get(e);return typeof t!="undefined"?1:0}stratum_getWindowSpace(e){const t=this.wnameToHspace.get(e);return typeof t!="undefined"?t:0}stratum_getWindowProp(e,t){const r=this.windows.get(e);return typeof r!="undefined"?r.getProp(t):""}stratum_getWindowOrgX(e){const t=this.windows.get(e);return typeof t!="undefined"?t.originX():0}stratum_getWindowOrgY(e){const t=this.windows.get(e);return typeof t!="undefined"?t.originY():0}stratum_setWindowOrg(e,t,r){const i=this.windows.get(e);return typeof i!="undefined"?i.setOrigin(t,r):0}stratum_getWindowWidth(e){const t=this.windows.get(e);return typeof t!="undefined"?t.width():0}stratum_getWindowHeight(e){const t=this.windows.get(e);return typeof t!="undefined"?t.height():0}stratum_getClientWidth(e){const t=this.windows.get(e);return typeof t!="undefined"?t.width():0}stratum_getClientHeight(e){const t=this.windows.get(e);return typeof t!="undefined"?t.height():0}stratum_setClientSize(e,t,r){const i=this.windows.get(e);return typeof i!="undefined"?i.setSize(t,r):0}stratum_bringWindowToTop(e){const t=this.windows.get(e);return typeof t!="undefined"?t.toTop():0}stratum_showWindow(e,t){const r=this.windows.get(e);return typeof r!="undefined"?r.setAttrib(t):0}stratum_closeWindow(e){var i;const t=this.windows.get(e);if(typeof t=="undefined")return 0;t.close(),this.windows.delete(e);const r=this.wnameToHspace.get(e);if(typeof r!="undefined"){this.wnameToHspace.delete(e),this.hspaceToWname.delete(r);const s=this.scenes.get(r);this.scenes.delete(r),s===this.targetScene&&((i=this.targetScene)==null||i.releaseCapture(),this.targetScene=null)}return 1}stratum_setWindowTransparent(){return 1}stratum_setWindowTransparentColor(){return 1}stratum_setWindowOwner(){return 1}stratum_getScreenWidth(){return screen.width}stratum_getScreenHeight(){return screen.height}stratum_getWorkAreaX(){return 0}stratum_getWorkAreaY(){return 0}stratum_getWorkAreaWidth(){return this.host.width}stratum_getWorkAreaHeight(){return this.host.height}subscribe(e,t,r,i){const s=typeof t=="string"?t:this.hspaceToWname.get(t);if(!s)return;const n=this.windows.get(s);if(typeof n=="undefined")return;switch(i){case A.WM_CONTROLNOTIFY:n.onControlNotifty(e,r);break;case A.WM_MOVE:break;case A.WM_SIZE:n.onResize(e);break;case A.WM_SPACEDONE:n.onSpaceDone(e);break;case A.WM_MOUSEMOVE:case A.WM_LBUTTONDOWN:case A.WM_LBUTTONUP:case A.WM_LBUTTONDBLCLK:case A.WM_RBUTTONDOWN:case A.WM_RBUTTONUP:case A.WM_RBUTTONDBLCLK:case A.WM_MBUTTONDOWN:case A.WM_MBUTTONUP:case A.WM_MBUTTONDBLCLK:case A.WM_ALLMOUSEMESSAGE:{n.onMouse(e,i,r);break}default:this.unsub.add(A[i]),this.unsub.size>this.unsubS&&(this.unsubS=this.unsub.size,console.warn(`\u041F\u043E\u0434\u043F\u0438\u0441\u043A\u0430 \u043D\u0430 ${A[i]} \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D\u0430`));break}}unsubscribe(e,t,r){const i=typeof t=="string"?t:this.hspaceToWname.get(t);if(!i)return;const s=this.windows.get(i);if(typeof s=="undefined")return;switch(r){case A.WM_CONTROLNOTIFY:s.offControlNotify(e);break;case A.WM_SIZE:s.offResize(e);break;case A.WM_SPACEDONE:s.offClose(e);break;case A.WM_MOUSEMOVE:case A.WM_LBUTTONDOWN:case A.WM_LBUTTONUP:case A.WM_LBUTTONDBLCLK:case A.WM_RBUTTONDOWN:case A.WM_RBUTTONUP:case A.WM_RBUTTONDBLCLK:case A.WM_MBUTTONDOWN:case A.WM_MBUTTONUP:case A.WM_MBUTTONDBLCLK:case A.WM_ALLMOUSEMESSAGE:{s.offMouse(e,r);break}default:break}}setCapture(e,t){const r=this.scenes.get(e);typeof r!="undefined"&&(this.targetScene=r).setCapture(t)}stratum_releaseCapture(){if(this.targetScene===null)return;this.targetScene.releaseCapture(),this.targetScene=null}openWindow(e,t,r,i){const s=this.wnameToHspace.get(e);if(typeof s!="undefined")return s;const n=J.getFreeHandle(this.scenes),o=new lu({handle:n,wname:e,attribute:t,host:this.host,vdr:r,disableResize:i==null?void 0:i.options.disableWindowResize});return o.wnd.on("closed",()=>{this.stratum_closeWindow(e),o.dispatchClose()}),this.hspaceToWname.set(n,e),this.wnameToHspace.set(e,n),this.scenes.set(n,o.scene),this.windows.set(e,o),this.computer.run(()=>this.redrawAll()),n}closeAllWindows(e){this.windows.forEach(t=>t.close()),this.hspaceToWname.clear(),this.wnameToHspace.clear(),this.scenes.clear(),this.windows.clear()}getObject(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.objects.get(t):void 0}getTPen(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.pens.get(t):void 0}getTBrush(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.brushes.get(t):void 0}getTDIB(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.dibs.get(t):void 0}getTText(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.texts.get(t):void 0}getTString(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.strings.get(t):void 0}getTFont(e,t){const r=this.scenes.get(e);return typeof r!="undefined"?r.fonts.get(t):void 0}redrawAll(){const e=this.windows;return e.forEach(t=>t.redraw()),e.size>0}}le.startupTime=new Date().getTime(),le.keyState=new Uint8Array(256);function Fi(e,t){switch(e){case k.String:return t;case k.Float:return parseFloat(t)||0;case k.Handle:return(t.startsWith("#")?parseInt(t.substring(1,t.length)):parseInt(t))||0;case k.ColorRef:return ou(t)}}function eg(e,t){const r=i=>console.warn(`\u0418\u043C\u0438\u0434\u0436 ${e.proto.name}: ${i}`);for(const{handle1:i,handle2:s,connectedVars:n}of t){const o=i===0?e:e.child(i),l=s===0?e:e.child(s);if(o?o.proto.vars||r(`\u041F\u043E\u0434\u0438\u043C\u0438\u0434\u0436 #${i} \u043D\u0435 \u0438\u043C\u0435\u0435\u0442 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0445`):r(`\u041F\u043E\u0434\u0438\u043C\u0438\u0434\u0436 #${i} \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D`),l?l.proto.vars||r(`\u041F\u043E\u0434\u0438\u043C\u0438\u0434\u0436 #${s} \u043D\u0435 \u0438\u043C\u0435\u0435\u0442 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0445`):r(`\u041F\u043E\u0434\u0438\u043C\u0438\u0434\u0436 #${s} \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D`),!o||!o.proto.vars||!l||!l.proto.vars)continue;const c=o.proto.vars,u=l.proto.vars,f=`\u043F\u043E\u0434\u0438\u043C\u0438\u0434\u0436\u0435 ${o.proto.name} #${i}`,S=`\u043F\u043E\u0434\u0438\u043C\u0438\u0434\u0436\u0435 ${l.proto.name} #${s}`;for(const{name1:g,name2:b}of n){const T=c.nameUCToId.get(g.toUpperCase()),O=u.nameUCToId.get(b.toUpperCase());if(T===void 0&&r(`\u041F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u0430\u044F ${g} \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430 \u0432 ${f}`),O===void 0&&r(`\u041F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u0430\u044F ${b} \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u0430 \u0432 ${S}`),T===void 0||O===void 0)continue;if(!o.connectVar(T,l,O)){const I=k[o.proto.vars.types[T]],v=k[l.proto.vars.types[O]];r(`\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0441\u043E\u0435\u0434\u0438\u043D\u0438\u0442\u044C ${g} (${I}) \u0432 ${f} \u0438 ${b} (${v}) \u0432 ${S}`)}}}}function ps(e,t,r,i){const s=t.get(e);if(!s)throw Error(`\u0418\u043C\u0438\u0434\u0436 "${e}" \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D.`);const n=new ye(s,r,i);if(s.children){const o=s.children.map(l=>ps(l.classname,t,r,C({parent:n},l.schemeInfo)));n.setChildren(o)}return s.links&&eg(n,s.links),n}class bs{constructor(e){this.type=e;this.indexWasSet=!1;this.globalVarIdx=-1;this.connectedNodes=new Set}static connect(e,t){if(e.type!==t.type)return!1;if(e.indexWasSet||t.indexWasSet)throw Error("\u0421\u043E\u0435\u0434\u0438\u043D\u0435\u043D\u0438\u0435 \u0443\u0436\u0435 \u0438\u043D\u0438\u0446\u0438\u0430\u043B\u0438\u0437\u0438\u0440\u043E\u0432\u0430\u043D\u043D\u044B\u0445 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0445 \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D\u043E");return e.connectedNodes.add(t),t.connectedNodes.add(e),!0}shareIndex(e){if(this.indexWasSet)return;this.indexWasSet=!0,this.globalVarIdx=e,this.connectedNodes.forEach(t=>t.shareIndex(e))}getIndex(e){if(!this.indexWasSet)switch(this.type){case k.Float:this.shareIndex(e.floatsCount++);break;case k.Handle:case k.ColorRef:this.shareIndex(e.intsCount++);break;case k.String:this.shareIndex(e.stringsCount++);break}return this.globalVarIdx}}class ye{constructor(e,t,r){this.handle=0;this.name="";this.position={x:0,y:0};this.parent=this;this.varGraphNodes=[];this.isDisabled=ye.alwaysEnabled;this.disOrEnVarId=-1;this.children=[];this.idTypes=[];this.cachedNames=[];this.classNodeCache=new Map;var i;this.model=(i=e.model)!=null?i:ye.NoModel,this.proto=e,this.env=t,r&&(this.handle=r.handle,this.name=r.name,this.position=r.position,this.parent=r.parent);{const s=this.vars=e.vars;this.varGraphNodes=s.types.map(l=>new bs(l)),this.TLB=new Uint16Array(s.count);const n=this.proto._enableVarId,o=this.proto._disableVarId;n>0&&(o<0||n<o)&&(this.isDisabled=ye.disabledByEnable,this.disOrEnVarId=n),o>0&&(n<0||o<n)&&(this.isDisabled=ye.disabledByDisable,this.disOrEnVarId=o)}{let s=this;for(;s.parent!==s;)s=s.parent;this.root=s,this.neighMapUC=new Map([["",this],["\\",s]]),r&&this.neighMapUC.set("..",r.parent)}}static build(e,t,r){return ps(e,t,r)}stratum_getHObject(){return this.handle}stratum_getClassName(e){const t=this.resolve(e);return typeof t=="undefined"?"":t.proto.name}stratum_setVar(e,t,r){const i=this.resolve(e);if(typeof i=="undefined")return;const{vars:s}=i.proto;if(typeof s=="undefined")return;const n=s.nameUCToId.get(t.toUpperCase());typeof n!="undefined"&&i.setVarValue2(n,s.types[n],r)}stratum_sendMessage(e,t,...r){const{env:i,vars:s,TLB:n,cachedNames:o}=this;if(i.level>58)return;if(e!=="")throw Error(`\u0412\u044B\u0437\u043E\u0432 SendMessage \u0441 objectName=${e} \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D`);if(r.length%2!==0)throw Error("SendMessage: \u043A\u043E\u043B-\u0432\u043E \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0445 \u0434\u043E\u043B\u0436\u043D\u043E \u0431\u044B\u0442\u044C \u0447\u0435\u0442\u043D\u044B\u043C");const l=t.toUpperCase(),c=this.findClasses(l);if(c.length===0)return;const u=c[0],f=u.vars,S=u.model;if(s.count===0||f.count===0){for(const I of c){if(I===this)continue;++i.level,S(I,i),--i.level}return}let g=r.length===o.length;if(g===!0){for(let I=0;I<r.length;I++)if(r[I]!==o[I]){g=!1;break}}if(g===!1){this.cachedNames=r;const I=this.idTypes=new Array(r.length+r.length/2);let v=0;for(let N=0;N<r.length;N+=2){const $=r[N].toUpperCase(),P=s.nameUCToId.get($);if(typeof P=="undefined")continue;const D=r[N+1].toUpperCase(),H=f.nameUCToId.get(D);if(typeof H=="undefined")continue;const U=s.types[P],z=f.types[H];if(U!==z)continue;I[v+0]=P,I[v+1]=H,I[v+2]=U,v+=3}}const{idTypes:b}=this,{news:T,olds:O}=i;for(const I of c){if(I===this)continue;for(let v=0;v<b.length;v+=3){const N=b[v+2];if(typeof N=="undefined")continue;const $=n[b[v+0]],P=I.TLB[b[v+1]],D=T[N],H=O[N],U=D[$];D[P]=U,H[P]=U}++i.level,S(I,i),--i.level;for(let v=0;v<b.length;v+=3){const N=b[v+2];if(typeof N=="undefined")continue;const $=n[b[v+0]],P=I.TLB[b[v+1]],D=T[N],H=O[N],U=D[P];D[$]=U,H[$]=U}}}stratum_setCapture(e,t,r){if(t!=="")throw Error(`\u0412\u044B\u0437\u043E\u0432 setCapture \u0441 path=${t} \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D`);const i=this;if(typeof i=="undefined"||i.proto.msgVarId<0)return;this.env.setCapture(e,i)}stratum_registerObject(e,t,r,i,s){if(r!=="")throw Error(`\u0412\u044B\u0437\u043E\u0432 RegisterObject \u0441 path=${r} \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D`);const n=this;if(typeof n=="undefined"||n.proto.msgVarId<0)return;this.env.subscribe(n,e,t,i)}stratum_unregisterObject(e,t,r){if(t!=="")throw Error(`\u0412\u044B\u0437\u043E\u0432 UnRegisterObject \u0441 path=${t} \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D`);const i=this;if(typeof i=="undefined"||i.proto.msgVarId<0)return;this.env.unsubscribe(i,e,r)}receive(e,...t){const{proto:r}=this;if(r.msgVarId<0)return;this.setVarValue2(r.msgVarId,k.Float,e);switch(e){case A.WM_CONTROLNOTIFY:this.setVarValue2(r._hobjectVarId,k.Handle,t[0]),this.setVarValue2(r.iditemVarId,k.Float,t[1]),this.setVarValue2(r.wnotifycodeVarId,k.Float,t[2]);break;case A.WM_SIZE:this.setVarValue2(r.nwidthVarId,k.Float,t[0]),this.setVarValue2(r.nheightVarId,k.Float,t[1]);break;case A.WM_MOUSEMOVE:case A.WM_LBUTTONDOWN:case A.WM_LBUTTONUP:case A.WM_LBUTTONDBLCLK:case A.WM_RBUTTONDOWN:case A.WM_RBUTTONUP:case A.WM_RBUTTONDBLCLK:case A.WM_MBUTTONDOWN:case A.WM_MBUTTONUP:case A.WM_MBUTTONDBLCLK:this.setVarValue2(r.xposVarId,k.Float,t[0]),this.setVarValue2(r.yposVarId,k.Float,t[1]),this.setVarValue2(r.fwkeysVarId,k.Float,t[2]);break}const{env:i,TLB:s,model:n}=this;n(this,i);const{newFloats:o,oldFloats:l,newInts:c,oldInts:u,newStrings:f,oldStrings:S}=i;for(const g of s)l[g]=o[g],u[g]=c[g],S[g]=f[g]}setChildren(e){if(this.children.length>0)throw Error("\u0418\u0437\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u043F\u043E\u0434\u0438\u043C\u0438\u0434\u0436\u0435\u0439 \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D\u043E");return(this.children=e).forEach(t=>{t.name&&this.neighMapUC.set(t.name.toUpperCase(),t)}),this}child(e){return this.children.find(t=>t.handle===e)}connectVar(e,t,r){return bs.connect(this.varGraphNodes[e],t.varGraphNodes[r])}createTLB(){const e={floatsCount:1,intsCount:1,stringsCount:1};return function t({children:r,TLB:i,varGraphNodes:s}){r.forEach(t),i.set(s.map(n=>n.getIndex(e)))}(this),e}applyDefaults(){this.children.forEach(t=>t.applyDefaults());const{vars:e}=this.proto;if(!e)return this;for(let t=0;t<e.count;++t){const r=e.types[t],i=e.defaultValues[t];if(typeof i!="undefined"){this.setNewVarValue(t,r,i);continue}switch(t){case this.proto.orgxVarId:this.setNewVarValue(t,r,this.position.x);break;case this.proto.orgyVarId:this.setNewVarValue(t,r,this.position.y);break;case this.proto._hobjectVarId:this.setNewVarValue(t,r,this.handle);break;case this.proto._objnameVarId:this.setNewVarValue(t,r,this.name);break;case this.proto._classnameVarId:this.setNewVarValue(t,r,this.proto.name);break}}return this}applyVarSet(e){const{name:t,vars:r}=this.proto;if(r&&t.toUpperCase()===e.classname.toUpperCase())for(const i of e.values){const s=r.nameUCToId.get(i.name.toUpperCase());if(typeof s=="undefined")continue;const n=r.types[s];this.setNewVarValue(s,n,Fi(n,i.value))}return e.childSets.forEach(i=>{var s;return(s=this.child(i.handle))==null?void 0:s.applyVarSet(i)}),this}compute(){if(this.isDisabled(this)===!0)return;for(const e of this.children)e.compute();this.model(this,this.env)}resolve(e){if(e==="")return this;const t=e.split("\\");let r=e[0]==="\\"?this.root:this;for(let i=0;i<t.length;++i){const s=r.neighMapUC.get(t[i]);if(typeof s=="undefined")return;r=s}return r}setNewVarValue(e,t,r){if(e<0)return;this.env.news[t][this.TLB[e]]=r}setVarValue2(e,t,r){if(e<0)return;const i=this.TLB[e];this.env.olds[t][i]=r,this.env.news[t][i]=r}findClasses(e){const{root:t}=this,r=t.classNodeCache.get(e);if(typeof r!="undefined")return r;const i=new Array;return function s(n){n.children.forEach(s),n.proto.name.toUpperCase()===e&&i.push(n)}(t),t.classNodeCache.set(e,i),i}static alwaysEnabled(){return!1}static disabledByEnable({env:e,disOrEnVarId:t,TLB:r}){return e.newFloats[r[t]]<=0}static disabledByDisable({env:e,disOrEnVarId:t,TLB:r}){return e.newFloats[r[t]]>0}static NoModel(){}}const gs="'",_s='"';function uu(e){let t="",r;for(let i=0;i<e.length;++i){const s=e[i];if(s===gs&&r!==_s?r=r?void 0:gs:s===_s&&r!==gs&&(r=r?void 0:_s),r){t+=s;continue}if(s==="/"){const n=e[i+1];if(n==="*"){for(i+=2;i<e.length&&(e[i]!=="*"||e[i+1]!=="/");)++i;++i;continue}if(n==="/"){for(++i;i<e.length&&e[++i]!==`
`;);t[t.length-1]!==`
`&&(t+=`
`);continue}}if(s===";"||s===`
`){t[t.length-1]!==`
`&&(t+=`
`);continue}if(s==="\r"){e[i+1]===`
`&&++i,t[t.length-1]!==`
`&&(t+=`
`);continue}t+=s}return t[t.length-1]===`
`?t:t+`
`}const fu=nr(du()),ws="stratum_",mu=ws.length,tg=Object.getOwnPropertyNames(le.prototype).filter(e=>{const t=le.prototype[e];return typeof t=="function"&&t.name.startsWith(ws)}),rg=Object.getOwnPropertyNames(ye.prototype).filter(e=>{const t=ye.prototype[e];return typeof t=="function"&&t.name.startsWith(ws)}),ig=new Map([["ROUND","roundPrec"],["ADDSLASH","addSlash"],["NEW",le.prototype.stratum_newArray.name],...rg.map(e=>[e.substring(mu).toUpperCase(),`schema.${e}`]),...tg.map(e=>[e.substring(mu).toUpperCase(),`env.${e}`])]),er=new Map([[k.Float,"Floats"],[k.Handle,"Ints"],[k.ColorRef,"Ints"],[k.String,"Strings"]]),ng="TLB",sg=`
function right(a, n) {
    return a.substr(a.length - n);
}
function roundPrec(a, b) {
    const pw = Math.ceil(10 ** b);
    return Math.round(a * pw + Number.EPSILON) / pw;
}
function addSlash(a) {
    return a[a.length - 1] === "\\\\" ? a : a + "\\\\";
}
const { ${ng} } = schema;
const { newFloats, newStrings, newInts, oldFloats, oldInts, oldStrings } = env;
`;let ys=!1;function Mi(e,t){e.isNew&&e.type!=="var"&&(ys=!0);switch(e.type){case"const":{const r=e.value;return r[0]==="#"?r.length>1?r.substring(1,r.length):"0":r[0]==='"'||r[0]==="'"?"`"+r.substring(1,r.length-1).split("\\").join("\\\\").split("`").join("\\`")+"`":r}case"-":return"-"+Pe(e.operand,t);case"!":return"!"+Pe(e.operand,t);case"var":{if(!t)throw Error("\u0418\u043C\u0438\u0434\u0436 \u043D\u0435 \u0438\u043C\u0435\u0435\u0442 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0445");const r=e.name.toUpperCase(),i=t.nameUCToId.get(r);if(i===void 0){const n=A[r];if(n===void 0)throw Error(`\u041D\u0435\u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u043D\u0430\u044F \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u0430\u044F \u0438\u043B\u0438 \u043A\u043E\u043D\u0441\u0442\u0430\u043D\u0442\u0430: ${e.name}`);return n}const s=er.get(t.types[i]);if(!s)throw Error(`\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u0442\u0438\u043F \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u043E\u0439: ${t.types[i]} ${e.to}`);return`${e.isNew?"new":"old"}${s}[TLB[${i}]]`}case"call":{const r=e.name.toUpperCase();if(r==="EXIT")return"return";if(r==="INC"){const n=er.get(k.Float);if(!t)throw Error("\u0418\u043C\u0438\u0434\u0436 \u043D\u0435 \u0438\u043C\u0435\u0435\u0442 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0445");const o=e.args[0],l=o.first.name,c=t.nameUCToId.get(l.toUpperCase());if(c===void 0)throw Error(`\u041D\u0435\u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u043D\u0430\u044F \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u0430\u044F \u0432 \u0444\u0443\u043D\u043A\u0446\u0438\u0438 Inc: ${l}`);const u=e.args.length<2?1:Pe(e.args[1],t);return`${o.first.isNew?"new":"old"}${n}[TLB[${c}]] += ${u}`}if(r==="GETTIME"){const n=er.get(k.Float);if(!t)throw Error("\u0418\u043C\u0438\u0434\u0436 \u043D\u0435 \u0438\u043C\u0435\u0435\u0442 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0445");const o=e.args.map(l=>{const c=l.first.name,u=t.nameUCToId.get(c.toUpperCase());if(u===void 0)throw Error(`\u041D\u0435\u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u043D\u0430\u044F \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u0430\u044F \u0432 \u0444\u0443\u043D\u043A\u0446\u0438\u0438 GetTime: ${c}`);return`${l.first.isNew?"new":"old"}${n},TLB[${u}]`});return`env.stratum_getTime(${o.join(",")})`}if(r==="GETDATE"){const n=er.get(k.Float);if(!t)throw Error("\u0418\u043C\u0438\u0434\u0436 \u043D\u0435 \u0438\u043C\u0435\u0435\u0442 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0445");const o=e.args.map(l=>{const c=l.first.name,u=t.nameUCToId.get(c.toUpperCase());if(u===void 0)throw Error(`\u041D\u0435\u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u043D\u0430\u044F \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u0430\u044F \u0432 \u0444\u0443\u043D\u043A\u0446\u0438\u0438 GetDate: ${c}`);return`${l.first.isNew?"new":"old"}${n},TLB[${u}]`});return`env.stratum_getDate(${o.join(",")})`}if(r==="GETACTUALSIZE2D"){const n=er.get(k.Float);if(!t)throw Error("\u0418\u043C\u0438\u0434\u0436 \u043D\u0435 \u0438\u043C\u0435\u0435\u0442 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0445");const o=e.args.slice(0,2).map(c=>Pe(c,t)),l=e.args.slice(2,4).map(c=>{const u=c.first.name,f=t.nameUCToId.get(u.toUpperCase());if(f===void 0)throw Error(`\u041D\u0435\u043E\u043F\u0440\u0435\u0434\u0435\u043B\u0435\u043D\u043D\u0430\u044F \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u0430\u044F \u0432 \u0444\u0443\u043D\u043A\u0446\u0438\u0438 GetActualSize2d: ${u}`);return`${c.first.isNew?"new":"old"}${n},TLB[${f}]`});return`env.stratum_getActualSize2d(${o.join(",")},${l.join(",")})`}const i=e.args.map(n=>Pe(n,t));if(r==="NOT")return`((${i[0]})>0===true?0:1)`;if(r==="AND")return`(((${i[0]})>0&&(${i[1]})>0)===true?1:0)`;if(r==="SQR")return`(${i[0]})**2`;if(r==="ABS")return`(Math.abs(${i[0]})||0)`;if(r==="TRUNC")return`(Math.trunc(${i[0]})||0)`;if(r==="SQRT")return`(Math.sqrt(${i[0]})||0)`;if(r==="SIN")return`(Math.sin(${i[0]})||0)`;if(r==="COS")return`(Math.cos(${i[0]})||0)`;if(r==="MIN")return`(Math.min(${i[0]}, ${i[1]})||0)`;if(r==="MAX")return`(Math.max(${i[0]}, ${i[1]})||0)`;if(r==="AVERAGE")return`((${i[0]})/2+(${i[1]})/2)`;if(r==="HANDLE")return`(parseInt(${i[0]})||0)`;if(r==="FLOAT")return`(parseFloat(${i[0]})||0)`;if(r==="STRING")return`(Math.round((${i[0]})*100000)/100000).toString()`;if(r==="LENGTH")return`(${i[0]}).length`;if(r==="SUBSTR")return`(${i[0]}).substr(${i[1]},${i[2]})`;if(r==="LEFT")return`(${i[0]}).substr(0,${i[1]})`;if(r==="RIGHT")return`right(${i[0]}, ${i[1]})`;const s=ig.get(r);return s||Br.set(r,e.name),`${s||e.name}(${i.join(",")})`}case"expression":return`(${Pe(e.body,t)})`;default:throw console.log(e),Error(`\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u043E\u043F\u0435\u0440\u0430\u043D\u0434: ${e.type}`)}}function Pe(e,t){const r=Mi(e.first,t),i=e.rest.map(s=>s.action==="/"?`/(${Mi(s.op,t)} || Infinity)`:s.action+Mi(s.op,t));return r+i.join("")}let vs=!1;function pu(e,t){switch(e.type){case":=":{if(!t)throw Error("\u0418\u043C\u0438\u0434\u0436 \u043D\u0435 \u0438\u043C\u0435\u0435\u0442 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u044B\u0445");const r=t.nameUCToId.get(e.to.toUpperCase());if(r===void 0)throw Error(`\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u0430\u044F \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u0430\u044F: ${e.to}`);const i=er.get(t.types[r]);if(!i)throw Error(`\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u0442\u0438\u043F \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u043E\u0439: ${t.types[r]} ${e.to}`);return`new${i}[TLB[${r}]] = ${Pe(e.operand,t)};`}case"varsDec":return;case"=":vs=!0;return;case"switch":return"do{let exc=false;{";case"case":return`}if ((${Pe(e.expr.body,t)})&&exc===false) {exc=true;`;case"default":return"}if (exc===false) {exc=true;";case"endswitch":return"}}while(false);";case"if":case"while":return`${e.type} (${Pe(e.expr.body,t)}) {`;case"endif":case"endwhile":return"}";case"else":return"} else {";case"do":return"do {";case"until":return`}
while(${Pe(e.expr.body,t)});`;case"break":return"break;";case"callChain":return e.functions.map(r=>`${Mi(r,t)}`).join("; ")+";";default:throw Error(`\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u043E\u043F\u0435\u0440\u0430\u0442\u043E\u0440: ${e.type}`)}}const Br=new Map,Lr=new Map;function Ss(e,t,r){Br.clear();const i=uu(e);let s;try{s=fu.parse(i)}catch(o){throw console.log(i),Error(`\u041E\u0448\u0438\u0431\u043A\u0430 \u043F\u0430\u0440\u0441\u0438\u043D\u0433\u0430 ${r}: ${o.message}`)}if(s.length===0)return;if(s[0].type==="function"){console.warn(`\u041E\u0431\u044A\u044F\u0432\u043B\u0435\u043D\u0438\u0435 ${r} \u043A\u0430\u043A \u0444\u0443\u043D\u043A\u0446\u0438\u0438 \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D\u043E`);return}let n="";vs=ys=!1;for(let o=0;o<s.length;++o)try{const l=s[o];{const u=pu(l,t);u&&(n+=u+`
`)}let c=l.then;for(;c;){const u=pu(c,t);u&&(n+=u+`
`),c=c.then}}catch(l){throw console.log(i.split(`
`).filter(c=>c.trim()).map((c,u)=>`${u+1}: ${c}`).join(`
`)),Error(`\u041E\u0448\u0438\u0431\u043A\u0430 \u043A\u043E\u043C\u043F\u0438\u043B\u044F\u0446\u0438\u0438 ${r}: ${l.message} \u0432 \u0441\u0442\u0440\u043E\u043A\u0435 ${o+1}`)}if(vs&&console.warn(`\u0423\u0440\u0430\u0432\u043D\u0435\u043D\u0438\u044F \u0432 ${r} \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D\u044B`),ys&&console.warn(`${r}: \u0438\u0433\u043D\u043E\u0440\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u043F\u0440\u0438\u043C\u0435\u043D\u0435\u043D\u0438\u0435 \u043E\u043F\u0435\u0440\u0430\u0442\u043E\u0440\u0430 '~' \u043A \u043D\u0435 \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u043E\u0439`),n.length===0)return;console.log(`\u041A\u043E\u043C\u043F\u0438\u043B\u0438\u0440\u0443\u0435\u043C ${r}`),Br.size>0&&console.warn(`\u0424\u0443\u043D\u043A\u0446\u0438\u0438 ${[...Br.values()].join(", ")} \u0432 ${r} \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D\u044B.`),Br.forEach((o,l)=>Lr.set(l,o));try{return new Function("schema","env",sg+n+`//# sourceURL=${r}`)}catch(o){throw console.log(i.split(`
`).filter(l=>l.trim()).map((l,c)=>`${c+1}: ${l}`).join(`
`)),console.log(n),Error(`\u041E\u0448\u0438\u0431\u043A\u0430 eval ${r}: ${o.message}`)}}class og{constructor(e,t){this.view=e;this.origTitle=document.title,t&&(document.title=this.origTitle?`${this.origTitle} - ${t}`:t)}setTitle(e){document.title=e}setSize(e,t){const{view:{clientWidth:r,clientHeight:i,style:s}}=this;r!==e&&s.setProperty("width",e+"px"),i!==t&&s.setProperty("height",t+"px")}close(){this.view.remove(),document.title=this.origTitle}on(){}off(){}toTop(){}}class ag{constructor(e,t){this.wnd=e;this.handlers=new Set;this.sizedOnce=!1;t&&(e.document.title=t)}on(e,t){if(e!=="closed")return;this.wnd.addEventListener("beforeunload",t),this.handlers.add(t)}off(e,t){if(e!=="closed")return;t?(this.wnd.removeEventListener("beforeunload",t),this.handlers.delete(t)):(this.handlers.forEach(r=>this.wnd.removeEventListener("beforeunload",r)),this.handlers.clear())}setTitle(e){this.wnd.document.title=e}setSize(e,t){if(this.sizedOnce===!0)return;const{wnd:r}=this;r.addEventListener("resize",()=>r.resizeTo(e+r.outerWidth-r.innerWidth+15,t+r.outerHeight-r.innerHeight+15),{once:!0}),this.sizedOnce=!0}toTop(){}close(){this.off("closed"),this.wnd.close()}}class Ts{constructor(e){this.root=e}get width(){return window.innerWidth}get height(){return window.innerHeight}window({title:e,view:t}){if(this.root)return this.root.appendChild(t),new og(t,e);const r=window.open("about:blank",void 0,`width=${this.width/1.5},height=${this.height/1.5}`);if(!r)throw Error(`\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u043E\u0442\u043A\u0440\u044B\u0442\u044C \u043E\u043A\u043D\u043E ${e}`);return r.document.body.appendChild(t),new ag(r,e)}}class Es{constructor({dir:e,prjInfo:t,classes:r,stt:i,options:s}){this._state="closed";this._diag={iterations:0,missingCommands:[]};this._computer=new bu.SmoothExecutor;this.handlers={closed:new Set,error:new Set};this.host=new Ts;this.env=null;this.dir=e,this.prjInfo=t,this.classes=r,this.stt=i,this.options=C({},s)}get state(){return this._state}get diag(){return this._diag}get computer(){return this._computer}set computer(e){if(e===this._computer)return;this._computer.running&&(this._computer.stop(),this.loop&&e.run(this.loop)),this._computer=e}play(e){if(this.loop)return this;e&&(this.host=e instanceof HTMLElement?new Ts(e):e),Lr.clear();const t=this.env=new le(this.classes,this.dir,this.host),r=ye.build(this.prjInfo.rootClassName,this.classes,t);return Lr.size>0&&console.log(`\u041D\u0435\u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D\u043D\u044B\u0435 \u0444\u0443\u043D\u043A\u0446\u0438\u0438:
${[...Lr.values()].join(`
`)}`),t.init(r.createTLB()),r.applyDefaults(),this.stt&&r.applyVarSet(this.stt),this._diag.iterations=0,t.shouldClose=!1,this.loop=()=>{t.sync().assertZeroIndexEmpty();try{r.compute()}catch(i){return console.error(i),this._state="error",this.handlers.error.forEach(s=>s(i.message)),!1}return++this._diag.iterations,t.shouldClose===!0?(this.close(),this.handlers.closed.forEach(i=>i()),!1):!0},this.computer.run(this.loop),this._state="playing",this}close(){return this.computer.stop(),this.loop=void 0,this.env&&(this.env.closeAllWindows(),this.env=null),this._state="closed",this}pause(){return this.computer.running&&(this.computer.stop(),this._state="paused"),this}continue(){return!this.computer.running&&this.loop&&(this.computer.run(this.loop),this._state="playing"),this}step(){return!this.computer.running&&this.loop&&this.loop(),this}on(e,t){return this.handlers[e].add(t),this}off(e,t){return t?this.handlers[e].delete(t):this.handlers[e].clear(),this}}class lt{constructor(){this.disks=new Map}static fromZip(r){return ft(this,arguments,function*(e,t={}){const i=new TextDecoder(t.encoding||"cp866");let s;try{s=yield gu.loadAsync(e,{decodeFileName:u=>i.decode(u),createFolders:!1})}catch(u){const f=e instanceof File?`\u0424\u0430\u0439\u043B ${e.name}`:e instanceof Blob?`Blob { size: ${e.size}, type: ${e.type} }`:`${e.toString()}(${e.byteLength})`;throw Error(`${f} \u043D\u0435 \u044F\u0432\u043B\u044F\u0435\u0442\u0441\u044F ZIP-\u0430\u0440\u0445\u0438\u0432\u043E\u043C`)}const n=new lt,[o,l]=iu(t.directory||"",lt.defaultPrefix);let c=new at(o,n);n.disks.set(o,c);for(const u of l)c=c.createLocalDir(u);return s.forEach((u,f)=>{const S=u.split(hs);let g=c;for(let b=0;b<S.length-1;b++)g=g.createLocalDir(S[b]);f.dir||g.createLocalFile(S[S.length-1],f)}),n})}disk(e){return this.disks.get(e.toUpperCase())}merge(e){if(!(e instanceof lt))throw Error("fs is not instanceof VFS");const{disks:t}=e,{disks:r}=this;for(const[i,s]of t)r.set(i,(r.get(i)||new at(i,this)).merge(s));return this}*files(e){for(const t of this.disks.values())for(const r of t.files(e))yield r}project(){return ft(this,arguments,function*(e={}){var n;let t,r;{let o;const l=new Array,c=e.path&&Jt(e.path).join("\\").toUpperCase();for(const u of this.files(/.+\.(prj|spj)$/i)){if(c&&!u.pathDos.toUpperCase().includes(c))continue;o=u,l.push(u.pathDos)}if(l.length>1)throw Error(`\u041D\u0430\u0439\u0434\u0435\u043D\u043E \u043D\u0435\u0441\u043A\u043E\u043B\u044C\u043A\u043E \u0444\u0430\u0439\u043B\u043E\u0432 \u043F\u0440\u043E\u0435\u043A\u0442\u043E\u0432:
${l.join(`
`)}`);if(!o)throw Error("\u041D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u043E \u0444\u0430\u0439\u043B\u043E\u0432 \u043F\u0440\u043E\u0435\u043A\u0442\u043E\u0432");t=o.parent,console.log(`\u041E\u0442\u043A\u0440\u044B\u0432\u0430\u0435\u043C \u043F\u0440\u043E\u0435\u043A\u0442 ${o.pathDos}`),r=yield o.readAs("prj")}let i;{const o=new Set([t]),l=(n=r.settings)==null?void 0:n.classSearchPaths;if(l){const b=l.split(",").map(T=>T.trim()).filter(T=>T);for(const T of b){const O=t.get(T);(O==null?void 0:O.dir)&&o.add(O)}}const c=e.additionalClassPaths;if(c)for(const b of c){const T=(this.disks.get(lt.defaultPrefix)||t).get(b);(T==null?void 0:T.dir)&&o.add(T)}for(let b of o)for(;b!==b.parent;b=b.parent)o.has(b.parent)&&o.delete(b);const u=[...o];console.log(`\u041F\u0443\u0442\u0438 \u043F\u043E\u0438\u0441\u043A\u0430 \u0438\u043C\u0438\u0434\u0436\u0435\u0439:
${u.map(b=>b.pathDos).join(`;
`)}`);const f=u.map(b=>[...b.files(/.+\.cls$/i)]),S=new Array().concat(...f),g=yield Promise.all(S.map(b=>b.readAs("cls")));console.log(`\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043D\u043E ${S.length} \u0438\u043C\u0438\u0434\u0436\u0435\u0439 \u043E\u0431\u044A\u0435\u043C\u043E\u043C ${(g.reduce((b,T)=>b+T.byteSize,0)/1024).toFixed()} \u041A\u0411`),i=new ru(g)}let s;{const o=t.get("_preload.stt");if(o&&!o.dir)try{s=yield o.readAs("stt")}catch(l){console.warn(l.message)}}return new Es({dir:t,prjInfo:r,classes:i,stt:s,options:e})})}}lt.defaultPrefix="C";const xs=e=>Error(`\u041D\u0435\u0432\u043E\u0437\u043C\u043E\u0436\u043D\u043E \u0441\u043E\u0437\u0434\u0430\u0442\u044C \u043A\u0430\u0442\u0430\u043B\u043E\u0433 ${e} - \u043F\u043E \u044D\u0442\u043E\u043C\u0443 \u043F\u0443\u0442\u0438 \u0443\u0436\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442 \u0444\u0430\u0439\u043B.`);class at{constructor(e,t){this.localName=e;this.nodes=new Map;this.dir=!0;t instanceof at?(this.fs=t.fs,this.parent=t,this.pathDos=t.pathDos+"\\"+e):(this.fs=t,this.parent=this,us(e),this.pathDos=this.localName=e+":")}resolve(e){if(e.length===0)return;const t=e[0].length===2&&e[0][1]===":";let r;if(t){const s=this.fs.disk(e[0][0]);if(e.length===1)return s;if(s===void 0)return;r=s}else r=this;for(let s=t?1:0;s<e.length-1;s++)if(e[s]==="..")r=r.parent;else{const n=r.nodes.get(e[s].toUpperCase());if(!(n==null?void 0:n.dir))return;r=n}const i=e[e.length-1];return i===".."?r.parent:r.nodes.get(i.toUpperCase())}get(e){return this.resolve(Jt(e))}create(e,t,r){const i=Jt(t),s=this.resolve(i.slice(0,i.length-1));if(!(s==null?void 0:s.dir))return;const n=i[i.length-1],o=n.toUpperCase(),l=s.nodes.get(o);if(l)return l.dir&&e==="dir"?l:void 0;const c=e==="file"?new Fr(n,s,r):new at(n,s);return s.nodes.set(o,c),c}setLocalSafe(e,t){const{nodes:r}=this,i=r.size;if(r.set(e.toUpperCase(),t),r.size===i)throw Error(`\u041A\u043E\u043D\u0444\u043B\u0438\u043A\u0442 \u0438\u043C\u0435\u043D: ${t.pathDos}`)}createLocalFile(e,t){const r=new Fr(e,this,t);this.setLocalSafe(e,r)}createLocalDir(e){const{nodes:t}=this,r=e.toUpperCase(),i=t.get(r);if(i){if(i.dir)return i;throw xs(i.pathDos)}const s=new at(e,this);return t.set(r,s),s}merge({nodes:e}){const{nodes:t}=this;for(const[r,i]of e){let s=t.get(r);if(s&&!s.dir)throw xs(s.pathDos);if(i.dir){s||(s=new at(i.localName,this),t.set(r,s)),s.merge(i);continue}if(s)throw xs(s.pathDos);t.set(r,i.hardlink(this))}return this}*_files(){for(const e of this.nodes.values()){if(!e.dir){yield e;continue}for(const t of e._files())yield t}}*files(e){if(!e)return this._files();for(const t of this._files())e.test(t.pathDos)&&(yield t)}}var X;(function(e){e[e.CR_MATH=1]="CR_MATH",e[e.CR_MATHDATA=2]="CR_MATHDATA",e[e.CR_FLAGS=4]="CR_FLAGS",e[e.CR_VARS=5]="CR_VARS",e[e.CR_CHILDS=6]="CR_CHILDS",e[e.CR_LINKS=7]="CR_LINKS",e[e.CR_ICON=8]="CR_ICON",e[e.CR_SCHEME=9]="CR_SCHEME",e[e.CR_TEXT=10]="CR_TEXT",e[e.CR_VARSIZE=11]="CR_VARSIZE",e[e.CR_IMAGE=12]="CR_IMAGE",e[e.CR_CODE=13]="CR_CODE",e[e.CR_INFO=14]="CR_INFO",e[e.CR_VARS1=15]="CR_VARS1",e[e.CR_CHILDSname=16]="CR_CHILDSname",e[e.CR_CHILDSnameXY=17]="CR_CHILDSnameXY",e[e.CR_DEFICON=20]="CR_DEFICON",e[e.CR_CLASSTIME=21]="CR_CLASSTIME",e[e.CR_ICONFILE=22]="CR_ICONFILE",e[e.CR_HELPFILE=25]="CR_HELPFILE",e[e.CR_EQU=30]="CR_EQU",e[e.CR_MOVEINFO=31]="CR_MOVEINFO",e[e.RR_VERSION=40]="RR_VERSION",e[e.PR_MAINCLASS=100]="PR_MAINCLASS",e[e.PR_PASSWORD=101]="PR_PASSWORD",e[e.PR_VARS=102]="PR_VARS",e[e.PR_WATCH=103]="PR_WATCH",e[e.VR_CLASSES=1e3]="VR_CLASSES",e[e.VR_VARS=1001]="VR_VARS",e[e.VR_SETVAR=1002]="VR_SETVAR",e[e.CR_CLASSINFO=8e3]="CR_CLASSINFO",e[e.PPR_FIELDS=2048]="PPR_FIELDS",e[e.PPR_ADDFIELDS=2049]="PPR_ADDFIELDS",e[e.PPR_SCALEMODE=2050]="PPR_SCALEMODE",e[e.PPR_SCALECUSTOM=2051]="PPR_SCALECUSTOM",e[e.PPR_FIELDSMODE=2052]="PPR_FIELDSMODE",e[e.PPR_USEADDF=2053]="PPR_USEADDF",e[e.PPR_SRCRECT=2054]="PPR_SRCRECT",e[e.PPR_USESRC=2055]="PPR_USESRC",e[e.PPR_PAGECOUNT=2056]="PPR_PAGECOUNT",e[e.CLF_LOADED=1]="CLF_LOADED",e[e.CLF_PROJECT=2]="CLF_PROJECT",e[e.CLF_MODIFY=4]="CLF_MODIFY",e[e.CLF_READONLY=8]="CLF_READONLY",e[e.CLF_NORECURSE=16]="CLF_NORECURSE",e[e.CLF_ADDLIB=32]="CLF_ADDLIB",e[e.CLF_CURRENTPROJECT=64]="CLF_CURRENTPROJECT",e[e.CLF_LIBRARY=256]="CLF_LIBRARY",e[e.CLF_PACKFILE=512]="CLF_PACKFILE",e[e.CF_PROTECTED=1]="CF_PROTECTED",e[e.CF_ONEFASE=2]="CF_ONEFASE",e[e.CF_COMPILED=4]="CF_COMPILED",e[e.CF_VIRTUAL=8]="CF_VIRTUAL",e[e.CF_SCHEME=16]="CF_SCHEME",e[e.CF_MODIFY=32]="CF_MODIFY",e[e.CF_HAS_DISABLE_VAR=64]="CF_HAS_DISABLE_VAR",e[e.CF_BUILDIN=256]="CF_BUILDIN",e[e.CF_ICON=512]="CF_ICON",e[e.CF_PROCEDURE=1024]="CF_PROCEDURE",e[e.CF_STRUCTURE=2048]="CF_STRUCTURE",e[e.CF_USEDEFICON=4096]="CF_USEDEFICON",e[e.CF_SIZEABLE=8192]="CF_SIZEABLE",e[e.CF_HAS_ENABLE_VAR=16384]="CF_HAS_ENABLE_VAR",e[e.TCF_WASSAVE=1]="TCF_WASSAVE",e[e.TCF_NEWCLASS=2]="TCF_NEWCLASS",e[e.OF_DISABLED=1]="OF_DISABLED",e[e.OF_ONEFASE=2]="OF_ONEFASE",e[e.OF_ERROR=4]="OF_ERROR",e[e.LF_DISABLED=1]="LF_DISABLED",e[e.LF_AUTOLINK=2]="LF_AUTOLINK",e[e.VF_LOCAL=2]="VF_LOCAL",e[e.VF_NOREAD=4]="VF_NOREAD",e[e.VF_NOWRITE=8]="VF_NOWRITE",e[e.VF_STATIC=16]="VF_STATIC",e[e.VF_ONSCHEME=32]="VF_ONSCHEME",e[e.VF_PARAMETER=64]="VF_PARAMETER",e[e.VF_LEFT=128]="VF_LEFT",e[e.VF_EQVAR=256]="VF_EQVAR",e[e.VF_ARGUMENT=512]="VF_ARGUMENT",e[e.VF_RETURN=1024]="VF_RETURN",e[e.VF_NOSAVE=2048]="VF_NOSAVE",e[e.VF_GLOBAL=4096]="VF_GLOBAL",e[e.VF_CLASSGLOBAL=8192]="VF_CLASSGLOBAL",e[e.SF_EXTERNAL=1]="SF_EXTERNAL",e[e.SF_EDITING=2]="SF_EDITING",e[e.STATE_FAST=0]="STATE_FAST",e[e.STATE_VARS=1]="STATE_VARS",e[e.STATE_DEBUG=2]="STATE_DEBUG",e[e.STATE_SET=3]="STATE_SET",e[e.CHF_NEEDCREATE=1]="CHF_NEEDCREATE",e[e.CHF_NEEDUPDATE=2]="CHF_NEEDUPDATE",e[e.CHF_WASSIZED=4]="CHF_WASSIZED",e[e.CHF_PREPROCESS=8]="CHF_PREPROCESS",e[e.CHF_POSTPROCESS=16]="CHF_POSTPROCESS",e[e.IF_CORRECTED=1]="IF_CORRECTED",e[e.EF_RUNNING=1]="EF_RUNNING",e[e.EF_MUSTSTOP=2]="EF_MUSTSTOP",e[e.EF_STEPACTIVE=4]="EF_STEPACTIVE",e[e.EF_EQUACTIVE=8]="EF_EQUACTIVE",e[e.EF_MSGACTIVE=16]="EF_MSGACTIVE",e[e.EF_BYTIMER=32]="EF_BYTIMER"})(X||(X={}));function _u(e){e.bytes(1)}function lg(e){_u(e),e.uint16()}function hg(e){return e.uint16()}function ug(e){const t=e.uint16(),r=e.uint16(),i=e.bytes(r);return{id:t,size:r,data:i}}function cg(e){return{fgColor:e.int32(),bgColor:e.int32(),fontHandle:e.uint16(),stringHandle:e.uint16()}}function ht(e){lg(e)}function dg(){return hg}function fg(e){return _u(e),ug}function mg(){return cg}function wu(e){e.otPRIMARYCOLLECTION=dg,e.otDATAITEMS=fg,e.otOBJECTCOLLECTION=ht,e.otPENCOLLECTION=ht,e.otBRUSHCOLLECTION=ht,e.otDOUBLEDIBCOLLECTION=ht,e.otFONTCOLLECTION=ht,e.otSTRINGCOLLECTION=ht,e.otTEXTCOLLECTION=ht,e.otDIBCOLLECTION=ht,e.otLOGTEXTCOLLECTION=mg}var he;(function(e){e[e.otGROUP=1]="otGROUP",e[e.otCOLLECTION=1e3]="otCOLLECTION",e[e.otPOINTCOLLECTION=1001]="otPOINTCOLLECTION",e[e.otPENCOLLECTION=1004]="otPENCOLLECTION",e[e.otBRUSHCOLLECTION=1005]="otBRUSHCOLLECTION",e[e.otDIBCOLLECTION=1006]="otDIBCOLLECTION",e[e.otDOUBLEDIBCOLLECTION=1007]="otDOUBLEDIBCOLLECTION",e[e.otFONTCOLLECTION=1008]="otFONTCOLLECTION",e[e.otSTRINGCOLLECTION=1009]="otSTRINGCOLLECTION",e[e.otTEXTCOLLECTION=1010]="otTEXTCOLLECTION",e[e.otLOGTEXTCOLLECTION=1011]="otLOGTEXTCOLLECTION",e[e.ot3DCOLLECTION=1012]="ot3DCOLLECTION",e[e.otOBJECTCOLLECTION=1020]="otOBJECTCOLLECTION",e[e.otPRIMARYCOLLECTION=1021]="otPRIMARYCOLLECTION",e[e.otDATAITEMS=1022]="otDATAITEMS",e[e.otMATERIALS3D=1024]="otMATERIALS3D",e[e.otSPACE2D=17458]="otSPACE2D",e[e.otSPACE3D=17459]="otSPACE3D",e[e.otSPACE3Df=25668]="otSPACE3Df",e[e.otGROUP2D=3]="otGROUP2D",e[e.otRGROUP2D=4]="otRGROUP2D",e[e.otGROUP3D=5]="otGROUP3D",e[e.otOBJECT3D=10]="otOBJECT3D",e[e.otCAMERA3D=11]="otCAMERA3D",e[e.otLIGHT3D=12]="otLIGHT3D",e[e.otLINE2D=20]="otLINE2D",e[e.otBITMAP2D=21]="otBITMAP2D",e[e.otDOUBLEBITMAP2D=22]="otDOUBLEBITMAP2D",e[e.otTEXT2D=23]="otTEXT2D",e[e.otVIEW3D2D=24]="otVIEW3D2D",e[e.otUSEROBJECT2D=25]="otUSEROBJECT2D",e[e.otCONTROL2D=26]="otCONTROL2D",e[e.otEDITFRAME2D=50]="otEDITFRAME2D",e[e.otROTATECENTER2D=51]="otROTATECENTER2D",e[e.otFRAME3D=52]="otFRAME3D",e[e.otAXIS3D=53]="otAXIS3D",e[e.ttPEN2D=101]="ttPEN2D",e[e.ttBRUSH2D=102]="ttBRUSH2D",e[e.ttDIB2D=103]="ttDIB2D",e[e.ttDOUBLEDIB2D=104]="ttDOUBLEDIB2D",e[e.ttFONT2D=105]="ttFONT2D",e[e.ttSTRING2D=106]="ttSTRING2D",e[e.ttTEXT2D=107]="ttTEXT2D",e[e.ttREFTODIB2D=110]="ttREFTODIB2D",e[e.ttREFTODOUBLEDIB2D=111]="ttREFTODOUBLEDIB2D",e[e.ctINFONAME=200]="ctINFONAME",e[e.ctINFOAUTOR=201]="ctINFOAUTOR",e[e.ctINFOINFO=202]="ctINFOINFO",e[e.ctCRDSYSTEM=203]="ctCRDSYSTEM",e[e.stSPACEDATA=204]="stSPACEDATA",e[e.stOBJNAME=205]="stOBJNAME"})(he||(he={}));function yu(e){return{handle:e.uint16(),options:e.uint16(),name:e.meta.fileversion>=258&&e.meta.fileversion<768?e.string():""}}function Mr(e){const t=yu(e);return e.meta.fileversion<512?C(C({},t),{originX:e.int16(),originY:e.int16(),width:e.int16(),height:e.int16()}):C(C({},t),{originX:e.float64(),originY:e.float64(),width:e.float64(),height:e.float64()})}function vu(e){return C(C({},yu(e)),{childHandles:ve(e,!0,he.otPRIMARYCOLLECTION).data})}function pg(e){return vu(e)}function bg(e){const t=C(C({},Mr(e)),{penHandle:e.uint16(),brushHandle:e.uint16()}),r=e.uint16()*2;t.coords=new Array(r);for(let s=0;s<r;s+=2)e.meta.fileversion<512?(t.coords[s+0]=e.int16(),t.coords[s+1]=e.int16()):(t.coords[s+0]=e.float64(),t.coords[s+1]=e.float64());if(e.meta.fileversion<=512)return t;const i=e.byte();return i&&(t.arrows=e.bytes(i)),t}function Su(e){const t=e.meta.fileversion;return C(C({},Mr(e)),{hidden:!1,cropX:t<512?e.int16():e.float64(),cropY:t<512?e.int16():e.float64(),cropW:t<512?e.int16():e.float64(),cropH:t<512?e.int16():e.float64(),angle:e.int16(),dibHandle:e.uint16()})}function gg(e){return C(C({},Mr(e)),{textToolHandle:e.uint16(),delta:e.meta.fileversion<512?e.point2dInt():e.point2d(),angle:e.int16()})}function _g(e){const t=C(C({},Mr(e)),{className:e.string().toUpperCase(),text:e.string(),dwStyle:e.int32(),exStyle:e.int32(),id:e.uint16(),controlSize:e.point2dInt()});if(!["EDIT","BUTTON","COMBOBOX"].includes(t.className))throw Error(`\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u0442\u0438\u043F \u043A\u043E\u043D\u0442\u0440\u043E\u043B\u0430: ${t.className}`);return e.uint16(),t}function wg(e){return Mr(e)}function Tu(e){e.otGROUP=vu,e.otGROUP2D=pg,e.otLINE2D=bg,e.otBITMAP2D=Su,e.otDOUBLEBITMAP2D=Su,e.otTEXT2D=gg,e.otCONTROL2D=_g,e.otSPACE2D=wg}function ut(e){return{refCount:e.uint16(),handle:e.uint16()}}function yg(e){return C(C({},ut(e)),{color:e.int32(),style:e.int16(),width:e.int16(),rop2:e.int16()})}function vg(e){return C(C({},ut(e)),{color:e.int32(),style:e.int16(),hatch:e.int16(),rop2:e.int16(),dibHandle:e.uint16()})}function Sg(e){return C(C({},ut(e)),{img:Ni(e)})}function Tg(e){return C(C({},ut(e)),{img:Qt(e)})}function Eg(e){const t=ut(e),r=e.position,i=C(C({},t),{height:e.int16(),width:e.int16(),escapement:e.int16(),orientation:e.int16(),weight:e.int16(),italic:e.byte(),underline:e.byte(),strikeOut:e.byte(),charSet:e.byte(),outPrecision:e.byte(),clipPrecision:e.byte(),quality:e.byte(),pitchAndFamily:e.byte(),fontName:e.nulltString(32)});return e.seek(r+50),e.meta.fileversion>=515?(i.size=e.int32(),i.style=e.int32()):(i.size=22,i.style=0),i}function xg(e){return C(C({},ut(e)),{text:e.string()})}function Ig(e){return C(C({},ut(e)),{textCollection:ve(e,!0,he.otLOGTEXTCOLLECTION).data})}function Eu(e){return C(C({},ut(e)),{filename:e.string()})}function Og(e){return Eu(e)}function xu(e){e.ttPEN2D=yg,e.ttBRUSH2D=vg,e.ttDIB2D=Sg,e.ttDOUBLEDIB2D=Tg,e.ttFONT2D=Eg,e.ttSTRING2D=xg,e.ttTEXT2D=Ig,e.ttREFTODIB2D=Eu,e.ttREFTODOUBLEDIB2D=Og}const Is={},Pi={};(function(){wu(Is),Tu(Pi),xu(Pi)})();class tr{constructor(e){if(this.stream=e,this.start=e.position,this.code=e.int16(),e.meta.fileversion>=768&&(this.size=e.int32()),this.size<0)throw Error("chunk size < 0")}hasData(){return this.size>this.readedBytes()}readedBytes(){return this.stream.position-this.start}readNextSubChunk(){return this.start+this.size<=this.stream.position?0:new tr(this.stream)}goEnd(){this.stream.seek(this.start+this.size)}checkReaded(){const e=this.readedBytes();if(e>this.size)throw Error(`Chunk data out of range: ${e} instead of ${this.size}`);if(e<this.size)throw Error(`Chunk not readed: ${e} instead of ${this.size}`)}}function ve(e,t,r){const i=new tr(e);if(i.code===-1)return;if(i.code===0)throw Error("Chunk not an object or collection");if(r!==void 0&&r!==i.code)throw Error(`Chunk code is ${i.code} instead of ${r}`);if(i.code===203){const l=e.uint16(),c=e.int16(),u=e.point2d(),f=Array.from({length:9},()=>e.float64());i.checkReaded();const S={type:l,objectHandle:c,center:u,matrix:f};return{type:"crdSystem",data:S}}const s=i.code>999&&i.code<1200;if(t&&!s)throw Error("not a collection: "+i.code);const n=Object.keys(he).find(l=>he[l]===i.code);if(n===void 0)throw Error(`Unknown ${s?"collection":"object"}: ${i.code}`);const o=(s?Iu:Ag)(e,n);if(e.meta.fileversion<768)return Array.isArray(o)?{type:n,data:o}:C({type:n},o);for(;i.hasData();){const l=new tr(e);switch(l.code){case he.otDATAITEMS:Iu(e,"otDATAITEMS");break;case he.stOBJNAME:o.name=e.fixedString(l.size-l.readedBytes());break;default:throw Error("Unknown postchunk: "+l.code)}}return i.checkReaded(),Array.isArray(o)?{type:n,data:o}:C({type:n},o)}function Iu(e,t){const r=e.uint16();e.uint16(),e.uint16();const i=Is[t];if(!i)throw Error("No get item function for "+t);const s=i(e)||ve,n=new Array(r);for(let o=0;o<r;o++)n[o]=s(e);return n}function Ag(e,t){const r=Pi[t];if(!r)throw Error("No item function for "+t);return r(e)}function Dg(e,t){const r=new tr(e);if(r.code!==he.stSPACEDATA)throw"\u041E\u0448\u0438\u0431\u043A\u0430 \u0432 \u0447\u0442\u0435\u043D\u0438\u0438 VDR \u0444\u043E\u0440\u043C\u0430\u0442\u0430 3x";for(t.origin=e.point2d(),t.scale_div=e.point2d(),t.scale_mul=e.point2d(),t.state=e.uint16(),t.brushHandle=e.uint16(),t.layers=e.uint32(),t.defaultFlags=e.uint16();r.hasData();){const{type:i,data:s}=ve(e,!0);t[i]=s}r.checkReaded()}function Ng(e,t,r){const i=e.int32()+r,s=e.int32()+r,n=()=>e.meta.fileversion<512?e.point2dInt():e.point2d();t.origin=n(),t.scale_div=n(),t.scale_mul=n(),e.string(),t.state=e.uint16(),e.string(),e.string(),e.string(),ve(e,!1),ve(e,!1),t.brushHandle=e.uint16(),e.seek(i),t.otPRIMARYCOLLECTION=ve(e,!0,he.otPRIMARYCOLLECTION).data,t.otOBJECTCOLLECTION=ve(e,!0,he.otOBJECTCOLLECTION).data,e.seek(s);const o=e.uint16();for(let l=0;l<o;l++){const{type:c,data:u}=ve(e,!0);t[c]=u}if(e.meta.fileversion>258){t.layers=e.uint32(),t.defaultFlags=e.uint16();let l=e.uint16();for(;l;){switch(l){case 0:break;default:return}l=e.uint16()}}else t.layers=0,t.defaultFlags=0;e.string()}function kg(e){const t=e.uint16();if(t!==17458)throw new Me(e,t,17458);const r=e.position,i={fileversion:e.uint16(),minVersion:e.uint16()};return e.meta.fileversion=i.fileversion,i.fileversion>=768?Dg(e,i):Ng(e,i,r),i}const Rg={otBRUSHCOLLECTION:"brushTools",otPENCOLLECTION:"penTools",otDIBCOLLECTION:"dibTools",otDOUBLEDIBCOLLECTION:"doubleDibTools",otSTRINGCOLLECTION:"stringTools",otFONTCOLLECTION:"fontTools",otTEXTCOLLECTION:"textTools",otOBJECTCOLLECTION:"elements",otPRIMARYCOLLECTION:"elementOrder"};function Bg(e){for(const t of Object.keys(e)){const r=Rg[t];if(!r)continue;const i=e[t];delete e[t],e[r]=i}return e}function Ui(e){return Bg(kg(e))}function Lg(e){const t=e.uint16(),r=new Array(t);for(let i=0;i<t;i++){const s=e.string(),n=e.string(),o=e.string(),l=e.string().toUpperCase();if(l!=="STRING"&&l!=="FLOAT"&&l!=="INTEGER"&&l!=="HANDLE"&&l!=="COLORREF")throw new ot(e,`\u043D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u0442\u0438\u043F \u043F\u0435\u0440\u0435\u043C\u0435\u043D\u043D\u043E\u0439: ${l}.`);const c=e.int32();r[i]={name:s,description:n,defaultValue:o,type:l,flags:c}}return r}function Fg(e){const t=e.uint16(),r=new Array(t);for(let i=0;i<t;i++){const s=e.uint16(),n=e.uint16(),o=e.uint16(),l=e.int32(),c=e.uint16(),u=e.uint16(),f=new Array(c);for(let S=0;S<c;S++){const g=e.string(),b=e.string();f[S]={name1:g,name2:b}}r[i]={handle1:s,handle2:n,linkHandle:o,flags:l,connectedVars:f,contactPadHandle:u}}return r}function Mg(e){const t=e.uint16(),r=new Array(t);for(let i=0;i<t;i++){const s=e.string(),n=e.uint16(),o=e.string();if(!e.meta.fileversion)throw Error("filversion?");const l=e.meta.fileversion<12290?e.point2dInt():e.point2d(),c=e.byte();r[i]={classname:s,schemeInfo:{handle:n,name:o,position:l},flags:c}}return r}function Ou(e,t,r){var l;const i=e.int32();if(i&X.SF_EXTERNAL){const c=e.string();console.warn(`${r} ${t} (${e.meta.filepathDos||"?"}): \u043E\u0448\u0438\u0431\u043A\u0430 \u0447\u0442\u0435\u043D\u0438\u044F.
\u041F\u0440\u0438\u0447\u0438\u043D\u0430: \u0447\u0442\u0435\u043D\u0438\u0435 \u0432\u043D\u0435\u0448\u043D\u0438\u0445 VDR (${c}) \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D\u043E.`);return}const s=e.bytes(e.int32()),n=new st(s);let o;try{o=Ui(n)}catch(c){console.warn(`${r} ${t} (${e.meta.filepathDos||"?"}): \u043E\u0448\u0438\u0431\u043A\u0430 \u0447\u0442\u0435\u043D\u0438\u044F.
\u041F\u0440\u0438\u0447\u0438\u043D\u0430: ${c.message}`);return}if(o.source={origin:"class",name:t},n.position!==n.size){const c=n.position,u=n.size-c,f=((l=n.meta.fileversion)==null?void 0:l.toString(16))||"?",S=`${r} ${t} (${e.meta.filepathDos||"?"}): \u0441\u0447\u0438\u0442\u0430\u043D\u043E ${c} \u0431\u0430\u0439\u0442\u043E\u0432, \u043D\u0435 \u0441\u0447\u0438\u0442\u0430\u043D\u043E ${u}. v0x${f}.`;console.warn(S)}return o}function Au(e){const t=e.uint16();if(t!==16979)throw new Me(e,t,16979);const r=e.int32();e.int32(),e.int32();const i=e.string();return{name:i,version:r}}function Du(e,t,r){const i={};let s=e.uint16();if(s===X.CR_VARS1&&(i.vars=Lg(e),s=e.uint16()),s===X.CR_LINKS&&(i.links=Fg(e),s=e.uint16()),(s===X.CR_CHILDSnameXY||s===X.CR_CHILDSname||s===X.CR_CHILDS)&&(i.children=Mg(e),s=e.uint16()),s===X.CR_ICON){const n=e.int32();e.skip(n-4),s=e.uint16()}if(s===X.CR_SCHEME){const n=e.int32();r.readScheme?i.scheme=Ou(e,t,"\u0421\u0445\u0435\u043C\u0430"):e.skip(n-4),s=e.uint16()}if(s===X.CR_IMAGE){const n=e.int32();r.readImage?i.image=Ou(e,t,"\u0418\u0437\u043E\u0431\u0440\u0430\u0436\u0435\u043D\u0438\u0435"):e.skip(n-4),s=e.uint16()}if(s===X.CR_TEXT&&(i.sourceCode=e.string(),s=e.uint16()),s===X.CR_INFO&&(i.description=e.string(),s=e.uint16()),s===X.CR_VARSIZE&&(i.varsize=e.uint16(),s=e.uint16()),s===X.CR_FLAGS&&(i.flags=e.int32(),s=e.uint16()),s===X.CR_DEFICON&&(i.iconIndex=e.uint16(),s=e.uint16()),s===X.CR_ICONFILE&&(i.iconFile=e.string(),s=e.uint16()),s===X.CR_CODE){const n=e.int32()*2;if(r.parseBytecode!==void 0){const o=e.bytes(n);try{i.code=r.parseBytecode(o)}catch(l){console.warn(`\u0411\u0430\u0439\u0442\u043A\u043E\u0434 ${t} (${e.meta.filepathDos||"?"}): \u043E\u0448\u0438\u0431\u043A\u0430 \u0447\u0442\u0435\u043D\u0438\u044F.
\u041F\u0440\u0438\u0447\u0438\u043D\u0430: ${l.message}`)}}else e.skip(n);s=e.uint16()}return s===X.CR_EQU?(console.warn(`${t} (${e.meta.filepathDos||"?"}):
\u0423\u0440\u0430\u0432\u043D\u0435\u043D\u0438\u044F \u043D\u0435 \u043F\u043E\u0434\u0434\u0435\u0440\u0436\u0438\u0432\u0430\u044E\u0442\u0441\u044F.`),i):(s!==X.CR_CLASSTIME&&e.meta.fileversion===12291&&console.warn(`${t} (${e.meta.filepathDos||"?"}: \u0442\u0443\u0442 \u0447\u0442\u043E-\u0442\u043E \u043D\u0435 \u0442\u0430\u043A...`),i)}class zi{constructor(e){this._enableVarId=-1;this._disableVarId=-1;this.msgVarId=-1;this._hobjectVarId=-1;this.iditemVarId=-1;this.wnotifycodeVarId=-1;this.nwidthVarId=-1;this.nheightVarId=-1;this.xposVarId=-1;this.yposVarId=-1;this.fwkeysVarId=-1;this.orgxVarId=-1;this.orgyVarId=-1;this._objnameVarId=-1;this._classnameVarId=-1;this.compiled=!1;const t=this.filepathDos=e.meta.filepathDos||"";this.directoryDos=t.substring(0,t.lastIndexOf("\\")+1),this.byteSize=e.size;const r=Au(e);this.name=r.name,e.meta.fileversion=r.version,this.__body={loaded:!1,stream:e}}get children(){return this.body.children}get links(){return this.body.links}get image(){return this.body.image}get iconFile(){return this.body.iconFile}get iconIndex(){return this.body.iconIndex}get scheme(){return this.body.scheme}alwaysUseIcon(){return(this.body.flags||0)&4096}get vars(){if(typeof this._vars!="undefined")return this._vars;const e=this.body.vars;if(!e)return this._vars={count:0,nameUCToId:new Map,defaultValues:[],types:[]};const t=e.map(i=>i.name.toUpperCase()),r=e.map(i=>{switch(i.type){case"FLOAT":case"INTEGER":return k.Float;case"HANDLE":return k.Handle;case"STRING":return k.String;case"COLORREF":return k.ColorRef}});for(let i=0;i<e.length;i++){const s=t[i],n=r[i];s==="_ENABLE"&&n===k.Float?this._enableVarId=i:s==="_DISABLE"&&n===k.Float?this._disableVarId=i:s==="MSG"&&n===k.Float?this.msgVarId=i:s==="_HOBJECT"&&n===k.Handle?this._hobjectVarId=i:s==="IDITEM"&&n===k.Float?this.iditemVarId=i:s==="WNOTIFYCODE"&&n===k.Float?this.wnotifycodeVarId=i:s==="NWIDTH"&&n===k.Float?this.nwidthVarId=i:s==="NHEIGHT"&&n===k.Float?this.nheightVarId=i:s==="XPOS"&&n===k.Float?this.xposVarId=i:s==="YPOS"&&n===k.Float?this.yposVarId=i:s==="FWKEYS"&&n===k.Float?this.fwkeysVarId=i:s==="ORGX"&&n===k.Float?this.orgxVarId=i:s==="ORGY"&&n===k.Float?this.orgyVarId=i:s==="_OBJNAME"&&n===k.String?this._objnameVarId=i:s==="_CLASSNAME"&&n===k.String&&(this._classnameVarId=i)}return this._vars={count:e.length,nameUCToId:new Map(t.map((i,s)=>[i,s])),types:r,defaultValues:e.map((i,s)=>i.defaultValue!==""?Fi(r[s],i.defaultValue):void 0)}}get model(){if(this.compiled===!0)return this._model;const{sourceCode:e}=this.body;if(e===void 0){this.compiled=!0;return}return this._model=Ss(e,this.vars,this.name),this.compiled=!0,this._model}get body(){const{__body:e}=this;if(e.loaded)return e.data;console.log(`\u0427\u0438\u0442\u0430\u0435\u043C ${this.name} (${e.stream.meta.filepathDos})`);const t=Du(e.stream,this.name,zi.blocks);return this.__body={loaded:!0,data:t},t}}zi.blocks={readScheme:!0,readImage:!0};const Pg={addlib:"classSearchPaths",MathMode:"mathmode",PerIdle:"perIdle",run_mode:"runMode",runtimer:"runTimer",user_email:"userEmail",user_name:"userName",user_addr:"userAddress",user_org:"userOrganization",user_phone:"userPhone"};function Ug(e){const t={},r=e.uint16();for(let i=0;i<r;i++){const s=e.uint16(),n=e.byte(),o=e.byte(),l=e.fixedString(o-1);e.byte();let c;switch(n){case 0:c=e.int32();break;case 1:c=e.float64();break;case 2:c=e.fixedString(s-o-3),e.byte();break;default:throw new ot(e,`\u041E\u0448\u0438\u0431\u043A\u0430 \u0432 \u0447\u0442\u0435\u043D\u0438\u0438 \u043D\u0430\u0441\u0442\u0440\u043E\u0435\u043A \u043F\u0440\u043E\u0435\u043A\u0442\u0430: \u043D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u044B\u0439 \u043A\u043E\u0434 \u0437\u043D\u0430\u0447\u0435\u043D\u0438\u044F ${n}`)}const u=Pg[l];u?t[u]=c:console.warn(`\u041D\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u043D\u0430\u044F \u0437\u0430\u043F\u0438\u0441\u044C \u0432 \u043D\u0430\u0441\u0442\u0440\u043E\u0439\u043A\u0430\u0445 \u043F\u0440\u043E\u0435\u043A\u0442\u0430: ${l} (${c})`)}return t}function zg(e){const t=e.uint16(),r=new Array(t);for(let i=0;i<t;i++){const s=Array.from({length:e.uint16()},()=>e.uint16()),n=e.string(),o=e.string();r[i]={path:s,name:n,info:o}}return r}function Nu(e){const t=e.uint16();if(t!==26697)throw new Me(e,t,26697);const r={rootClassName:""};let i=0;for(;(i=e.uint16())!==0;)switch(i){case X.PR_PASSWORD:e.string(),console.warn("\u041F\u0440\u043E\u0435\u043A\u0442 \u0438\u043C\u0435\u0435\u0442 \u043F\u0430\u0440\u043E\u043B\u044C");break;case X.PR_MAINCLASS:r.rootClassName=e.string();break;case X.PR_VARS:r.settings=Ug(e);break;case X.PR_WATCH:r.watchedVariables=zg(e);break}if(!r.rootClassName)throw new ot(e,"\u0418\u043C\u044F \u043A\u043E\u0440\u043D\u0435\u0432\u043E\u0433\u043E \u0438\u043C\u0438\u0434\u0436\u0430 \u043D\u0435 \u0441\u0447\u0438\u0442\u0430\u043D\u043E.");return r}function ku(e){const t=e.int32(),r=e.uint16(),i=e.string(),s=e.int32(),n=Array.from({length:e.uint16()},()=>({name:e.string(),value:e.string()})),o=[];for(;e.position<t;)o.push(ku(e));return{handle:r,classname:i,classId:s,values:n,childSets:o}}function Ru(e){const t=e.uint16();if(t!==19)throw new Me(e,t,19);e.seek(21),e.string(),e.uint16(),e.uint16();switch(e.uint16()){case X.VR_CLASSES:throw new ot(e,"\u0411\u043B\u043E\u043A VR_CLASSES \u043D\u0435 \u0440\u0435\u0430\u043B\u0438\u0437\u043E\u0432\u0430\u043D.");case X.VR_SETVAR:return ku(e)}return{values:[],childSets:[],handle:0,classname:"",classId:0}}class Fr{constructor(e,t,r){this.localName=e;this.dir=!1;this.startLoading=!1;this.warnShowed=!1;this.buf=r||new ArrayBuffer(0),this.parent=t,this.pathDos=t.pathDos+"\\"+e}hardlink(e,t){return new Fr(t||this.localName,e,this.buf)}arraybuffer(){return ft(this,null,function*(){return this.buf instanceof ArrayBuffer||(this.buf=yield this.buf.async("arraybuffer")),this.buf})}makeSync(){return ft(this,null,function*(){yield this.arraybuffer()})}read(e,t){if(this.cache)return this.cache;const r=new st(e,{filepathDos:this.pathDos});switch(t){case"prj":return this.cache=Nu(r);case"cls":return this.cache=new zi(r);case"stt":return this.cache=Ru(r);case"vdr":{const i=this.cache=Ui(r);if(i.source={origin:"file",name:this.pathDos},r.position!==r.size){const s=`${this.pathDos}: \u0441\u0447\u0438\u0442\u0430\u043D\u043E ${r.position} \u0431\u0430\u0439\u0442\u043E\u0432, \u043D\u0435 \u0441\u0447\u0438\u0442\u0430\u043D\u043E ${r.size-r.position}. v0x${r.meta.fileversion&&r.meta.fileversion.toString(16)}.`;console.warn(s)}return i}case"bmp":return this.cache=Ni(r);case"dbm":return this.cache=Qt(r)}}readAs(e){return ft(this,null,function*(){const t=yield this.arraybuffer();return this.read(t,e)})}readSyncAs(e){const{buf:t}=this;if(!(t instanceof ArrayBuffer)){if(this.startLoading)return;this.startLoading=!0,t.async("arraybuffer").then(r=>this.buf=r),console.warn(`${this.pathDos} \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u0442\u0441\u044F \u0430\u0441\u0438\u043D\u0445\u0440\u043E\u043D\u043D\u043E.`);return}try{return this.read(t,e)}catch(r){this.warnShowed||(console.warn(`${this.pathDos}: \u043E\u0448\u0438\u0431\u043A\u0430 \u0447\u0442\u0435\u043D\u0438\u044F.
\u041F\u0440\u0438\u0447\u0438\u043D\u0430: ${r.message}`),this.warnShowed=!0);return}}}function Bu(e,t){return lt.fromZip(e,t)}return Rr();})();
