# stratum-player

Проигрыватель проектов Stratum 2000 в браузере.

## Как запустить?

Создайте каталог _example_, в нем файл _index.html_ со следующим содержимым:

```
<script src="stratum.min.js"></script>
<script>
    fetch("balls.zip") // Запрашиваем ZIP-архив с интернет-ресурса,
        .then(r => r.blob()) // загружаем его,
        .then(stratum.unzip) //затем распаковываем,
        .then(fs => fs.project()) //открываем в нем первый попавшийся проект,
        .then(p => p.play(document.body)); // и запускаем на выполнение, используя body как корень открываемого окна.
</script>
```

Cкопируйте в тот же каталог скрипт библиотеки (_dist/stratum.min.js_) и проект _static/projects/balls.zip_
Установите какой-нибудь простой файловый сервер, например [serve](https://www.npmjs.com/package/serve),
и запустите хостинг каталога:

```
serve example
```

Проект будет доступен тут - http://localhost:5000

## Запуск моих проектов Stratum 2000

Ваш проект Stratum с большой вероятностью использует имиджи из стандартной
библиотеки. Поэтому, чтобы запустить его способом, описанным выше, нужно также упаковать их в архив.
Для этого скопируйте папку _C:\Program Files\Stratum 2000\library_ в папку с
вашим проектом, перед тем, как запаковать его.

Существуеет [плеер](https://khokm.github.io/stratum-player/), построеннный на
базе этой библиотеки.
Он автоматически подгружает стандартную библиотеку имиджей, поэтому для запуска проектов на нем
вам не нужно предварительно добавлять ее архив с проектом, поскольку это вызовет конфликт имен имиджей.

## API

API библиотеки описано в `dist/stratum.d.ts`.

## Сборка библиотеки, запуск тестов.

Необходим установленный [Node.js](https://nodejs.org/en/)

### Установка зависимостей

```
npm -g install esbuild typescript browserify
npm install
```

### Запуск демо

```
npm run live
```

### Юнит-тесты

```
npm run unit
```

### Сборка

```
npm run build
```

Бандл будет сохранен в _dist/stratum.min.js_
Тайпинги будут сохранены в _dist/stratum.d.ts_
