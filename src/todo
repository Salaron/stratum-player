  ------------ Нужно запустить ----------------
  - smart_house (нужно реализовать осциллятор);

 - переписать код чтения VDR и VarsFile. ClassData тоже стоило бы (через switch);

 - Возможно поправить алгоритм присвоения Z для соответствия с стратумом;
 - разобраться с флагами;

И общие задачи:
 - почистить any везде где есть;
 - навести порядок с ошибками.
 - не использовать map-ы где можно обойтись обычным find

Что оптимизировать (номера проблемных строк кода):
 - SendMessage, попробовать физически связать переменные вместо копирования;
